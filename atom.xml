<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>å°ä¸€ | è«èˆå·±é“ å‹¿æ‰°ä»–å¿ƒ</title>
  
  <subtitle>è«èˆå·±é“ï¼Œå‹¿æ‰°ä»–å¿ƒ</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.istarx.cn/"/>
  <updated>2019-06-16T08:06:13.855Z</updated>
  <id>http://www.istarx.cn/</id>
  
  <author>
    <name>å°ä¸€</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ARTSæ‰“å¡â€”ç¬¬10å‘¨</title>
    <link href="http://www.istarx.cn/2019/06/16/arts-week-ten/"/>
    <id>http://www.istarx.cn/2019/06/16/arts-week-ten/</id>
    <published>2019-06-16T02:32:47.000Z</published>
    <updated>2019-06-16T08:06:13.855Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>ä»Šå¤©æ˜¯çˆ¶äº²èŠ‚ï¼Œç¥è€çˆ¸èŠ‚æ—¥å¿«ä¹ï¼Œèº«ä½“å¥åº·ï¼Œä¹Ÿç¥å¤©ä¸‹æ‰€æœ‰çˆ¶äº²èŠ‚æ—¥å¿«ä¹ã€‚ä¸Šå‘¨ç”±äºå¸¦ç«¯åˆèŠ‚å›å®¶æ²¡æ‰“å¡æ‹–å»¶äº†ä¸€å‘¨ã€‚æœ¬å‘¨æ‰“å¡å†…å®¹ä¸»è¦æ˜¯äºŒå‰æ ‘ç›¸å…³çš„å†…å®¹ã€‚</p><a id="more"></a><p><ul class="toc js-fixedContent"><li><a href="#algorithm">Algorithm</a><ul><li><a href="#%E9%A2%98%E7%9B%AE%E4%B8%80">é¢˜ç›®ä¸€</a><ul><li><a href="#%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C">è¿è¡Œç»“æœ</a></li></ul></li><li><a href="#%E9%A2%98%E7%9B%AE%E4%BA%8C">é¢˜ç›®äºŒ</a><ul><li><a href="#%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C-2">è¿è¡Œç»“æœ</a></li></ul></li></ul></li><li><a href="#review">Review</a><br>*<ul><li><a href="#%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E6%93%8D%E4%BD%9C">æ•°å­¦ç›¸å…³çš„æ“ä½œï¼š</a></li><li><a href="#%E5%B8%B8%E7%94%A8%E4%B8%8D%E5%90%8C%E7%B1%BB%E5%9E%8B%E7%9A%84-observable">å¸¸ç”¨ä¸åŒç±»å‹çš„ Observable</a></li></ul></li><li><a href="#tips">Tips</a></li><li><a href="#share">Share</a></li></ul></p><h2 id="algorithm"><a class="anchor" href="#algorithm"></a> Algorithm</h2><p>è¿™å‘¨ä¸»è¦ä½œäº†äºŒå‰æ ‘ç›¸å…³çš„é¢˜ç›®ï¼Œç¬¬äºŒä¸ªé¢˜ç›®æ˜¯ç¬¬ä¸€ä¸ªé¢˜ç›®çš„å»¶ä¼¸ã€‚</p><h3 id="é¢˜ç›®ä¸€"><a class="anchor" href="#é¢˜ç›®ä¸€"></a> é¢˜ç›®ä¸€</h3><blockquote><p><strong>654. Maximum Binary Tree</strong></p><p>Given an integer array with no duplicates. A maximum tree building on this array is defined as follow:</p><ol><li>The root is the maximum number in the array.</li><li>The left subtree is the maximum tree constructed from left part subarray divided by the maximum number.</li><li>The right subtree is the maximum tree constructed from right part subarray divided by the maximum number.</li></ol><p>Construct the maximum tree by the given array and output the root node of this tree.</p><p><strong>Example:</strong></p><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">&gt; Input: [<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">5</span>]</span><br><span class="line">&gt; Output: <span class="keyword">return</span> the tree root node representing the following tree:</span><br><span class="line">&gt; </span><br><span class="line">&gt;       <span class="number">6</span></span><br><span class="line">&gt;     /   \</span><br><span class="line">&gt;    <span class="number">3</span>     <span class="number">5</span></span><br><span class="line">&gt;     \    / </span><br><span class="line">&gt;      <span class="number">2</span>  <span class="number">0</span>   </span><br><span class="line">&gt;        \</span><br><span class="line">&gt;         <span class="number">1</span></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><p>é¢˜ç›®è¦æ±‚å°†ä¸€æ•°ç»„è½¬åŒ–æˆäºŒå‰æ ‘ï¼Œè€Œä¸”æ“ä½œæ˜¯å¾ˆè§„å¾‹çš„ï¼Œå› æ­¤ç”¨é€’å½’æ˜¯æœ€å¥½ä¸è¿‡äº†ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> TreeNode <span class="title">constructMaximumBinaryTree</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> constructMaximumBinaryTree(nums, <span class="number">0</span>, nums.length - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> TreeNode <span class="title">constructMaximumBinaryTree</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> maxValPosition = findMaxValueBetweenPosition(nums, start, end);</span><br><span class="line">  <span class="keyword">if</span> (maxValPosition == -<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  TreeNode head = <span class="keyword">new</span> TreeNode(nums[maxValPosition]);</span><br><span class="line">  head.left = constructMaximumBinaryTree(nums, start, maxValPosition - <span class="number">1</span>);</span><br><span class="line">  head.right = constructMaximumBinaryTree(nums, maxValPosition + <span class="number">1</span>, end);</span><br><span class="line">  <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">findMaxValueBetweenPosition</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (start &gt; end) &#123;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (start == end) &#123;</span><br><span class="line">    <span class="keyword">return</span> start;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">int</span> maxValPos = start;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = start + <span class="number">1</span>; i &lt;= end; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (nums[i] &gt; nums[maxValPos]) &#123;</span><br><span class="line">      maxValPos = i;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> maxValPos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è¿è¡Œç»“æœ"><a class="anchor" href="#è¿è¡Œç»“æœ"></a> è¿è¡Œç»“æœ</h4><p><img src="result1.png" alt="result1"></p><h3 id="é¢˜ç›®äºŒ"><a class="anchor" href="#é¢˜ç›®äºŒ"></a> é¢˜ç›®äºŒ</h3><blockquote><p><strong>998. Maximum Binary Tree II</strong></p><p>We are given the <code>root</code> node of a <em>maximum tree:</em> a tree where every node has a value greater than any other value in its subtree.</p><p>Just as in the <a href="https://leetcode.com/problems/maximum-binary-tree/">previous problem</a>, the given tree was constructed from an list <code>A</code> (<code>root = Construct(A)</code>) recursively with the following <code>Construct(A)</code> routine:</p><ul><li>If <code>A</code> is empty, return <code>null</code>.</li><li>Otherwise, let <code>A[i]</code> be the largest element of <code>A</code>.  Create a <code>root</code> node with value <code>A[i]</code>.</li><li>The left child of <code>root</code> will be <code>Construct([A[0], A[1], ..., A[i-1]])</code></li><li>The right child of <code>root</code> will be <code>Construct([A[i+1], A[i+2], ..., A[A.length - 1]])</code></li><li>Return <code>root</code>.</li></ul><p>Note that we were not given A directly, only a root node <code>root = Construct(A)</code>.</p><p>Suppose <code>B</code> is a copy of <code>A</code> with the value <code>val</code> appended to it.  It is guaranteed that <code>B</code> has unique values.</p><p>Return <code>Construct(B)</code>.</p><p><strong>Example1</strong></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&gt;Input: root = [<span class="number">4</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="keyword">null</span>,<span class="keyword">null</span>,<span class="number">2</span>], val = <span class="number">5</span></span><br><span class="line">&gt;Output: [<span class="number">5</span>,<span class="number">4</span>,<span class="keyword">null</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="keyword">null</span>,<span class="keyword">null</span>,<span class="number">2</span>]</span><br><span class="line">&gt;Explanation: A = [<span class="number">1</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>], B = [<span class="number">1</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>]</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p><strong>Example2</strong></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&gt;Input: root = [<span class="number">5</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="keyword">null</span>,<span class="number">1</span>], val = <span class="number">3</span></span><br><span class="line">&gt;Output: [<span class="number">5</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="keyword">null</span>,<span class="number">1</span>,<span class="keyword">null</span>,<span class="number">3</span>]</span><br><span class="line">&gt;Explanation: A = [<span class="number">2</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">4</span>], B = [<span class="number">2</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>]</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p><strong>Example3</strong></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&gt;Input: root = [<span class="number">5</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="keyword">null</span>,<span class="number">1</span>], val = <span class="number">4</span></span><br><span class="line">&gt;Output: [<span class="number">5</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="keyword">null</span>,<span class="number">1</span>,<span class="number">3</span>]</span><br><span class="line">&gt;Explanation: A = [<span class="number">2</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>], B = [<span class="number">2</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> TreeNode <span class="title">insertIntoMaxTree</span><span class="params">(TreeNode root, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">  TreeNode tmp = <span class="keyword">new</span> TreeNode(val);</span><br><span class="line">  <span class="keyword">if</span> (root == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> tmp;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (val &gt; root.val) &#123;</span><br><span class="line">    tmp.left = root;</span><br><span class="line">    <span class="keyword">return</span> tmp;</span><br><span class="line">  &#125;</span><br><span class="line">  TreeNode head = root;</span><br><span class="line">  <span class="keyword">while</span> (head.right != <span class="keyword">null</span> &amp;&amp; val &lt; head.right.val) &#123;</span><br><span class="line">    head = head.right;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (head.right == <span class="keyword">null</span>) &#123;</span><br><span class="line">    head.right = tmp;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    TreeNode tmp1 = head.right;</span><br><span class="line">    head.right = tmp;</span><br><span class="line">    tmp.left = tmp1; </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è¿è¡Œç»“æœ-2"><a class="anchor" href="#è¿è¡Œç»“æœ-2"></a> è¿è¡Œç»“æœ</h4><p><img src="result2.png" alt="result2"></p><h2 id="review"><a class="anchor" href="#review"></a> Review</h2><p>æœ¬å‘¨é˜…è¯»å­¦ä¹  RxJava ç³»åˆ—çš„ä¸­çš„ä¸¤ç¯‡æ–‡ç« ï¼š</p><h4 id="æ•°å­¦ç›¸å…³çš„æ“ä½œ"><a class="anchor" href="#æ•°å­¦ç›¸å…³çš„æ“ä½œ"></a> æ•°å­¦ç›¸å…³çš„æ“ä½œï¼š</h4><p>ä½¿ç”¨è¿™äº›æ¥å£æ—¶éœ€è¦æ–°å¼•å…¥ä¸€ä¸ª jar åŒ…ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">implementation <span class="string">'com.github.akarnokd:rxjava2-extensions:0.20.0'</span></span><br></pre></td></tr></table></figure><ul><li><strong>Average</strong>ï¼š æ±‚å‡ºä¼ é€’æ‰€æœ‰å…ƒç´ çš„å¹³å‡å€¼ï¼Œå°†è¯¥å¹³å‡å€¼ä¼ é€’ç»™ Observerï¼›</li><li><strong>Count</strong>ï¼šç»Ÿè®¡æ‰€ä¼ æ•°æ®çš„ä¸ªæ•°ï¼Œå³åŸå§‹ Obserable å‘é€äº†å¤šå°‘æ¬¡æ•°æ®ï¼›</li><li><strong>Max</strong>ï¼šå°†æ‰€æœ‰ä¼ é€’çš„æ•°æ®ä¸­çš„æœ€å¤§å€¼å½“æœ€ç»ˆç»“æœè¿›è¡Œä¼ é€’ï¼›</li><li><strong>Min</strong>: å’Œ Max ç±»ä¼¼ï¼›</li><li><strong>Reduce</strong>ï¼šå°†æ‰€æœ‰çš„åŸå§‹å‘é€æ•°æ®è¿›è¡Œç´¯ç§¯ä¹˜ç§¯ï¼Œå°†æœ€ç»ˆç»“æœä¼ é€’ç»™ Observerï¼›</li><li><strong>Sum</strong>:  å°†æ‰€æœ‰æ•°æ®æ±‚å’Œï¼›</li></ul><p><a href="https://proandroiddev.com/exploring-rxjava-in-android-mathematical-and-aggregate-operators-eb3e37322ac8">Mathematical and Aggregate Operators</a></p><h4 id="å¸¸ç”¨ä¸åŒç±»å‹çš„-observable"><a class="anchor" href="#å¸¸ç”¨ä¸åŒç±»å‹çš„-observable"></a> å¸¸ç”¨ä¸åŒç±»å‹çš„ Observable</h4><ul><li><p><strong>Single</strong>ï¼šè¯¥ Observable æ¯æ¬¡åªä¼ é€’ä¸€ä¸ªå…ƒç´ æˆ–è€…æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œå¸¸ç”¨çš„æœ‰ç½‘ç»œè¿æ¥ç­‰ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Single.create(<span class="keyword">new</span> SingleOnSubscribe&lt;User&gt;() &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">subscribe</span><span class="params">(SingleEmitter&lt;User&gt; emitter)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    User user = <span class="keyword">new</span> User(<span class="string">"Anitaa"</span>);</span><br><span class="line">    emitter.onSuccess(user);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">  .observeOn(Schedulers.io())</span><br><span class="line">  .subscribe(<span class="keyword">new</span> SingleObserver&lt;User&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSubscribe</span><span class="params">(Disposable d)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">      System.out.println(String.format(<span class="string">"User with name %s successfully created: "</span>, user.getName()));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure></li><li><p><strong>Maybe</strong>ï¼šè¯¥ Observable å¯èƒ½å‘é€å…ƒç´ ä¹Ÿå¯èƒ½ä¸å‘é€å…ƒç´ ï¼›</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Maybe.create(<span class="keyword">new</span> MaybeOnSubscribe&lt;User&gt;() &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">subscribe</span><span class="params">(MaybeEmitter&lt;User&gt; emitter)</span> </span>&#123;</span><br><span class="line">    User user = <span class="keyword">new</span> User(<span class="string">"Anitaa"</span>);</span><br><span class="line">    emitter.onSuccess(user);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">  .observeOn(Schedulers.io())</span><br><span class="line">  .subscribe(<span class="keyword">new</span> MaybeObserver&lt;User&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSubscribe</span><span class="params">(Disposable d)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">      System.out.println(String.format(<span class="string">"User with name '%s' successfully created "</span>, user.getName()));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;</span><br><span class="line">      System.out.println(<span class="string">"onError is called: "</span> + e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onComplete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      System.out.println(<span class="string">"onComplete is called"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure></li><li><p><strong>Completeable</strong>ï¼šè¯¥ Observable ä¸ä¼šå‘é€æ•°æ®ï¼Œä½†æ˜¯ä¼šå…³æ³¨äº‹ä»¶æ˜¯å¦æˆåŠŸæ‰§è¡Œï¼Œ<code>onComplete</code>æˆ–è€…<code>onFail</code>ä¹‹ä¸€ä¼šè¢«è°ƒç”¨ï¼›</p></li><li><p><strong>Flowable</strong>ï¼šå½“ Observable å‘é€å¤§é‡æ•°æ®ï¼Œä½†æ˜¯ Observer ä¸èƒ½åŠæ—¶å¤„ç†è¿™äº›æ•°æ®æ—¶éœ€è¦ä½¿ç”¨æ­¤ Observableï¼›</p></li></ul><p><a href="https://proandroiddev.com/exploring-rxjava-in-android-different-types-of-observables-f23b3c78aeb6">Different Types of Observables</a></p><h2 id="tips"><a class="anchor" href="#tips"></a> Tips</h2><ol><li><code>git log â€”grep key-word</code>å‘½ä»¤å¯ä»¥è¿‡æ»¤åŒ…å« key-wordçš„ git log ä¿¡æ¯ï¼›</li><li>EditTextè®¾ç½®è¾¹æ¡†éœ€è¦ä½¿ç”¨ background å±æ€§ ï¼›</li></ol><h2 id="share"><a class="anchor" href="#share"></a> Share</h2><p><a href="http://www.istarx.cn/2019/06/11/adb-commands/">ADB å¸¸ç”¨å‘½ä»¤æ•´ç†</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä»Šå¤©æ˜¯çˆ¶äº²èŠ‚ï¼Œç¥è€çˆ¸èŠ‚æ—¥å¿«ä¹ï¼Œèº«ä½“å¥åº·ï¼Œä¹Ÿç¥å¤©ä¸‹æ‰€æœ‰çˆ¶äº²èŠ‚æ—¥å¿«ä¹ã€‚ä¸Šå‘¨ç”±äºå¸¦ç«¯åˆèŠ‚å›å®¶æ²¡æ‰“å¡æ‹–å»¶äº†ä¸€å‘¨ã€‚æœ¬å‘¨æ‰“å¡å†…å®¹ä¸»è¦æ˜¯äºŒå‰æ ‘ç›¸å…³çš„å†…å®¹ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ARTSæ‰“å¡" scheme="http://www.istarx.cn/categories/ARTS%E6%89%93%E5%8D%A1/"/>
    
    
      <category term="ARTS" scheme="http://www.istarx.cn/tags/ARTS/"/>
    
  </entry>
  
  <entry>
    <title>ADB å¸¸ç”¨å‘½ä»¤æ•´ç†</title>
    <link href="http://www.istarx.cn/2019/06/11/adb-commands/"/>
    <id>http://www.istarx.cn/2019/06/11/adb-commands/</id>
    <published>2019-06-11T04:22:46.000Z</published>
    <updated>2019-06-11T07:57:31.805Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>ä½œä¸ºä¸€å Android å¼€å‘äººå‘˜ï¼Œadb å‘½ä»¤æ˜¯ä¸å¯ç¼ºå°‘çš„æŠ€èƒ½ä¹‹ä¸€ï¼Œåœ¨æ—¥å¸¸å·¥ä½œä¸­æˆ–å¤šæˆ–å°‘ä¼šç”¨åˆ°è¿™äº›å‘½ä»¤ï¼Œæœ¬ç¯‡å†…å®¹ä¸»è¦æ˜¯æ•´ç†äº†ä¸€äº›å¸¸ç”¨çš„ adb å‘½ä»¤ï¼ŒåŒæ—¶åŠ å¼ºè®°å¿†ã€‚</p><a id="more"></a><p><ul class="toc js-fixedContent"><li><ul><li><a href="#adb-%E5%91%BD%E4%BB%A4%E5%90%AF%E5%8A%A8%E5%92%8C%E5%85%B3%E9%97%AD">adb å‘½ä»¤å¯åŠ¨å’Œå…³é—­</a></li><li><a href="#adb-%E5%B8%B8%E8%A7%84%E5%91%BD%E4%BB%A4">adb å¸¸è§„å‘½ä»¤</a></li><li><a href="#adb-devices-%E6%9F%A5%E8%AF%A2%E8%AE%BE%E5%A4%87">adb devices æŸ¥è¯¢è®¾å¤‡</a></li><li><a href="#%E6%93%8D%E4%BD%9C%E5%A4%9A%E4%B8%AA%E8%AE%BE%E5%A4%87%E4%B8%AD%E7%9A%84%E4%B8%80%E4%B8%AA">æ“ä½œå¤šä¸ªè®¾å¤‡ä¸­çš„ä¸€ä¸ª</a></li><li><a href="#adb-forward-%E8%AE%BE%E7%BD%AE%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91">adb forward è®¾ç½®ç«¯å£è½¬å‘</a></li><li><a href="#adb-connect-%E9%80%9A%E8%BF%87-wifi-%E4%BD%BF%E7%94%A8-adb">adb connect é€šè¿‡ wifi ä½¿ç”¨ adb</a></li><li><a href="#adb-usb">adb usb</a></li><li><a href="#%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C-push-pull">æ–‡ä»¶æ“ä½œ <code>push</code> / <code>pull</code></a></li><li><a href="#%E8%B0%83%E8%AF%95%E5%91%BD%E4%BB%A4">è°ƒè¯•å‘½ä»¤</a></li><li><a href="#%E8%B0%83%E7%94%A8-activity-manageram">è°ƒç”¨ Activity Manager(am)</a></li><li><a href="#%E8%B0%83%E7%94%A8%E8%BD%AF%E4%BB%B6%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8-package-managerpm">è°ƒç”¨è½¯ä»¶åŒ…ç®¡ç†å™¨ Package Manager(pm)</a></li><li><a href="#%E6%88%AA%E5%9B%BEscreencap%E4%BB%A5%E5%8F%8A%E5%BD%95%E5%88%B6%E8%A7%86%E9%A2%91screenrecord">æˆªå›¾(<code>screencap</code>)ä»¥åŠå½•åˆ¶è§†é¢‘(<code>screenrecord</code>)</a></li></ul></li></ul></p><h3 id="adb-å‘½ä»¤å¯åŠ¨å’Œå…³é—­"><a class="anchor" href="#adb-å‘½ä»¤å¯åŠ¨å’Œå…³é—­"></a> adb å‘½ä»¤å¯åŠ¨å’Œå…³é—­</h3><ul><li><strong>adb start-server</strong>ï¼šæ£€æŸ¥ adb æœåŠ¡å™¨è¿›ç¨‹æ˜¯å¦åœ¨è¿è¡Œï¼Œå¦‚æœæœªè¿è¡Œåˆ™å¯åŠ¨å®ƒï¼›</li><li><strong>adb kill-server</strong>ï¼šå…³é—­ adb æœåŠ¡ï¼›</li></ul><h3 id="adb-å¸¸è§„å‘½ä»¤"><a class="anchor" href="#adb-å¸¸è§„å‘½ä»¤"></a> adb å¸¸è§„å‘½ä»¤</h3><ul><li><strong>adb version</strong>ï¼šæŸ¥çœ‹ adb ç‰ˆæœ¬ï¼›</li><li><strong>adb help</strong>ï¼šè¾“å‡º adb æ”¯æŒçš„å‘½ä»¤ï¼›</li><li><strong>adb wait-for-device</strong>ï¼šç­‰å¾…è¿æ¥è®¾å¤‡ï¼›</li></ul><h3 id="adb-devices-æŸ¥è¯¢è®¾å¤‡"><a class="anchor" href="#adb-devices-æŸ¥è¯¢è®¾å¤‡"></a> adb devices æŸ¥è¯¢è®¾å¤‡</h3><p>æ­¤å‘½ä»¤ä¼šåˆ—ä¸¾å‡ºå½“å‰ç”µè„‘ä¸Šé“¾æ¥çš„è®¾å¤‡ï¼ŒåŒ…æ‹¬æ¨¡æ‹Ÿå™¨ä»¥åŠå®ä½“è®¾å¤‡ã€‚å‘½ä»¤çª—å£ä¼šè¾“å‡ºå½“å‰é“¾æ¥è®¾å¤‡çš„åºåˆ—å·ä»¥åŠçŠ¶æ€ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">e6b2a367        device</span><br><span class="line">emulator-5654   device</span><br></pre></td></tr></table></figure><div class="alert info"><p>å¿…é¡»è¦å®‰è£…é©±åŠ¨ï¼Œå¹¶ä¸”æ‰“å¼€å¼€å‘è€…æ¨¡å¼ä¸‹çš„ usb è°ƒè¯•æ‰å¯ä»¥æ˜¾ç¤ºå‡ºè®¾å¤‡</p></div><h3 id="æ“ä½œå¤šä¸ªè®¾å¤‡ä¸­çš„ä¸€ä¸ª"><a class="anchor" href="#æ“ä½œå¤šä¸ªè®¾å¤‡ä¸­çš„ä¸€ä¸ª"></a> æ“ä½œå¤šä¸ªè®¾å¤‡ä¸­çš„ä¸€ä¸ª</h3><p>é€šè¿‡ adb devices å‘½ä»¤å¯ä»¥çœ‹åˆ°è¿æ¥ç”µè„‘çš„æ‰€æœ‰ android è®¾å¤‡ï¼Œå¦‚æœè¦å¯¹å¤šä¸ªè®¾å¤‡ä¸­çš„æŸä¸ªè¿›è¡Œæ“ä½œï¼Œéœ€è¦ä½¿ç”¨ <code>-s</code> å‚æ•°ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">adb [-d|-e|-s serial_number] [shell] command</span><br></pre></td></tr></table></figure><ul><li><strong>-d</strong>ï¼šå°†å‘½ä»¤å‘é€åˆ°å”¯ä¸€è¿æ¥çš„ USB è®¾å¤‡ï¼Œå¦‚æœè¿æ¥å¤šä¸ªè®¾å¤‡åˆ™ä¼šæŠ¥é”™ï¼›</li><li><strong>-e</strong>ï¼šå°†å‘½ä»¤å‘é€åˆ°å”¯ä¸€è¿è¡Œçš„æ¨¡æ‹Ÿå™¨ï¼Œå¦‚æœå¯åŠ¨äº†å¤šä¸ªæ¨¡æ‹Ÿå™¨è®¾å¤‡ï¼Œåˆ™ä¼šæŠ¥é”™ï¼›</li></ul><h3 id="adb-forward-è®¾ç½®ç«¯å£è½¬å‘"><a class="anchor" href="#adb-forward-è®¾ç½®ç«¯å£è½¬å‘"></a> adb forward è®¾ç½®ç«¯å£è½¬å‘</h3><p>å¯ä»¥ä½¿ç”¨è¯¥å‘½ä»¤è®¾ç½®ä»»æ„ç«¯å£è½¬å‘ï¼Œå³å¯¹ç‰¹å®šä¸»æœºç«¯å£çš„è¯·æ±‚è½¬å‘åˆ°æ¨¡æ‹Ÿå™¨/å®ä½“è®¾å¤‡ä¸Šçš„å…¶å®ƒç«¯å£ï¼Œå®ç°ä¸»æœºå’Œè®¾å¤‡ä¹‹é—´çš„é€šä¿¡ã€‚</p><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">adb forward &lt;local&gt; &lt;remote&gt;</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚ä»¥ä¸‹å‘½ä»¤å®ç°ä¸»æœº 6100 ç«¯å£åˆ°æ¨¡æ‹Ÿå™¨æˆ–è€…å®ä½“è®¾å¤‡ 7100 ç«¯å£çš„è½¬å‘ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">adb forward tcp:6100 tcp:7100</span><br></pre></td></tr></table></figure><h3 id="adb-connect-é€šè¿‡-wifi-ä½¿ç”¨-adb"><a class="anchor" href="#adb-connect-é€šè¿‡-wifi-ä½¿ç”¨-adb"></a> adb connect é€šè¿‡ wifi ä½¿ç”¨ adb</h3><p>å‘½ä»¤ä½¿ç”¨æ–¹æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">adb connect &lt;host&gt;[:&lt;port&gt;]</span><br></pre></td></tr></table></figure><p>æ“ä½œæ­¥éª¤ï¼š</p><ul><li><p>æ‰‹æœºè¿æ¥ usb æ¥å£ï¼›</p></li><li><p>adb devices åˆ—å‡ºè®¾å¤‡ï¼›</p></li><li><p>adb tcpip 5555ï¼šåœ¨ TCP æ¨¡å¼ä¸‹é‡å¯ï¼Œç«¯å£ä¸º5555</p></li><li><p>adb connect #.#.#.# è¿æ¥åˆ° #.#.#.#:5555</p><div class="alert info"><p>å‚æ•° #.#.#.# æ˜¯ Android è®¾å¤‡çš„ IP åœ°å€ã€‚</p></div></li></ul><h3 id="adb-usb"><a class="anchor" href="#adb-usb"></a> adb usb</h3><p>åœ¨ usb æ¨¡å¼ä¸‹é‡æ–°è¿æ¥ï¼›</p><h3 id="æ–‡ä»¶æ“ä½œ-push-pull"><a class="anchor" href="#æ–‡ä»¶æ“ä½œ-push-pull"></a> æ–‡ä»¶æ“ä½œ <code>push</code> / <code>pull</code></h3><p>adb å‘½ä»¤ <code>push</code>ã€<code>pull</code>å°†æ–‡ä»¶ä»æœ¬åœ°æ‹·è´åˆ°æ‰‹æœºæˆ–è€…ä»æ‰‹æœºæ‹·è´åˆ°æœ¬åœ°ï¼›</p><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">adb pull remote local // ä»è®¾å¤‡æ‹·è´åˆ°æœ¬åœ°</span><br><span class="line">adb push local remote // ä»æœ¬åœ°æ¨é€åˆ°è®¾å¤‡</span><br></pre></td></tr></table></figure><h3 id="è°ƒè¯•å‘½ä»¤"><a class="anchor" href="#è°ƒè¯•å‘½ä»¤"></a> è°ƒè¯•å‘½ä»¤</h3><ul><li><strong><code>dumpsys</code></strong>ï¼šè¾“å‡ºç³»ç»Ÿæ•°æ®ï¼›</li><li><strong><code>dumpstate</code></strong>ï¼šè¾“å‡ºç³»ç»ŸçŠ¶æ€ï¼›</li><li><strong><code>logcat</code></strong>ï¼šè¾“å‡ºæ—¥å¿—ï¼›</li></ul><h3 id="è°ƒç”¨-activity-manageram"><a class="anchor" href="#è°ƒç”¨-activity-manageram"></a> è°ƒç”¨ Activity Manager(am)</h3><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">adb shell am command</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨è¯¥å‘½ä»¤å¯ä»¥å¯åŠ¨æŸä¸ª activityã€serviceã€å‘é€å¹¿æ’­ç­‰ã€‚</p><p>å¯ç”¨çš„ Activity Manager å‘½ä»¤å¦‚ä¸‹ï¼š</p><ul><li><p><strong><code>start</code> [<em>options</em>] <em>intent</em></strong>ï¼šå¯åŠ¨ intent æŒ‡å®šçš„ activityã€‚é€‰é¡¹ä¸»è¦æœ‰å¦‚ä¸‹ï¼š</p><ul><li><strong><code>-D</code></strong>ï¼šå¯åŠ¨è°ƒè¯•ï¼›</li><li><strong><code>-W</code></strong>ï¼šç­‰å¾…å¯åŠ¨å®Œæˆï¼›</li><li><strong><code>--start-profiler</code> <em>file</em></strong>ï¼šå¯åŠ¨åˆ†æå™¨å¹¶å°†ç»“æœå‘é€åˆ°fileï¼›</li><li><strong><code>-P</code> <em>file</em></strong>ï¼šç±»ä¼¼ start-profilerï¼Œä½†æ˜¯å½“åº”ç”¨è¿›å…¥ç©ºé—²çŠ¶æ€æ—¶åœæ­¢åˆ†æï¼›</li><li><strong><code>-R</code> <em>count</em></strong>ï¼šé‡å¤å¯åŠ¨ activity count æ¬¡ã€‚æ¯æ¬¡é‡å¤å‰å°†å®Œæˆé¡¶éƒ¨ activityï¼›</li><li><strong><code>-S</code></strong>ï¼šå¯åŠ¨ Activity å‰å¼ºè¡Œåœæ­¢ç›®æ ‡åº”ç”¨ï¼›</li><li><strong><code>â€”user</code> <em>user_id</em> | current</strong>ï¼šæŒ‡å®šè¦ä½œä¸ºå“ªä¸ªç”¨æˆ·è¿è¡Œï¼›å¦‚æœæœªæŒ‡å®šï¼Œåˆ™ä½œä¸ºå½“å‰ç”¨æˆ·è¿è¡Œ;</li></ul></li><li><p><strong><code>startservice</code> [<em>options</em>] <em>intent</em></strong>ï¼šå¯åŠ¨ intent å¯¹åº”çš„ Serviceï¼›</p><p>é€‰é¡¹æœ‰ï¼š</p><ul><li><strong><code>â€”user</code> <em>user_id</em> | current</strong>ï¼šæŒ‡å®šè¦ä½œä¸ºå“ªä¸ªç”¨æˆ·è¿è¡Œï¼›å¦‚æœæœªæŒ‡å®šï¼Œåˆ™ä½œä¸ºå½“å‰ç”¨æˆ·è¿è¡Œ;</li></ul></li><li><p><strong><code>force-stop</code> <em>package_name</em></strong>ï¼šå¼ºè¡Œåœæ­¢ä¸ package_name(åº”ç”¨åŒ…å) ç›¸å…³è”çš„æ‰€æœ‰<strong>åº”ç”¨</strong>ï¼›</p></li><li><p><strong><code>kill</code> [<em>options</em>] <em>package_name</em></strong>ï¼šç»ˆæ­¢ä¸ <code>package_name</code>ï¼ˆåº”ç”¨çš„åŒ…åç§°ï¼‰å…³è”çš„æ‰€æœ‰<strong>è¿›ç¨‹</strong>ã€‚æ­¤å‘½ä»¤ä»…ç»ˆæ­¢å¯å®‰å…¨ç»ˆæ­¢ä¸”ä¸ä¼šå½±å“ç”¨æˆ·ä½“éªŒçš„è¿›ç¨‹ï¼›</p><p>é€‰é¡¹æœ‰ï¼š</p><ul><li><strong><code>â€”user</code> <em>user_id</em> | current</strong>ï¼šæŒ‡å®šè¦ä½œä¸ºå“ªä¸ªç”¨æˆ·è¿è¡Œï¼›å¦‚æœæœªæŒ‡å®šï¼Œåˆ™ä½œä¸ºå½“å‰ç”¨æˆ·è¿è¡Œ;</li></ul></li><li><p><strong><code>kill-all</code></strong>ï¼šç»ˆæ­¢åå°æ‰€æœ‰è¿›ç¨‹ï¼›</p></li><li><p><strong><code>broadcast</code> [<em>options</em>] <em>intent</em></strong>ï¼šå‘å‡ºå¹¿æ’­ intentï¼›</p><p>é€‰é¡¹æœ‰ï¼š</p><ul><li><strong><code>â€”user</code> <em>user_id</em> | current</strong>ï¼šæŒ‡å®šè¦ä½œä¸ºå“ªä¸ªç”¨æˆ·è¿è¡Œï¼›å¦‚æœæœªæŒ‡å®šï¼Œåˆ™ä½œä¸ºå½“å‰ç”¨æˆ·è¿è¡Œ;</li></ul></li><li><p><strong><code>instrument</code>  [<em>options</em>] <em>compoent</em></strong>ï¼šä½¿ç”¨  <code>Instrumentation</code> å®ä¾‹ç›‘æ§ã€‚é€šå¸¸æƒ…å†µä¸‹ component æ˜¯**<em>test_package</em>/<em>runner_class</em>**ï¼›</p><p>å¯é€‰é¡¹æœ‰ï¼š</p><ul><li><strong><code>-r</code></strong>ï¼šè¾“å‡ºåŸå§‹ç»“æœï¼Œå¦åˆ™å¯¹<code>report_key_streamresult</code> è¿›è¡Œè§£ç ï¼›</li><li><strong><code>-e</code> <em>name value</em></strong>ï¼šå°†å‚æ•° <strong>name</strong> çš„å€¼è®¾ç½®ä¸º <strong>value</strong>ï¼›</li><li><strong><code>-p</code> <em>file</em></strong>ï¼šå°†åˆ†ææ•°æ®å†™å…¥ fileï¼›</li><li><strong><code>-w</code></strong>ï¼šå…ˆç­‰å¾…ä»ªå™¨å®Œæˆï¼Œç„¶åå†è¿”å›ï¼Œæµ‹è¯•è¿è¡Œå™¨éœ€è¦ä½¿ç”¨æ­¤é€‰é¡¹ï¼›</li><li><strong><code>--no-window-animation</code></strong>ï¼šè¿è¡Œæ—¶å…³é—­çª—å£åŠ¨ç”»ï¼›</li><li><strong><code>â€”user</code> <em>user_id</em> | current</strong>ï¼šæŒ‡å®šè¦ä½œä¸ºå“ªä¸ªç”¨æˆ·è¿è¡Œï¼›å¦‚æœæœªæŒ‡å®šï¼Œåˆ™ä½œä¸ºå½“å‰ç”¨æˆ·è¿è¡Œ;</li></ul></li><li><p><strong><code>profile start</code> <em>process  file</em></strong>ï¼šå¯åŠ¨ process è¿›ç¨‹çš„åˆ†æå™¨ï¼Œå°†ç»“æœå†™å…¥ fileï¼›</p></li><li><p><strong><code>profile start</code> <em>process</em></strong>ï¼šåœæ­¢ process è¿›ç¨‹çš„åˆ†æå™¨ï¼›</p></li><li><p><strong><code>dumpheap</code> [<em>options</em>] <em>process file</em></strong>ï¼šå°† process è¿›ç¨‹çš„å†…å­˜ä½¿ç”¨æƒ…å†µä¿å­˜åˆ° file æ–‡ä»¶ä¸­ï¼›</p><p>å¯é€‰é¡¹æœ‰ï¼š</p><ul><li><strong><code>â€”user</code> <em>user_id</em> | current</strong>ï¼šæŒ‡å®šè¦ä½œä¸ºå“ªä¸ªç”¨æˆ·è¿è¡Œï¼›å¦‚æœæœªæŒ‡å®šï¼Œåˆ™ä½œä¸ºå½“å‰ç”¨æˆ·è¿è¡Œ;</li><li><strong><code>-n</code></strong>ï¼šä¿å­˜åŸç”Ÿå †ï¼Œè€Œéæ‰˜ç®¡å †ï¼›</li></ul></li><li><p><strong><code>set-debug-app</code> [<em>options</em>] <em>package</em></strong>ï¼šå°†åº”ç”¨ package è®¾ä¸ºè°ƒè¯•ï¼›</p><p>å¯é€‰é¡¹æœ‰ï¼š</p><ul><li><strong><code>-w</code></strong>ï¼šåº”ç”¨å¯åŠ¨æ—¶ç­‰å¾…è°ƒè¯•ç¨‹åºï¼›</li><li><strong><code>--persistent</code></strong>ï¼šä¿ç•™æ­¤å€¼ï¼›</li></ul></li><li><p><strong><code>clear-debug-app</code></strong>ï¼šæ¸…é™¤è®¾ç½®çš„è°ƒè¯• è½¯ä»¶ï¼›</p></li><li><p><strong><code>monitor</code> [<em>options</em>]</strong>ï¼šå¯åŠ¨å¯¹ crash æˆ– anr çš„ç›‘æ§ï¼›</p></li><li><p><strong><code>display-size</code> [<em>reset</em> | <em>width</em> x <em>height</em>]</strong>ï¼šæ›¿æ¢æ¨¡æ‹Ÿå™¨ã€è®¾å¤‡çš„æ˜¾ç¤ºå°ºå¯¸ï¼Œç”¨äºå¤„äº‹ä¸åŒåˆ†è¾¨ç‡æ˜¾ç¤ºï¼›</p></li><li><p><strong><code>display-density</code> <em>dpi</em></strong>ï¼šæ›¿æ¢è®¾å¤‡çš„æ˜¾ç¤ºå¯†åº¦ï¼›</p></li><li><p><strong><code>to-uri</code> <em>intent</em></strong>ï¼šå°† intent ä»¥ URI çš„å½¢å¼è¾“å‡ºï¼›</p></li><li><p><strong><code>to-intent-uri</code> <em>intent</em></strong>ï¼šå°†ç»™å®šçš„ intent è§„èŒƒä»¥ <code>intent:URI</code> çš„å½¢å¼è¾“å‡ºï¼›</p></li></ul><h3 id="è°ƒç”¨è½¯ä»¶åŒ…ç®¡ç†å™¨-package-managerpm"><a class="anchor" href="#è°ƒç”¨è½¯ä»¶åŒ…ç®¡ç†å™¨-package-managerpm"></a> è°ƒç”¨è½¯ä»¶åŒ…ç®¡ç†å™¨ Package Manager(pm)</h3><p>ä½¿ç”¨æ–¹æ³•:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">adb shell pm command</span><br></pre></td></tr></table></figure><p>å¯ç”¨çš„å‘½ä»¤æœ‰ï¼š</p><ul><li><p><strong><code>list packages</code> [<em>options</em>] <em>filter</em></strong>ï¼šè¾“å‡º æ‰€æœ‰åŒ…å« filter æ–‡æœ¬çš„è½¯ä»¶åŒ…ï¼Œé»˜è®¤åˆ—å‡ºæ‰€æœ‰çš„è½¯ä»¶åŒ…ï¼›</p><p>å¯é€‰é¡¹æœ‰ï¼š</p><ul><li><code>-f</code>ï¼šæŸ¥çœ‹å®ƒä»¬çš„å…³è”æ–‡ä»¶ï¼›</li><li><code>-d</code>ï¼šè¿›è¡Œè¿‡æ»¤ä»¥ä»…æ˜¾ç¤ºå·²åœç”¨çš„è½¯ä»¶åŒ…ï¼›</li><li><code>-e</code>ï¼šè¿›è¡Œè¿‡æ»¤ä»¥ä»…æ˜¾ç¤ºå·²å¯ç”¨çš„è½¯ä»¶åŒ…ï¼›</li><li><code>-s</code>ï¼šè¿›è¡Œè¿‡æ»¤ä»¥ä»…æ˜¾ç¤ºç³»ç»Ÿè½¯ä»¶åŒ…ï¼›</li><li><code>-3</code>ï¼šè¿›è¡Œè¿‡æ»¤ä»¥ä»…æ˜¾ç¤ºç¬¬ä¸‰æ–¹è½¯ä»¶åŒ…ï¼›</li><li><code>-i</code>ï¼šæŸ¥çœ‹è½¯ä»¶åŒ…çš„å®‰è£…ç¨‹åºï¼›</li><li><code>-u</code>ï¼šåŒ…æ‹¬å¸è½½çš„è½¯ä»¶åŒ…ï¼›</li><li><code>--user</code> <em><strong>user_id</strong></em>ï¼šè¦æŸ¥è¯¢çš„ç”¨æˆ·ç©ºé—´ï¼›</li></ul></li><li><p><strong><code>list permission-groups</code></strong>ï¼šè¾“å‡ºæ‰€æœ‰å·²çŸ¥çš„æƒé™ç»„ï¼›</p></li><li><p><strong><code>list permissions</code> [<em>options</em>] <em>group</em></strong>ï¼šè¾“å‡ºæ‰€æœ‰å·²çŸ¥æƒé™ï¼Œæˆ–è€…ï¼Œä»…è¾“å‡º <code>group</code> ä¸­çš„æƒé™ï¼›</p><p>å¯é€‰é¡¹æœ‰ï¼š</p><ul><li><code>-g</code>ï¼šæŒ‰ç»„åŠ ä»¥ç»„ç»‡ï¼›</li><li><code>-f</code>ï¼šè¾“å‡ºæ‰€æœ‰ä¿¡æ¯ï¼›</li><li><code>-s</code>ï¼šä»…è¾“å‡ºé—´æ–­æ‘˜è¦ï¼›</li><li><code>-d</code>ï¼šä»…åˆ—å‡ºå±é™©æƒé™ï¼›</li><li><code>-u</code>ï¼šä»…åˆ—å‡ºç”¨æˆ·çœ‹åˆ°çš„æƒé™ï¼›</li></ul></li><li><p>**<code>list instrumentation</code> [<em>options</em>] **ï¼šåˆ—å‡ºæ‰€æœ‰çš„æµ‹è¯•è½¯ä»¶åŒ…ï¼›</p><p>é€‰é¡¹æœ‰ï¼š</p><ul><li><code>-f</code>ï¼šåˆ—å‡ºç”¨äºæµ‹è¯•è½¯ä»¶åŒ…çš„ apk æ–‡ä»¶ï¼›</li><li><code>target_package</code>ï¼šåˆ—å‡ºä»…ç”¨äºæ­¤åº”ç”¨çš„æµ‹è¯•è½¯ä»¶åŒ…ï¼›</li></ul></li><li><p><strong><code>list features</code></strong>ï¼šåˆ—å‡ºç³»ç»Ÿçš„æ‰€æœ‰åŠŸèƒ½ï¼›</p></li><li><p><strong><code>list libraries</code></strong>ï¼šåˆ—å‡ºæ”¯æŒçš„æ‰€æœ‰åº“ï¼›</p></li><li><p><strong><code>list users</code></strong>ï¼šåˆ—å‡ºè®¾å¤‡ç³»ç»Ÿä¸Šæ‰€æœ‰çš„ç”¨æˆ·ï¼›</p></li><li><p><strong><code>path</code> <em>package</em></strong>ï¼šè¾“å‡ºç»™å®špackge çš„ apk è·¯å¾„ï¼›</p></li><li><p><strong><code>install</code> [<em>options</em>] <em>path</em></strong>ï¼šå°†è½¯ä»¶å®‰è£…åˆ° path æŒ‡å®šçš„è·¯å¾„</p><p>é€‰é¡¹æœ‰ï¼š</p><ul><li><code>-l</code>ï¼šå®‰è£…å…·æœ‰é”å®šåŠŸèƒ½çš„è½¯ä»¶åŒ…ï¼›</li><li><code>-r</code>ï¼šè¦†ç›–ç°æœ‰åº”ç”¨ï¼Œä¿ç•™ç”¨æˆ·æ•°æ®ï¼›</li><li><code>-t</code>ï¼šå…è®¸å®‰è£…æµ‹è¯• apkï¼›</li><li><code>-i</code> <em>install_package_name</em>ï¼šæŒ‡å®šå®‰è£…ç¨‹åºè½¯ä»¶åŒ…åç§°ï¼›</li><li><code>-s</code>ï¼šåœ¨å…±äº«çš„å¤§å®¹é‡å­˜å‚¨ï¼ˆå¦‚ sdcardï¼‰ä¸Šå®‰è£…è½¯ä»¶åŒ…ï¼›</li><li><code>-f</code>ï¼šåœ¨å†…éƒ¨ç³»ç»Ÿå†…å­˜ä¸Šå®‰è£…è½¯ä»¶åŒ…ï¼›</li><li><code>-d</code>ï¼šå…è®¸ç‰ˆæœ¬é™çº§å®‰è£…ï¼›</li><li><code>-g</code>ï¼šæˆäºˆåº”ç”¨æ¸…æ·¡ä¸­åˆ—å‡ºçš„æ‰€æœ‰æƒé™ï¼›</li></ul></li><li><p><strong><code>uninstall</code> [<em>options</em>] <em>package</em></strong>ï¼šä»ç³»ç»Ÿä¸­ç§»é™¤è½¯ä»¶ï¼›</p><p>é€‰é¡¹æœ‰ï¼š</p><ul><li><code>-k</code>ï¼šç§»é™¤è½¯ä»¶åä¿ç•™æ•°æ®å’Œç¼“å­˜ç›®å½•ï¼›</li></ul></li><li><p><strong><code>clear</code> <em>package</em></strong>ï¼šåˆ é™¤ä¸è½¯ä»¶åŒ…å…³è”çš„æ‰€æœ‰æ•°æ®ï¼›</p></li><li><p><strong><code>enable</code> <em>package_or_component</em></strong>ï¼šå¯ç”¨ç»™å®šè½¯ä»¶åŒ…æˆ–ç»„ä»¶ï¼ˆä½œä¸ºâ€œpackage/classâ€å†™å…¥ï¼‰ï¼›</p></li><li><p><strong><code>disable</code> <em>package_or_component</em></strong>ï¼šåœç”¨ç»™å®šè½¯ä»¶åŒ…æˆ–ç»„ä»¶ï¼ˆä½œä¸ºâ€œpackage/classâ€å†™å…¥ï¼‰ï¼›</p></li><li><p><strong><code>disable-user</code>[<em>options</em>] <em>package_or_component</em></strong></p><p>é€‰é¡¹æœ‰ï¼š</p><ul><li><strong><code>â€”user</code> <em>user_id</em> | current</strong>ï¼šæŒ‡å®šè¦ä½œä¸ºå“ªä¸ªç”¨æˆ·è¿è¡Œï¼›å¦‚æœæœªæŒ‡å®šï¼Œåˆ™ä½œä¸ºå½“å‰ç”¨æˆ·è¿è¡Œ;</li></ul></li><li><p>å…è®¸/æ’¤é”€æƒé™ï¼š</p><ul><li><p><code>grant</code> <em>package_name permission</em>ï¼šæˆäºˆåº”ç”¨æƒé™ï¼›</p></li><li><p><code>revoke</code> <em>package_name permission</em>ï¼šæ’¤é”€åº”ç”¨æƒé™ï¼›</p><div class="alert info"><p>åœ¨è¿è¡Œ Android 6.0ï¼ˆAPI çº§åˆ« 23ï¼‰åŠæ›´é«˜ç‰ˆæœ¬çš„è®¾å¤‡ä¸Šï¼Œå¯ä»¥æ˜¯åº”ç”¨æ¸…å•ä¸­å£°æ˜çš„ä»»ä½•æƒé™ã€‚åœ¨è¿è¡Œ Android 5.1ï¼ˆAPI çº§åˆ« 22ï¼‰å’Œæ›´ä½ç‰ˆæœ¬çš„è®¾å¤‡ä¸Šï¼Œå¿…é¡»æ˜¯åº”ç”¨å®šä¹‰çš„å¯é€‰æƒé™ã€‚</p></div></li></ul></li><li><p>è®¾ç½®/è·å–åº”ç”¨å®‰è£…ä½ç½®ï¼š</p><ul><li><p><code>set-install-location</code> <em>location</em>ï¼šæ›´æ”¹é»˜è®¤å®‰è£…ä½ç½®ï¼›</p></li><li><p><code>get-install-location</code>ï¼šè·å–é»˜è®¤å®‰è£…ä½ç½®ï¼›</p><p>ä¸Šè¿°å‘½ä»¤è®¾ç½®æˆ–è€…è·å–ç»“æœéƒ½æ˜¯ä¸‰ä¸ªå€¼ï¼š</p><ul><li><code>0</code>ï¼šè‡ªåŠ¨â€”è®©ç³»ç»Ÿå†³å®šæœ€ä½³ä½ç½®ã€‚</li><li><code>1</code>ï¼šå†…éƒ¨â€”å®‰è£…åœ¨å†…éƒ¨è®¾å¤‡å­˜å‚¨ä¸Šã€‚</li><li><code>2</code>ï¼šå¤–éƒ¨â€”å®‰è£…åœ¨å¤–éƒ¨ä»‹è´¨ä¸Šã€‚</li></ul><div class="alert info"><p>ä½¿ç”¨æ­¤å‘½ä»¤ä¼šå¯¼è‡´åº”ç”¨ä¸­æ–­å’Œå…¶å®ƒæ„å¤–è¡Œä¸º</p></div></li></ul></li><li><p><strong><code>set-permission-enforced</code> <em>permission</em> [true|false]</strong>ï¼šæŒ‡å®šæ˜¯å¦å¼ºåˆ¶æ‰§è¡Œç»™å®šçš„æƒé™ï¼›</p></li><li><p><strong><code>trim-caches</code> <em>desired_free_space</em></strong>ï¼šå‡å°‘ç¼“å­˜æ–‡ä»¶ä»¥è¾¾åˆ°ç»™å®šçš„å¯ç”¨ç©ºé—´ï¼›</p></li><li><p><strong><code>create-user</code> <em>user_name</em></strong>ï¼šåˆ›å»ºæ–°ç”¨æˆ· user_nameï¼›</p></li><li><p><strong><code>remove-user</code> user_id</strong>ï¼š ç§»é™¤ user_id å¯¹åº”çš„ç”¨æˆ·ï¼Œåˆ é™¤ä¸è¯¥ç”¨æˆ·å…³è”çš„æ‰€æœ‰æ•°æ®ï¼›</p></li><li><p><strong><code>get-max-users</code></strong>ï¼šè¾“å‡ºè®¾å¤‡æ”¯æŒçš„æœ€å¤§ç”¨æˆ·æ•°ï¼›</p></li></ul><h3 id="æˆªå›¾screencapä»¥åŠå½•åˆ¶è§†é¢‘screenrecord"><a class="anchor" href="#æˆªå›¾screencapä»¥åŠå½•åˆ¶è§†é¢‘screenrecord"></a> æˆªå›¾(<code>screencap</code>)ä»¥åŠå½•åˆ¶è§†é¢‘(<code>screenrecord</code>)</h3><ul><li><p>æˆªå›¾</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">adb shell screencap /sdcard/screen.png</span><br></pre></td></tr></table></figure></li><li><p>å½•åˆ¶è§†é¢‘ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">adb shell screenrecord [options] filename</span><br></pre></td></tr></table></figure><div class="alert info"><ul><li>éŸ³é¢‘å’Œè§†é¢‘ä¸èƒ½åŒæ—¶å½•åˆ¶ï¼›</li><li>æŒ‰ Control + C åœæ­¢å±å¹•å½•åˆ¶ï¼Œå¦åˆ™ï¼Œåˆ°ä¸‰åˆ†é’Ÿæˆ– <code>--time-limit</code> è®¾ç½®çš„æ—¶é—´é™åˆ¶æ—¶ï¼Œå½•åˆ¶å°†è‡ªåŠ¨åœæ­¢ï¼›</li></ul></div><p>è§†é¢‘å½•åˆ¶çš„å‚æ•°ï¼š</p><ul><li><p><code>--help</code>ï¼šæ˜¾ç¤ºå¸®åŠ©å‘½ä»¤ï¼›</p></li><li><p><code>--size</code> <em>width</em> x <em>height</em>ï¼šè®¾ç½®è§†é¢‘å¤§å°ï¼Œé»˜è®¤æ˜¯è®¾å¤‡çš„å…ƒç´ æ˜¾ç¤ºåˆ†è¾¨ç‡(å¦‚æœæ”¯æŒ)ï¼Œ<strong>å¦‚æœä¸æ”¯æŒåˆ™ä½¿ç”¨1280 x 720</strong>ï¼›</p></li><li><p><code>--bit-rate</code> <em>rate</em>ï¼šè®¾ç½®è§†é¢‘çš„è§†é¢‘æ¯”ç‰¹ç‡ï¼ˆä»¥å…†æ¯”ç‰¹æ¯ç§’ä¸ºå•ä½ï¼‰ã€‚é»˜è®¤å€¼ä¸º 4Mbpsã€‚æ‚¨å¯ä»¥å¢åŠ æ¯”ç‰¹ç‡ä»¥æå‡è§†é¢‘è´¨é‡ï¼Œä½†è¿™ä¹ˆåšä¼šå¯¼è‡´å½±ç‰‡æ–‡ä»¶å˜å¾—æ›´å¤§ï¼›</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">// è®¾ç½®æ¯”ç‰¹ç‡ä¸º6Mbps</span><br><span class="line">adb shell screenrecord --bit-rate 6000000 /sdcard/demo.mp4</span><br></pre></td></tr></table></figure></li><li><p><code>--time-limit</code> <em><strong>time</strong></em>ï¼šè®¾ç½®æœ€å¤§å½•åˆ¶æ—¶é—´ï¼Œå•ä½ä¸º <strong>s</strong>ï¼Œé»˜è®¤å€¼ä¸º 3åˆ†é’Ÿï¼›</p></li><li><p><code>--rotate</code>ï¼šè§†é¢‘è¾“å‡ºæ—‹è½¬90åº¦(<strong>å®éªŒåŠŸèƒ½</strong>)ï¼›</p></li><li><p><code>--verbose</code>ï¼šå•°å—¦æ¨¡å¼ï¼›</p></li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä½œä¸ºä¸€å Android å¼€å‘äººå‘˜ï¼Œadb å‘½ä»¤æ˜¯ä¸å¯ç¼ºå°‘çš„æŠ€èƒ½ä¹‹ä¸€ï¼Œåœ¨æ—¥å¸¸å·¥ä½œä¸­æˆ–å¤šæˆ–å°‘ä¼šç”¨åˆ°è¿™äº›å‘½ä»¤ï¼Œæœ¬ç¯‡å†…å®¹ä¸»è¦æ˜¯æ•´ç†äº†ä¸€äº›å¸¸ç”¨çš„ adb å‘½ä»¤ï¼ŒåŒæ—¶åŠ å¼ºè®°å¿†ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç¨‹åºçŒ¿è¿›åŒ–ä¹‹è·¯" scheme="http://www.istarx.cn/categories/%E7%A8%8B%E5%BA%8F%E7%8C%BF%E8%BF%9B%E5%8C%96%E4%B9%8B%E8%B7%AF/"/>
    
    
      <category term="android" scheme="http://www.istarx.cn/tags/android/"/>
    
      <category term="adb" scheme="http://www.istarx.cn/tags/adb/"/>
    
  </entry>
  
  <entry>
    <title>ARTSæ‰“å¡â€”ç¬¬9å‘¨</title>
    <link href="http://www.istarx.cn/2019/06/02/arts-week-nine/"/>
    <id>http://www.istarx.cn/2019/06/02/arts-week-nine/</id>
    <published>2019-06-02T13:02:06.000Z</published>
    <updated>2019-06-16T02:33:38.784Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>è¿™å‘¨åŠ äº†ä¸€å‘¨ç­ï¼Œæœ‰ä¸¤å¤©éƒ½åŠ åˆ°æ™šä¸Šä¸¤ç‚¹å¤šæ‰å›å®¶ï¼Œç´¯æˆç‹—äº†ğŸ¥¶ï¼Œå‘¨æœ«å¼ºåˆ¶ä¸å»åŠ ç­è¡¥è§‰ï¼Œç°åœ¨è¿˜æ²¡ç¼“è¿‡åŠ²æ¥å‘¢ã€‚æœ¬å‘¨æ‰“å¡å†…å®¹æœ‰ç‚¹å°‘ï¼Œä¸€é“å›æ–‡é“¾è¡¨ç›¸å…³çš„é¢˜ç›®ã€çœ‹äº†ä¸€ç¯‡å…³äº Android Studio  çš„æŠ€å·§ç±»æ–‡ç« ã€‚</p><a id="more"></a><p><ul class="toc js-fixedContent"><li><a href="#algorithm">Algorithm</a><ul><li><a href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0">é¢˜ç›®æè¿°</a></li></ul></li><li><a href="#review">Review</a></li><li><a href="#tips">Tips</a></li><li><a href="#share">Share</a></li></ul></p><h2 id="algorithm"><a class="anchor" href="#algorithm"></a> Algorithm</h2><h3 id="é¢˜ç›®æè¿°"><a class="anchor" href="#é¢˜ç›®æè¿°"></a> é¢˜ç›®æè¿°</h3><blockquote><p>åˆ¤æ–­ä¸€ä¸ªé“¾è¡¨æ˜¯å¦æ—¶å›æ–‡é“¾è¡¨</p><p><strong>Example</strong></p><p><strong>ç¤ºä¾‹ 1:</strong></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> è¾“å…¥: 1-&gt;2</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> è¾“å‡º: <span class="literal">false</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"></span></span><br></pre></td></tr></table></figure></blockquote><blockquote><p><strong>ç¤ºä¾‹ 2:</strong></p><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">&gt; è¾“å…¥: <span class="number">1</span>-&gt;<span class="number">2</span>-&gt;<span class="number">2</span>-&gt;<span class="number">1</span></span><br><span class="line">&gt; è¾“å‡º: <span class="literal">true</span></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><p>ç”¨å¿«æ…¢æ–¹æ³•æ‰¾åˆ°ä¸­ç‚¹ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æŠŠå‰åŠæ®µé“¾è¡¨å‹è¿›æ ˆï¼Œä¹‹åä»æ…¢èŠ‚ç‚¹å¼€å§‹å’Œæ ˆä¸­çš„å…ƒç´ ä¾æ¬¡è¿›è¡Œå¯¹æ¯”ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isPalindrome</span><span class="params">(ListNode head)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (head == <span class="keyword">null</span> || head.next == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ListNode slow = head;</span><br><span class="line">  ListNode fast = head;</span><br><span class="line">  Stack&lt;Integer&gt; pre = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">  <span class="keyword">while</span> (fast != <span class="keyword">null</span> &amp;&amp; fast.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">    pre.push(slow.val);</span><br><span class="line">    slow = slow.next;</span><br><span class="line">    fast = fast.next.next;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (fast != <span class="keyword">null</span>) &#123; <span class="comment">//å¥‡æ•°</span></span><br><span class="line">    slow = slow.next;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (slow != <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (slow.val != pre.pop()) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    slow = slow.next;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="review"><a class="anchor" href="#review"></a> Review</h2><p>æœ¬å‘¨é˜…è¯»å­¦ä¹ Android studio æŠ€å·§æ–¹é¢çš„ä¸€ä»½ wiki æ–‡æ¡£ï¼š<a href="https://github.com/pavlospt/Android-Studio-Tips-by-Philippe-Breault/wiki">Android-Studio-Tips-by-Philippe-Breault</a></p><h2 id="tips"><a class="anchor" href="#tips"></a> Tips</h2><ol><li>JobIntentService è°ƒåº¦æ˜¯ä¸ªé˜Ÿåˆ—ï¼Œå¦‚æœå‰é¢çš„ä»»åŠ¡æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å› ä¸ºè€—æ—¶ä»»åŠ¡æ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œåˆ™åé¢çš„ä»»åŠ¡æ— æ³•æ‰§è¡Œï¼Œæ‰€ä»¥è¦é¿å…åœ¨ JobIntentService ä¸­åšè€—æ—¶ä»»åŠ¡ï¼Œå°¤å…¶æ˜¯ä¸ç•Œé¢ç›¸å…³çš„ä»»åŠ¡ã€‚é™¤æ­¤ä¹‹å¤–å¦‚æœå‰é¢çš„ä»»åŠ¡æ‰§è¡Œçš„è¿‡ç¨‹ä¸­åº”ç”¨æˆ–è€…å‡ºç°å¼‚å¸¸ï¼Œåˆ™åé¢çš„ä»»åŠ¡ä¼šæ•´ä½“å»¶æ—¶30åˆ†é’Ÿï¼›</li><li>Messaging ä¸­çŸ­ä¿¡å‘é€æ˜¯ä¸ªä¸²è¡Œé˜Ÿåˆ—ï¼ŒåŒä¸€æ—¶é—´åªèƒ½å‘é€ä¸€æ¡çŸ­ä¿¡ï¼Œå¦‚æœå‰é¢å‘é€å¤±è´¥è§¦å‘äº†é‡å‘æœºåˆ¶ï¼Œåˆ™åé¢çš„çŸ­ä¿¡éƒ½ä¼šåŒæ­¥è¿›è¡Œå»¶æ—¶å‘é€ï¼›</li></ol><h2 id="share"><a class="anchor" href="#share"></a> Share</h2><p><a href="https://blog.csdn.net/houson_c/article/details/78461751">JobIntentServiceè¯¦è§£åŠä½¿ç”¨</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™å‘¨åŠ äº†ä¸€å‘¨ç­ï¼Œæœ‰ä¸¤å¤©éƒ½åŠ åˆ°æ™šä¸Šä¸¤ç‚¹å¤šæ‰å›å®¶ï¼Œç´¯æˆç‹—äº†ğŸ¥¶ï¼Œå‘¨æœ«å¼ºåˆ¶ä¸å»åŠ ç­è¡¥è§‰ï¼Œç°åœ¨è¿˜æ²¡ç¼“è¿‡åŠ²æ¥å‘¢ã€‚æœ¬å‘¨æ‰“å¡å†…å®¹æœ‰ç‚¹å°‘ï¼Œä¸€é“å›æ–‡é“¾è¡¨ç›¸å…³çš„é¢˜ç›®ã€çœ‹äº†ä¸€ç¯‡å…³äº Android Studio  çš„æŠ€å·§ç±»æ–‡ç« ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ARTSæ‰“å¡" scheme="http://www.istarx.cn/categories/ARTS%E6%89%93%E5%8D%A1/"/>
    
    
      <category term="ARTS" scheme="http://www.istarx.cn/tags/ARTS/"/>
    
  </entry>
  
  <entry>
    <title>ARTSæ‰“å¡â€”ç¬¬8å‘¨</title>
    <link href="http://www.istarx.cn/2019/05/26/arts-week-eight/"/>
    <id>http://www.istarx.cn/2019/05/26/arts-week-eight/</id>
    <published>2019-05-26T09:05:21.000Z</published>
    <updated>2019-06-16T07:52:49.391Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æœ¬å‘¨åšçš„å†…å®¹æ¯”è¾ƒå°‘ï¼ŒæŠ˜è…¾äº†ä¸€é“ LRU ç¼“å­˜çš„é¢˜ç›®ï¼Œé¡ºä¾¿å­¦ä¹ äº†ç›¸å…³çš„ LinkedHashMap æ•°æ®ç»“æ„ã€‚é™¤æ­¤ä¹‹å¤–çœ‹äº†ä¸€ç¯‡ RxJava ç³»åˆ—çš„æ–‡ç« ã€‚</p><a id="more"></a><p><ul class="toc js-fixedContent"><li><a href="#algorithm">Algorithm</a><ul><li><a href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0">é¢˜ç›®æè¿°</a></li><li><a href="#%E6%96%B9%E6%B3%95%E4%B8%80">æ–¹æ³•ä¸€</a></li><li><a href="#%E6%96%B9%E6%B3%95%E4%BA%8C">æ–¹æ³•äºŒ</a></li></ul></li><li><a href="#review">Review</a></li><li><a href="#tips">Tips</a></li><li><a href="#share">Share</a></li></ul></p><h2 id="algorithm"><a class="anchor" href="#algorithm"></a> Algorithm</h2><h3 id="é¢˜ç›®æè¿°"><a class="anchor" href="#é¢˜ç›®æè¿°"></a> é¢˜ç›®æè¿°</h3><blockquote><p>Design and implement a data structure for <a href="https://en.wikipedia.org/wiki/Cache_replacement_policies#LRU">Least Recently Used (LRU) cache</a>. It should support the following operations: <code>get</code> and <code>put</code>.</p><p><strong>Example:</strong></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&gt; LRUCache cache = <span class="keyword">new</span> LRUCache( <span class="number">2</span> <span class="comment">/* capacity */</span> );</span><br><span class="line">&gt; </span><br><span class="line">&gt; cache.put(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">&gt; cache.put(<span class="number">2</span>, <span class="number">2</span>);</span><br><span class="line">&gt; cache.get(<span class="number">1</span>);       <span class="comment">// returns 1</span></span><br><span class="line">&gt; cache.put(<span class="number">3</span>, <span class="number">3</span>);    <span class="comment">// evicts key 2</span></span><br><span class="line">&gt; cache.get(<span class="number">2</span>);       <span class="comment">// returns -1 (not found)</span></span><br><span class="line">&gt; cache.put(<span class="number">4</span>, <span class="number">4</span>);    <span class="comment">// evicts key 1</span></span><br><span class="line">&gt; cache.get(<span class="number">1</span>);       <span class="comment">// returns -1 (not found)</span></span><br><span class="line">&gt; cache.get(<span class="number">3</span>);       <span class="comment">// returns 3</span></span><br><span class="line">&gt; cache.get(<span class="number">4</span>);       <span class="comment">// returns 4</span></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><p>è®¾è®¡ä¸€ä¸ª LRU ç¼“å­˜ï¼Œå®ç° get ä»¥åŠ put æ–¹æ³•ã€‚</p><h3 id="æ–¹æ³•ä¸€"><a class="anchor" href="#æ–¹æ³•ä¸€"></a> æ–¹æ³•ä¸€</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LRUCache</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> mCapacity;</span><br><span class="line">  <span class="keyword">private</span> Map&lt;Integer, Integer&gt; mCache;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">LRUCache</span><span class="params">(<span class="keyword">int</span> capacity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.mCapacity = capacity;</span><br><span class="line">    mCache = <span class="keyword">new</span> LinkedHashMap();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (mCache.containsKey(key)) &#123;</span><br><span class="line">      <span class="keyword">int</span> newValue = mCache.get(key);</span><br><span class="line">      mCache.remove(key);</span><br><span class="line">      mCache.put(key, newValue);</span><br><span class="line">      <span class="keyword">return</span> newValue;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (mCache.containsKey(key)) &#123;</span><br><span class="line">      mCache.remove(key, value);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mCache.size() &gt;= mCapacity) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> k : lru.keySet()) &#123;</span><br><span class="line">        mCache.remove(k);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    mCache.put(key, value);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•äºŒ"><a class="anchor" href="#æ–¹æ³•äºŒ"></a> æ–¹æ³•äºŒ</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">class LRUMap&lt;K, V&gt; extends LinkedHashMap&lt;K, V&gt; &#123;</span><br><span class="line">    private int cacheSize ;</span><br><span class="line"></span><br><span class="line">    public LRUMap(int capacity) &#123;</span><br><span class="line">        super(capacity, <span class="number">0.75</span>f, true) ; //access-based eviction set to <span class="string">'true'</span> (<span class="keyword">as</span> opposed to <span class="string">'insertion'</span>-based eviciton)</span><br><span class="line">        cacheSize = capacity ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">    @Override</span></span><br><span class="line">    protected boolean removeEldestEntry(Map.Entry&lt;K, V&gt; eldest) &#123;</span><br><span class="line">        <span class="keyword">return</span> size() &gt; cacheSize ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public class LRUCache  &#123;</span><br><span class="line">LRUMap&lt;Integer, Integer&gt; map ; //use extension of LinkedHashMap here</span><br><span class="line">    public LRUCache(int capacity) &#123;</span><br><span class="line">        map = new LRUMap&lt;Integer, Integer&gt;(capacity) ; //make sure to <span class="keyword">pass</span> <span class="string">'capacity'</span> on to LinkedHashMap ctor</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public int get(int key) &#123;</span><br><span class="line">        <span class="keyword">if</span>(map.containsKey(key)) &#123;</span><br><span class="line">            <span class="keyword">return</span> map.get(key) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void set(int key, int value) &#123;</span><br><span class="line">        map.put(key, value) ; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="review"><a class="anchor" href="#review"></a> Review</h2><ul><li><p>æœ¬å‘¨é˜…è¯»å­¦ä¹  RxJavaç³»åˆ—çš„æ–‡ç« ã€‚ä¸»è¦è®²è¿°äº†åˆ¤æ–­ç±»å‹çš„ä¸€äº›æ“ä½œï¼š</p><ul><li><strong>All</strong>ï¼š åˆ¤æ–­ä¼ é€’çš„æ‰€æœ‰å‚æ•°æ˜¯å¦æ»¡è¶³ä¸€å®šæ¡ä»¶ï¼Œç»“æœæ˜¯ Bool ç±»å‹ï¼Œ ä¼šè¿”å›è¯¥ç»“æœç»™ onNext() æ–¹æ³•ï¼›</li><li><strong>Amb</strong>ï¼šä¼šå¿½ç•¥åå‘äº‹ä»¶çš„ Observable æ‰€æœ‰äº‹ä»¶ä¼ é€’ï¼Œè€Œä¸å¿½ç•¥å…ˆå‘äº‹ä»¶çš„ Observable å¯¹è±¡ï¼›</li><li><strong>Contains</strong>ï¼šåˆ¤æ–­ä¼ é€’çš„æ‰€æœ‰å‚æ•°æ˜¯å¦åŒ…å«æŸä¸€å‚æ•°ï¼Œç»“æœæ˜¯ Bool ç±»å‹ï¼Œ ä¼šè¿”å›è¯¥ç»“æœç»™ onNext() æ–¹æ³•</li><li><strong>DefaultIfEmpty</strong>: å¦‚æœ Observable å¯¹è±¡æ²¡æœ‰ä¼ é€’ä»»ä½•äº‹ä»¶æˆ–è€…æ•°æ®ï¼Œåˆ™ä¼ é€’è¯¥é»˜è®¤æ•°æ®æˆ–äº‹ä»¶ï¼›</li><li><strong>SequenceEqual</strong>ï¼šåˆ¤æ–­ä¸¤ä¸ª Observable å¯¹è±¡ä¼ é€’çš„å‚æ•°æ˜¯å¦å®Œå…¨ä¸€è‡´ï¼›</li><li><strong>SkipUntil</strong>: å¿½ç•¥æŸä¸ª Observable å¯¹è±¡ä¼ é€’çš„æ•°æ®ï¼Œç›´åˆ°å¦å¤–ä¸€ä¸ª Observable å¯¹è±¡å¼€å§‹ä¼ æ•°æ®ï¼›</li><li><strong>SkipWhile</strong>ï¼šå½“æŸæ¡ä»¶ä¸º true æ—¶ä¸€ç›´å¿½ç•¥ä¼ é€’çš„å‚æ•°ï¼Œç›´åˆ°å®ƒä¸º false æ—¶æ‰å¼€å§‹ä¼ é€’ï¼›</li><li><strong>TakeUntil</strong>ï¼šå’Œ skipUtil æ­£å¥½ç›¸åï¼›</li><li><strong>takeWhile</strong>ï¼šå’Œ SkipWhile æ­£å¥½ç›¸åï¼›</li></ul><p><a href="https://proandroiddev.com/exploring-rxjava-in-android-conditional-and-boolean-operators-3bca84c773af">Exploring RxJava in Androidâ€Šâ€”â€ŠConditional and Boolean Operators</a></p></li></ul><h2 id="tips"><a class="anchor" href="#tips"></a> Tips</h2><ol><li><p>actionbar ä¸­è®¾ç½®è‡ªå®šä¹‰viewï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">actionbar.setDisplayShowCustomEnabled(<span class="keyword">true</span>); <span class="comment">// æ˜¾ç¤ºè‡ªå®šä¹‰view</span></span><br><span class="line">actionbar.setDisplayShowTitleEnabled(<span class="keyword">false</span>); <span class="comment">// ä¸æ˜¾ç¤ºåŸtitle</span></span><br><span class="line">actionbar.setCustomView(view);</span><br></pre></td></tr></table></figure></li><li><p>bit.getPixel(x, y) è·å– bitmap ä¸­æŸä¸ªåƒç´ ç‚¹çš„é¢œè‰²ï¼›</p></li></ol><h2 id="share"><a class="anchor" href="#share"></a> Share</h2><p><a href="https://my.oschina.net/crossoverjie/blog/3051516">çº¿ç¨‹æ± æ²¡ä½ æƒ³çš„é‚£ä¹ˆç®€å•</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ¬å‘¨åšçš„å†…å®¹æ¯”è¾ƒå°‘ï¼ŒæŠ˜è…¾äº†ä¸€é“ LRU ç¼“å­˜çš„é¢˜ç›®ï¼Œé¡ºä¾¿å­¦ä¹ äº†ç›¸å…³çš„ LinkedHashMap æ•°æ®ç»“æ„ã€‚é™¤æ­¤ä¹‹å¤–çœ‹äº†ä¸€ç¯‡ RxJava ç³»åˆ—çš„æ–‡ç« ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ARTSæ‰“å¡" scheme="http://www.istarx.cn/categories/ARTS%E6%89%93%E5%8D%A1/"/>
    
    
      <category term="ARTS" scheme="http://www.istarx.cn/tags/ARTS/"/>
    
  </entry>
  
  <entry>
    <title>ARTSæ‰“å¡â€”ç¬¬7å‘¨</title>
    <link href="http://www.istarx.cn/2019/05/19/arts-week-seven/"/>
    <id>http://www.istarx.cn/2019/05/19/arts-week-seven/</id>
    <published>2019-05-19T12:50:14.000Z</published>
    <updated>2019-05-26T12:41:37.925Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>å‘¨æœ«æ„Ÿå†’å•Šï¼Œå¤´ç–¼ï¼Œå„ç§ä¸èˆ’æœï¼Œéš¾æœï¼Œé¦™è‡ï¼Œå¤§å®¶åƒä¸‡æ³¨æ„èº«ä½“å•Šã€‚æœ¬å‘¨ç®—æ³•é¢˜ç›®æ˜¯ä¸€ä¸ªæ¶‰åŠæ ˆçš„é¢˜ç›®ï¼Œ Review æ–¹é¢æ¥ç€ä¸Šå‘¨çœ‹äº†ä¸€åŠçš„ RxJava ç³»åˆ—ï¼Œèº«ä½“åŸå› åªçœ‹äº†ä¸€ç¯‡ã€‚</p><a id="more"></a><p><ul class="toc js-fixedContent"><li><a href="#algorithm">Algorithm</a><ul><li><a href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0">é¢˜ç›®æè¿°</a></li><li><a href="#java">Java</a></li><li><a href="#python">Python</a></li></ul></li><li><a href="#review">Review</a></li><li><a href="#tips">Tips</a></li><li><a href="#share">Share</a></li></ul></p><h2 id="algorithm"><a class="anchor" href="#algorithm"></a> Algorithm</h2><h3 id="é¢˜ç›®æè¿°"><a class="anchor" href="#é¢˜ç›®æè¿°"></a> é¢˜ç›®æè¿°</h3><blockquote><p>Given a string containing just the characters <code>'('</code>, <code>')'</code>, <code>'{'</code>, <code>'}'</code>, <code>'['</code> and <code>']'</code>, determine if the input string is valid.</p><p>An input string is valid if:</p><ol><li>Open brackets must be closed by the same type of brackets.</li><li>Open brackets must be closed in the correct order.</li></ol><p>Note that an empty string is also considered valid.</p><p><strong>Example 1:</strong></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> Input: <span class="string">"()"</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> Output: <span class="literal">true</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"></span></span><br></pre></td></tr></table></figure></blockquote><p>è¿™ä¸ªé¢˜ç›®å’Œç®—æ•°è¿ç®—åº”è¯¥éƒ½æ˜¯å±äºä¸€ä¸ªç³»åˆ—çš„ï¼Œåˆ©ç”¨æ ˆæ¥åˆ¤æ–­æ‹¬å¼§æ˜¯å¦åŒ¹é…ï¼Œè¿›è€Œåˆ¤æ–­ä¼˜å…ˆçº§å¹¶è¿›è¡Œè¿ç®—å¤„ç†ã€‚</p><h3 id="java"><a class="anchor" href="#java"></a> Java</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isValid</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">  Map&lt;Character, Character&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">  map.put(<span class="string">'('</span>, <span class="string">')'</span>);</span><br><span class="line">  map.put(<span class="string">'['</span>, <span class="string">']'</span>);</span><br><span class="line">  map.put(<span class="string">'&#123;'</span>, <span class="string">'&#125;'</span>);</span><br><span class="line">  Stack&lt;Character&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">char</span> c : s.toCharArray()) &#123;</span><br><span class="line">    <span class="keyword">if</span> (map.containsKey(c)) &#123;</span><br><span class="line">      stack.push(c);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (stack.isEmpty()) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">char</span> temp = stack.pop();</span><br><span class="line">      <span class="keyword">if</span> (c != map.get(temp)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> stack.isEmpty();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="python"><a class="anchor" href="#python"></a> Python</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isValid</span><span class="params">(self, s: str)</span> -&gt; bool:</span></span><br><span class="line">  dic = &#123;<span class="string">'('</span>: <span class="string">')'</span>, <span class="string">'['</span>: <span class="string">']'</span>, <span class="string">'&#123;'</span>: <span class="string">'&#125;'</span>&#125;</span><br><span class="line">  lst = []</span><br><span class="line">  <span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">    <span class="keyword">if</span> c <span class="keyword">in</span> dic.keys():</span><br><span class="line">      lst.append(c)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      <span class="keyword">if</span> len(lst) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">      <span class="keyword">if</span> c != dic[lst.pop()]:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">  <span class="keyword">return</span> len(lst) == <span class="number">0</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>Runtime</th><th>Memory</th><th>Language</th></tr></thead><tbody><tr><td>28 ms</td><td>13.3 MB</td><td>python</td></tr><tr><td>2 ms</td><td>33.5 MB</td><td>java</td></tr></tbody></table><h2 id="review"><a class="anchor" href="#review"></a> Review</h2><p>æœ¬å‘¨é˜…è¯»å­¦ä¹  RxJavaç³»åˆ—çš„æ–‡ç« ã€‚ä¸»è¦è®²è¿°äº† <code>Observable</code> å…¶å®ƒä½¿ç”¨æ“ä½œï¼š</p><ul><li><strong>Delay</strong>ï¼š å°†æ‰€æœ‰å…ƒç´ çš„æ“ä½œå»¶æ—¶ä¸€å®šæ—¶é—´ï¼›</li><li><strong>Do</strong>ï¼šæ³¨å†Œä¸€ä¸ª Observable å¯¹è±¡ç”Ÿå‘½å‘¨æœŸçš„ action æ¥æ‰§è¡Œç›¸å…³æ“ä½œ<code>doOnNext</code>ã€<code>doOnCompleted</code>ã€<code>doOnEach</code>ã€<code>doOnSubscribe</code>ï¼›</li><li><strong>Materialize/Dematerialize</strong></li><li><strong>ObserveOn</strong>: æŒ‡å®šåå°çº¿ç¨‹ï¼›</li><li><strong>SubscribeOn</strong>ï¼šå‰å°å›è°ƒçš„çº¿ç¨‹ï¼›</li><li><strong>Timeout</strong>:  åœ¨è¶…å‡ºä¸€å®šæ—¶é—´åè¿˜æ²¡æœ‰ä¼ é€’æ—¶é—´æ—¶ä¼šæœ‰é”™è¯¯äº‹ä»¶ä¼ é€’ï¼Œå³æ‰§è¡ŒonError</li><li><strong>Timestamp</strong>ï¼šå°†ä¼ é€’çš„å…ƒç´ è½¬æ¢æˆ<code>Timestamped&lt;T&gt;</code>ç±»å‹çš„æ•°æ®ï¼Œé‡Œé¢ä¸ä»…åŒ…å«äº†åŸæœ‰çš„æ•°æ®ï¼Œè¿˜åŒ…å«å…ƒç´ ä¼ é€’çš„æ—¶é—´ï¼›</li><li><strong>Using</strong>ï¼šåˆ›å»ºä¸€ä¸ªä¸€æ¬¡æ€§çš„èµ„æºï¼Œæ­¤èµ„æºå’Œ Observable å¯¹è±¡æ‹¥æœ‰ç›¸åŒçš„ç”Ÿå‘½å‘¨æœŸ</li></ul><p><a href="https://proandroiddev.com/exploring-rxjava-in-android-utility-operators-a6115024800d">Exploring RxJava in Androidâ€Šâ€”â€ŠUtility Operators</a></p><h2 id="tips"><a class="anchor" href="#tips"></a> Tips</h2><ol><li><p>Android ä¸­è®¡æ—¶æ§ä»¶å¯ä»¥ç”¨ <code>Chronometer</code>ï¼Œå…¶æœ¬è´¨è¿˜æ˜¯ä¸€ä¸ª TextViewã€‚</p></li><li><p>SQL ä¸­çš„<code>LIKE</code>å…³é”®å­—ï¼Œå¯ä»¥æ­é… <code>%</code>æˆ–è€…<code>_</code>ä½¿ç”¨ï¼Œå…¶ä¸­ç™¾åˆ†å·ï¼ˆ%ï¼‰ä»£è¡¨é›¶ä¸ªã€ä¸€ä¸ªæˆ–å¤šä¸ªæ•°å­—æˆ–å­—ç¬¦ã€‚ä¸‹åˆ’çº¿ï¼ˆ_ï¼‰ä»£è¡¨ä¸€ä¸ªå•ä¸€çš„æ•°å­—æˆ–å­—ç¬¦ï¼Œä¸¤è€…å¯ä»¥ç»„åˆä½¿ç”¨ã€‚</p></li><li><p>Android ä¸­è·‘ monkey å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">adb shell monkey [options] &lt;event-count&gt;</span><br></pre></td></tr></table></figure><p>option å‚æ•°éƒ¨åˆ†å¯ä»¥æŒ‡å®šmonkey çš„åŒ…åï¼Œäº‹ä»¶ç±»å‹åŠæ¯”ä¾‹ç­‰ã€‚</p></li><li><p>æœ¬åœ°ä»“åº“å…³è”è¿œç¨‹ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git remote add origin https://github.com/user_name/repositories_name.git</span><br></pre></td></tr></table></figure></li></ol><h2 id="share"><a class="anchor" href="#share"></a> Share</h2><p><a href="https://blog.csdn.net/qq_39521554/article/details/80469666">Pythonä¸­stack(),vstack(),hstack()çš„ç”¨æ³•å’ŒåŒºåˆ«</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‘¨æœ«æ„Ÿå†’å•Šï¼Œå¤´ç–¼ï¼Œå„ç§ä¸èˆ’æœï¼Œéš¾æœï¼Œé¦™è‡ï¼Œå¤§å®¶åƒä¸‡æ³¨æ„èº«ä½“å•Šã€‚æœ¬å‘¨ç®—æ³•é¢˜ç›®æ˜¯ä¸€ä¸ªæ¶‰åŠæ ˆçš„é¢˜ç›®ï¼Œ Review æ–¹é¢æ¥ç€ä¸Šå‘¨çœ‹äº†ä¸€åŠçš„ RxJava ç³»åˆ—ï¼Œèº«ä½“åŸå› åªçœ‹äº†ä¸€ç¯‡ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ARTSæ‰“å¡" scheme="http://www.istarx.cn/categories/ARTS%E6%89%93%E5%8D%A1/"/>
    
    
      <category term="ARTS" scheme="http://www.istarx.cn/tags/ARTS/"/>
    
  </entry>
  
  <entry>
    <title>ARTSæ‰“å¡â€”ç¬¬6å‘¨</title>
    <link href="http://www.istarx.cn/2019/05/12/arts-week-six/"/>
    <id>http://www.istarx.cn/2019/05/12/arts-week-six/</id>
    <published>2019-05-12T06:27:45.000Z</published>
    <updated>2019-05-12T08:26:57.295Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>è¿™å‘¨çš„æ‰“å¡å†…å®¹ä¸»è¦æ˜¯ä¸€é“æ•°ç»„æ“ä½œç›¸å…³çš„é¢˜ç›®ï¼Œæ•°æ®åº“æ–¹é¢æ˜¯ä¸€é“ <code>JOIN</code> å’Œ <code>IN</code> å…³é”®å­—ç›¸å…³çš„é¢˜ç›®ï¼Œä»¥åŠ Review ä¸¤ç¯‡ RxJava ä¸­ Observable å¯¹è±¡è¿‡æ»¤åŠç»„åˆç›¸å…³çš„æ–‡ç« ã€‚</p><a id="more"></a><p><ul class="toc js-fixedContent"><li><a href="#algorithm">Algorithm</a><ul><li><a href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0">é¢˜ç›®æè¿°</a></li><li><a href="#java">Java</a></li><li><a href="#python">Python</a></li></ul></li><li><a href="#database">Database</a></li><li><a href="#review">Review</a><ul><li><a href="#observable%E8%BF%87%E6%BB%A4"><code>Observable</code>è¿‡æ»¤</a></li><li><a href="#obserable%E7%BB%84%E5%90%88"><code>Obserable</code>ç»„åˆ</a></li></ul></li><li><a href="#tips">Tips</a></li><li></li><li><a href="#share">Share</a></li></ul></p><h2 id="algorithm"><a class="anchor" href="#algorithm"></a> Algorithm</h2><h3 id="é¢˜ç›®æè¿°"><a class="anchor" href="#é¢˜ç›®æè¿°"></a> é¢˜ç›®æè¿°</h3><blockquote><p><a href="https://leetcode.com/problems/max-increase-to-keep-city-skyline/">807. Max Increase to Keep City Skyline</a></p></blockquote><h3 id="java"><a class="anchor" href="#java"></a> Java</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxIncreaseKeepingSkyline</span><span class="params">(<span class="keyword">int</span>[][] grid)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (grid == <span class="keyword">null</span> || grid.length == <span class="number">0</span> || grid[<span class="number">0</span>].length == <span class="number">0</span> ||</span><br><span class="line">      grid.length == <span class="number">1</span> &amp;&amp; grid[<span class="number">0</span>].length == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">int</span> N = grid.length;</span><br><span class="line">  <span class="keyword">int</span>[] leftRight = <span class="keyword">new</span> <span class="keyword">int</span>[N];</span><br><span class="line">  <span class="keyword">int</span>[] topBottom = <span class="keyword">new</span> <span class="keyword">int</span>[N];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j&lt; N; j++) &#123;</span><br><span class="line">      leftRight[i] = Math.max(leftRight[i], grid[i][j]);</span><br><span class="line">      topBottom[i] = Math.max(topBottom[i], grid[j][i]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N; j++) &#123;</span><br><span class="line">      res += Math.min(leftRight[i], topBottom[j]) - grid[i][j];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="python"><a class="anchor" href="#python"></a> Python</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">maxIncreaseKeepingSkyline</span><span class="params">(self, grid: List[List[int]])</span> -&gt; int:</span></span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">not</span> grid <span class="keyword">or</span> len(grid) == <span class="number">0</span> <span class="keyword">or</span> len(grid) ==<span class="number">1</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">  N = len(grid)</span><br><span class="line">  row = [<span class="number">-1</span>] * N</span><br><span class="line">  col = [<span class="number">-1</span>] * N</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(N):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(N):</span><br><span class="line">      row[i] = max(row[i], grid[i][j])</span><br><span class="line">      col[i] = max(col[i], grid[j][i])</span><br><span class="line">  res = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(N):</span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> range(N):</span><br><span class="line">    res = res + min(row[i], col[j]) - grid[i][j]</span><br><span class="line">  <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><table><thead><tr><th>Runtime</th><th>Memory</th><th>Language</th></tr></thead><tbody><tr><td>68 ms</td><td>13.4 MB</td><td>python</td></tr><tr><td>1 ms</td><td>41.7 MB</td><td>java</td></tr></tbody></table><h2 id="database"><a class="anchor" href="#database"></a> Database</h2><blockquote><p><strong>596. Classes More Than 5 Students</strong></p><p>The <code>Employee</code> table holds all employees. Every employee has an Id, a salary, and there is also a column for the department Id.</p><p>The <code>Department</code> table holds all departments of the company.</p><p>Write a SQL query to find employees who have the highest salary in each of the departments. For the above tables, your SQL query should return the following rows (order of rows does not matter)</p></blockquote><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    Department.Name <span class="keyword">AS</span> <span class="string">"Department"</span>,</span><br><span class="line">    Employee.Name <span class="keyword">AS</span> <span class="string">"Employee"</span>,</span><br><span class="line">    Employee.Salary</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    Employee</span><br><span class="line">    <span class="keyword">JOIN</span></span><br><span class="line">    Department <span class="keyword">ON</span> Department.Id = Employee.DepartmentId</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    (Employee.DepartmentId , Salary) <span class="keyword">IN</span></span><br><span class="line">    (<span class="keyword">SELECT</span> </span><br><span class="line">        DepartmentId , <span class="keyword">Max</span>(Salary)</span><br><span class="line">     <span class="keyword">FROM</span> </span><br><span class="line">        Employee</span><br><span class="line">     <span class="keyword">GROUP</span> <span class="keyword">BY</span> DepartmentId</span><br><span class="line">    )</span><br></pre></td></tr></table></figure><p>ä¸»è¦ç”¨åˆ°äº†<code>NOT IN</code>å…³é”®å­—ã€‚</p><h2 id="review"><a class="anchor" href="#review"></a> Review</h2><p>æœ¬å‘¨æ¥ç€çœ‹äº†RxJavaç³»åˆ—çš„æ–‡ç« ä¸­çš„ç¬¬ä¸‰åŠç¬¬å››ç¯‡ã€‚ä¸»è¦è®²è¿°äº† <code>Observable</code>çš„è¿‡æ»¤å’Œç»„åˆã€‚</p><h3 id="observableè¿‡æ»¤"><a class="anchor" href="#observableè¿‡æ»¤"></a> <code>Observable</code>è¿‡æ»¤</h3><ul><li><strong>Debounce</strong>ï¼š<code>debounce()</code>æ–¹æ³•ä¼šåœ¨è®¾ç½®æ—¶é—´å†…æ²¡æœ‰ä¼ é€’æ•°æ®æˆ–äº‹ä»¶çš„æƒ…å†µä¸‹æ‰ä¼šä¼ é€’æ­¤æ—¶é—´ä¹‹å‰çš„æœ€åä¸€ä¸ªæ•°æ®æˆ–è€…äº‹ä»¶ï¼›</li><li><strong>Distinct()</strong>ï¼šè¿‡æ»¤é‡å¤æ•°æ®æˆ–è€…æ—¶é—´ï¼Œéœ€è¦é‡å†™æ—¶é—´æˆ–è€…æ•°æ®çš„<code>equals</code>æ–¹æ³•ï¼›</li><li><strong>ElementAt</strong>ï¼šä»…ä¼ é€’ä¼ é€’åºåˆ—ä¸­çš„ç¬¬ N ä¸ªæ•°æ®æˆ–è€…å…ƒç´ ï¼›</li><li><strong>Filter</strong>ï¼š å¯¹åŸå§‹ä¼ é€’çš„å…ƒç´ è¿›è¡Œè¿‡æ»¤ï¼Œä»…ä¼ é€’æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼›</li><li><strong>IgnoreElements</strong>ï¼šå¿½ç•¥æ‰€æœ‰å…ƒç´ çš„ä¼ é€’ï¼Œä½†æ˜¯ä¼šåœ¨ä¼ é€’å®Œæˆåä¼šè¿›è¡Œé€šçŸ¥ï¼Œå¦‚æœä¸å…³å¿ƒæ‰€ä¼ é€’çš„å…ƒç´ ï¼Œä»…ä»…åœ¨ä¼ é€’å®Œæˆåè¿›è¡Œé€šçŸ¥ï¼Œåˆ™å¯ä»¥ä½¿ç”¨æ­¤æ–¹æ³•ï¼›</li><li><strong>Sample</strong>ï¼šå¯¹ä¼ é€’å…ƒç´ æ¯éš”ä¸€å®šé˜¶æ®µå†ä¼ é€’ä¸€æ¬¡ï¼›</li><li><strong>Skip</strong>ï¼šè·³è¿‡å¼€å§‹çš„ N ä¸ªå…ƒç´ ï¼›</li><li><strong>skipLast</strong>ï¼šè·³è¿‡ç»“å°¾çš„ N ä¸ªå…ƒç´ ï¼›</li><li><strong>Take</strong>ï¼šä»…ä¼ é€’å¼€å§‹çš„ N ä¸ªå…ƒç´ ï¼›</li><li><strong>TakeLast</strong>ï¼šä»…ä¼ é€’æœ€åçš„ N ä¸ªå…ƒç´ ï¼›</li></ul><h3 id="obserableç»„åˆ"><a class="anchor" href="#obserableç»„åˆ"></a> <code>Obserable</code>ç»„åˆ</h3><ul><li><strong>CombineLatest</strong>ï¼šå½“æŸå…ƒç´ è¢«ä¸¤ä¸ª Observable å¯¹è±¡åˆ†åˆ«ä¹‹ä¸€å‘é€æ—¶ï¼Œå¯æ˜¯æŠŠä¸¤ä¸ªObservable å¯¹è±¡è¿›è¡Œç»„åˆï¼Œå¹¶ä¼ é€’ç»è¿‡å¤„ç†ä¹‹åçš„å…ƒç´ ï¼›</li><li><strong>Join</strong>ï¼šå½“ä¸¤ä¸ªå…ƒç´ æœ‰é‡åˆæ—¶ï¼ŒæŠŠæ‰€ä¼ é€’çš„å…ƒç´ ä¸¤ä¸ªå…ƒç´ å½“æˆä¸€å¯¹ç—…ç»è¿‡å¤„ç†å†è¿›è¡Œä¼ é€’ï¼›</li><li><strong>Merge</strong>ï¼šå°†å¤šä¸ª Observable å¯¹è±¡åˆå¹¶ä¸ºä¸€ä¸ªï¼Œåˆå¹¶ä¹‹åä¼ é€’æ•°æ®æ—¶åŒæ­¥ä¼ è¾“ï¼Œå¹¶éç­‰å¾…å‰é¢çš„ Observable ä¼ é€’å®Œæˆååé¢çš„æ‰å¼€å§‹ä¼ é€’ï¼›</li><li><strong>Concat</strong>ï¼šæŠŠä¸¤ä¸ªæˆ–è€…å¤šä¸ª Observable å¯¹è±¡åˆå¹¶ä¸ºä¸€ä¸ªï¼Œè€Œéæ’å…¥ï¼Œåˆå¹¶ä¹‹åçš„ Observable æ•°æ®ä¼ é€’æ—¶é¡ºåºä¼ é€’çš„ï¼Œå³ç¬¬ä¸€ä¸ª Observable ä¼ é€’å®Œæ¯•ä¹‹åæ‰ä¼šä¼ é€’ç¬¬äºŒä¸ª Observable å¯¹è±¡çš„æ•°æ®(åŒºåˆ«äº Merge)ï¼›</li><li><strong>Zip</strong>ï¼šå°†å¤šä¸ª Observable å¯¹è±¡çš„ä¼ é€’çš„å…ƒç´ é€šè¿‡ä¸€å®šçš„æ–¹æ³•è¿›è¡Œå¤„ç†ï¼Œå¹¶åªä¼ é€’å¤„ç†ä¹‹åçš„ç»“æœï¼›</li><li><strong>SwitchOnNext</strong>ï¼šåœ¨ç¬¬äºŒä¸ª Observable å¼€å§‹ä¼ é€’ä¹‹å‰ç¬¬ä¸€ä¸ª Observable ä¸€ç›´ä¼šä¼ é€’æ•°æ®ï¼Œå½“ç¬¬äºŒä¸ª Observable å¼€å§‹ä¼ é€’æ•°æ®æ—¶ï¼Œå–æ¶ˆç¬¬ä¸€ä¸ª Observable å¯¹è±¡çš„è®¢é˜…ï¼Œå¹¶åˆ‡æ¢åˆ°è®¢é˜…ç¬¬äºŒä¸ª Observable å¯¹è±¡ï¼›</li></ul><p><a href="https://proandroiddev.com/exploring-rxjava-in-android-operators-for-filtering-observables-b0a299ea23a3">Exploring RxJava in Androidâ€Šâ€”â€ŠOperators for Filtering Observables</a></p><h2 id="tips"><a class="anchor" href="#tips"></a> Tips</h2><ol><li><p>python list åˆå§‹åŒ–ï¼š<code>[-1] * N</code></p></li><li><p>adb å‘½ä»¤è·å–logçš„æ—¶å€™æœ‰æ—¶å€™ä¼šå¡ç€ä¸åŠ¨ï¼Œè¿™æ—¶å€™å¯ä»¥è·å–è¯•è¯•ï¼Œå¦‚æœè¿˜ä¸è¡Œçš„è¯ä½¿ç”¨Android Studioè‡ªå¸¦çš„Device Exploeræ‰“å¼€logæ‰€åœ¨çš„æ–‡ä»¶å¤¹ï¼Œåˆ†æ‰¹æ¬¡å–å‡ºlogï¼ŒçŒœæµ‹æ˜¯logæ–‡ä»¶å¤ªå¤§å¯¼è‡´ï¼›</p></li><li><p>imeå‘½ä»¤å¯ä»¥ç»Ÿè®¡cpuå®é™…è¿è¡Œäº†å¤šé•¿æ—¶é—´ï¼Œå‘½ä»¤è¿”å›ä¸‰ä¸ªå€¼ï¼Œreal timeä¹Ÿå°±æ˜¯wall clock timeï¼Œç¬¬äºŒä¸ªæ˜¯user timeï¼Œcpuè¿è¡Œä½ çš„ç¨‹åºï¼Œåœ¨ç”¨æˆ·æ€è¿è¡Œçš„æ—¶é—´ï¼Œç¬¬ä¸‰ä¸ªä¸ªsys timeï¼Œæ˜¯cpuè¿è¡Œç¨‹åºæ—¶å†…æ ¸é‡Œè¿è¡ŒæŒ‡ä»¤çš„æ—¶é—´ï¼Œå®é™…ç¨‹åºè¿è¡Œæ—¶é—´ä¸ºuser time+sys time;</p></li><li><p><code>print(**f**â€xxx {var} yyyâ€)</code>æ ¼å¼åŒ–è¾“å‡ºå­—ç¬¦ä¸²ï¼Œformatæ–¹æ³•å¯ä»¥å¾—åˆ°åŒæ ·çš„ç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = â€˜cuzâ€™</span><br><span class="line">str_var = â€˜His name <span class="keyword">is</span> &#123;&#125;â€™</span><br><span class="line">str_var.format(name)</span><br><span class="line"><span class="comment"># Output: His name is cuz</span></span><br></pre></td></tr></table></figure></li><li><p>pythonä¸­çš„æœ‰åºå­—å…¸: <code>collections.OrderedDict</code></p></li><li><p>Linux ä¸­ç›®å½•åˆ‡æ¢ï¼špushdã€popd</p></li><li><p>å‚æ•°è§£åŒ…ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> argv</span><br><span class="line">a, b, c = argv <span class="comment"># å‚æ•°è§£åŒ…</span></span><br></pre></td></tr></table></figure></li></ol><h2 id=""><a class="anchor" href="#"></a> </h2><h2 id="share"><a class="anchor" href="#share"></a> Share</h2><p>Android OOMæ¡ˆä¾‹åˆ†æï¼š<a href="https://tech.meituan.com/2017/04/14/oom-analysis.html">https://tech.meituan.com/2017/04/14/oom-analysis.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™å‘¨çš„æ‰“å¡å†…å®¹ä¸»è¦æ˜¯ä¸€é“æ•°ç»„æ“ä½œç›¸å…³çš„é¢˜ç›®ï¼Œæ•°æ®åº“æ–¹é¢æ˜¯ä¸€é“ &lt;code&gt;JOIN&lt;/code&gt; å’Œ &lt;code&gt;IN&lt;/code&gt; å…³é”®å­—ç›¸å…³çš„é¢˜ç›®ï¼Œä»¥åŠ Review ä¸¤ç¯‡ RxJava ä¸­ Observable å¯¹è±¡è¿‡æ»¤åŠç»„åˆç›¸å…³çš„æ–‡ç« ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ARTSæ‰“å¡" scheme="http://www.istarx.cn/categories/ARTS%E6%89%93%E5%8D%A1/"/>
    
    
      <category term="ARTS" scheme="http://www.istarx.cn/tags/ARTS/"/>
    
  </entry>
  
  <entry>
    <title>ARTSæ‰“å¡â€”ç¬¬5å‘¨</title>
    <link href="http://www.istarx.cn/2019/05/03/arts-week-five/"/>
    <id>http://www.istarx.cn/2019/05/03/arts-week-five/</id>
    <published>2019-05-03T05:02:44.000Z</published>
    <updated>2019-05-12T08:19:44.291Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>äº”ä¸€æ”¾å‡æ²¡æœ‰å‡ºé—¨ï¼Œçœ‹ç€å„ç§äººæŒ¤äººï¼Œè½¦æŒ¤è½¦ï¼Œæˆ‘å¿ƒç”šæ…°ğŸ¤£ğŸ¤£ã€‚è¿™å‘¨çš„æ‰“å¡å†…å®¹ä¸»è¦æ˜¯ä¸€é“äºŒå‰æ ‘éå†é¢˜ç›®ï¼Œæ•°æ®åº“æ–¹é¢æ˜¯ä¸€é“<code>NOT IN</code>å…³é”®å­—çš„é¢˜ç›®ï¼Œä»¥åŠ REVIEW ä¸€ç¯‡ RxJava çš„æ–‡ç« ã€‚</p><a id="more"></a><p><ul class="toc js-fixedContent"><li><a href="#algorithm">Algorithm</a><ul><li><a href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0">é¢˜ç›®æè¿°</a></li><li><a href="#java">Java</a></li><li><a href="#python">Python</a></li></ul></li><li><a href="#database">Database</a></li><li><a href="#review">Review</a></li><li><a href="#tips">Tips</a></li><li><a href="#share">Share</a></li></ul></p><h2 id="algorithm"><a class="anchor" href="#algorithm"></a> Algorithm</h2><h3 id="é¢˜ç›®æè¿°"><a class="anchor" href="#é¢˜ç›®æè¿°"></a> é¢˜ç›®æè¿°</h3><blockquote><p>Given a binary tree, return the <em>inorder</em> traversal of its nodesâ€™ values.</p><p><strong>Example:</strong></p><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">&gt; Input: [<span class="number">1</span>,<span class="literal">null</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">&gt;    <span class="number">1</span></span><br><span class="line">&gt;     \</span><br><span class="line">&gt;      <span class="number">2</span></span><br><span class="line">&gt;     /</span><br><span class="line">&gt;    <span class="number">3</span></span><br><span class="line">&gt; </span><br><span class="line">&gt; Output: [<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>]</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><p>äºŒå‰æ ‘çš„éå†é—®é¢˜ï¼Œæœ€ç»å…¸çš„æ–¹æ³•å°±æ˜¯é€’å½’äº†ã€‚</p><h3 id="java"><a class="anchor" href="#java"></a> Java</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">inorderTraversal</span><span class="params">(TreeNode root)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (root == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">  &#125;</span><br><span class="line">  List&lt;Integer&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;(inorderTraversal(root.left));</span><br><span class="line">  res.add(root.val);</span><br><span class="line">  res.addAll(inorderTraversal(root.right));</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="python"><a class="anchor" href="#python"></a> Python</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line">  res = []</span><br><span class="line">  res.extend(self.inorderTraversal(root.left))</span><br><span class="line">  res.append(root.val)</span><br><span class="line">  res.extend(self.inorderTraversal(root.right))</span><br><span class="line">  <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><table><thead><tr><th>Runtime</th><th>Memory</th><th>Language</th></tr></thead><tbody><tr><td>36 ms</td><td>13.1 MB</td><td>python</td></tr><tr><td>1 ms</td><td>36.1 MB</td><td>java</td></tr></tbody></table><h2 id="database"><a class="anchor" href="#database"></a> Database</h2><blockquote><p><strong>596. Classes More Than 5 Students</strong></p><p>There is a table <code>courses</code> with columns: <strong>student</strong> and <strong>class</strong></p><p>Please list out all classes which have more than or equal to 5 students.</p><p><strong>Note:</strong><br>The students should not be counted duplicate in each course.</p></blockquote><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    <span class="keyword">class</span></span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">    (<span class="keyword">SELECT</span> </span><br><span class="line">    <span class="keyword">class</span>, <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span>(student)) <span class="keyword">AS</span> <span class="keyword">num</span> </span><br><span class="line">    <span class="keyword">FROM</span> courses</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">class</span>) <span class="keyword">AS</span> tmp</span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">    <span class="keyword">num</span> &gt;= <span class="number">5</span></span><br></pre></td></tr></table></figure><p>ä¸»è¦ç”¨åˆ°äº†<code>NOT IN</code>å…³é”®å­—ã€‚</p><h2 id="review"><a class="anchor" href="#review"></a> Review</h2><p>æœ¬å‘¨æ¥ç€çœ‹äº†RxJavaç³»åˆ—çš„æ–‡ç« ä¸­çš„ç¬¬äºŒç¯‡ã€‚ä¸»è¦è®²è¿°äº† <code>Observable</code>ä¼ é€’è¿‡ç¨‹ä¸­çš„ç›¸å…³æ“ä½œï¼š</p><ul><li><strong>Buffer</strong>ï¼šObservable.buffer(int num)æ–¹æ³•ï¼Œä¼šå‘¨æœŸæ€§çš„ä» Obserable ä¸­å–å‡º num ä¸ªæ•°çš„æ•°æ®æˆ–è€…äº‹ä»¶ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ¥ä¸€ä¸ªçš„ä¼ é€’ï¼›</li><li><strong>Map</strong>ï¼šè¯¥æ–¹æ³•æ˜¯å¯¹æ¯ä¸€ä¸ªä¼ é€’çš„æ•°æ®æˆ–è€…äº‹ä»¶è¿›è¡Œå¤„ç†ï¼Œå¤„ç†å®Œæ¯•ä¹‹åå†è¿›è¡Œå‘ä¸‹ä¼ é€’ï¼›</li><li><strong>FlatMap</strong>ï¼šè¯¥æ–¹æ³•è¿”å›çš„è¿˜æ˜¯ä¸€ä¸ª Observable å¯¹è±¡ï¼Œæ˜¯å¯¹åŸæ¥ä¼ é€’çš„æ•°æ®è¿›è¡Œå¤„ç†ï¼Œè¿”å›ä¸€ä¸ªå¯¹åº”çš„ Observable å¯¹è±¡(ä¸»è¦ç”¨äºå¯¹å…ƒç´ é¡ºåºä¸å…³æ³¨çš„æƒ…å†µ)ï¼›</li><li><strong>SwitchMap</strong>ï¼š è¿”å›åŸå§‹ Observable å¯¹è±¡ä¼ é€’æ•°æ®ä¸­æœ€åçš„ä¸€é¡¹ ï¼›</li><li><strong>ConcatMap</strong>ï¼šå’Œ flatMap æœ‰ç‚¹ç±»ä¼¼ï¼›</li><li><strong>GroupBy</strong>ï¼šå°†åŸå§‹ Observable å¯¹è±¡ä¼ é€’çš„æ•°æ®æŒ‰æŸä¸€ key è¿›è¡Œåˆ†ç±»ï¼Œå°†åˆ†ç±»ä¹‹åçš„æ•°æ®è¿›è¡Œä¼ é€’(applyæ–¹æ³•è¿”å›ä¸º <code>true</code> çš„æ—¶å€™è¯¥æ•°æ®æˆ–äº‹ä»¶æ‰ä¼šè¿›è¡Œä¼ é€’)ï¼›</li><li><strong>Scan</strong>ï¼šå¯¹ä¼ é€’çš„å‚æ•°è¿›è¡Œå¤„ç†ï¼Œä½†æ˜¯è¯¥å‚æ•°ä¸ä»…ä»…æŒ‡å½“å‰ä¼ é€’çš„ï¼Œè¿˜åŒ…æ‹¬ä»¥å‰ä¼ é€’çš„ã€‚</li></ul><p><a href="https://proandroiddev.com/exploring-rxjava-in-android-operators-for-transforming-observables-367c22d86677">Exploring RxJava in Androidâ€Šâ€”â€ŠOperators for Transforming Observables</a></p><h2 id="tips"><a class="anchor" href="#tips"></a> Tips</h2><ol><li><p>pythonä¸­ç»™listä¸€æ¬¡æ·»åŠ å¤šä¸ªå…ƒç´ æ—¶ä½¿ç”¨æ–¹æ³•<code>extend()</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">list1 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">list2 = [<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line">list1.extend(list2)</span><br><span class="line"><span class="comment"># list1 is [1,2,3,2,3,4]</span></span><br></pre></td></tr></table></figure></li><li><p>pythonä¸­è¯»å–ä¸€ä¸ªæ–‡ä»¶çš„æ‰€æœ‰å†…å®¹é™¤äº†<code>file.readlines()</code>æ–¹æ³•ï¼Œè¿˜å¯ä»¥ä½¿ç”¨<code>file.read()</code>æ–¹æ³•ï¼›</p></li><li><p>NinePatchDrawable åœ¨ç»™ background è®¾ç½® bounds ä¹‹åï¼Œä¸‹æ¬¡ draw æ—¶ bottom ä¼šå˜å°ï¼Œå¯¼è‡´çœ‹èµ·æ¥ä¼šé—ªä¸€ä¸‹ï¼Œç›®å‰æƒ³åˆ°çš„è§£å†³åŠæ³•å°±æ˜¯åœ¨åŸæ¥èƒŒæ™¯çš„åŸºç¡€ä¸Šé€šè¿‡è®¾ç½®ç€è‰²è¾¾åˆ°æ”¹å˜èƒŒæ™¯çš„ç›®çš„ã€‚</p></li></ol><h2 id="share"><a class="anchor" href="#share"></a> Share</h2><p>python å†…å®¹è¾ƒå¤šçš„æ–‡ä»¶å†…å®¹è¯»å–æ–¹å¼æ¯”è¾ƒï¼š<a href="https://www.cnblogs.com/6tian/p/5886284.html">https://www.cnblogs.com/6tian/p/5886284.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;äº”ä¸€æ”¾å‡æ²¡æœ‰å‡ºé—¨ï¼Œçœ‹ç€å„ç§äººæŒ¤äººï¼Œè½¦æŒ¤è½¦ï¼Œæˆ‘å¿ƒç”šæ…°ğŸ¤£ğŸ¤£ã€‚è¿™å‘¨çš„æ‰“å¡å†…å®¹ä¸»è¦æ˜¯ä¸€é“äºŒå‰æ ‘éå†é¢˜ç›®ï¼Œæ•°æ®åº“æ–¹é¢æ˜¯ä¸€é“&lt;code&gt;NOT IN&lt;/code&gt;å…³é”®å­—çš„é¢˜ç›®ï¼Œä»¥åŠ REVIEW ä¸€ç¯‡ RxJava çš„æ–‡ç« ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ARTSæ‰“å¡" scheme="http://www.istarx.cn/categories/ARTS%E6%89%93%E5%8D%A1/"/>
    
    
      <category term="ARTS" scheme="http://www.istarx.cn/tags/ARTS/"/>
    
  </entry>
  
  <entry>
    <title>ARTSæ‰“å¡â€”ç¬¬4å‘¨</title>
    <link href="http://www.istarx.cn/2019/04/27/arts-week-four/"/>
    <id>http://www.istarx.cn/2019/04/27/arts-week-four/</id>
    <published>2019-04-27T11:35:01.000Z</published>
    <updated>2019-05-03T05:00:32.759Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>é©¬ä¸Šäº”ä¸€æ”¾å‡äº†ï½ä½†æ˜¯ï¼Œä½†æ˜¯ï¼ï¼ï¼ä½†æ˜¯äº”ä¸€è¦åŠ ç­ï¼Œå‘œå‘¼å“€å“‰ã€‚ã€‚ã€‚è¿™å‘¨çš„æ‰“å¡ä¸»è¦æ˜¯ä¸€é“å›æ–‡æ•°åˆ¤æ–­çš„é¢˜ç›®ï¼Œæ•°æ®åº“æ–¹é¢æ˜¯ä¸€é“<code>NOT IN</code>å…³é”®å­—çš„é¢˜ç›®ï¼Œä»¥åŠ REVIEW ä¸€ç¯‡ RxJava çš„æ–‡ç« ã€‚</p><a id="more"></a><p><ul class="toc js-fixedContent"><li><a href="#algorithm">Algorithm</a><ul><li><a href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0">é¢˜ç›®æè¿°</a></li><li><a href="#java">Java</a></li><li><a href="#python">Python</a></li></ul></li><li><a href="#database">Database</a></li><li><a href="#review">Review</a></li><li><a href="#tips">Tips</a></li><li><a href="#share">Share</a></li></ul></p><h2 id="algorithm"><a class="anchor" href="#algorithm"></a> Algorithm</h2><h3 id="é¢˜ç›®æè¿°"><a class="anchor" href="#é¢˜ç›®æè¿°"></a> é¢˜ç›®æè¿°</h3><blockquote><p>Determine whether an integer is a palindrome. An integer is a palindrome when it reads the same backward as forward.</p><p><strong>Example 1:</strong></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> Input: 121</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> Output: <span class="literal">true</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"></span></span><br></pre></td></tr></table></figure></blockquote><blockquote><p><strong>Follow up:</strong></p><p>Coud you solve it without converting the integer to a string?</p></blockquote><p>å›æ–‡æ•°åˆ¤æ–­ï¼Œä¸€ç§æ–¹æ³•æ˜¯æŠŠæ•´æ•°è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œåˆ¤æ–­æ­£åå­—ç¬¦ä¸²æ˜¯å¦ç›¸åŒï¼Œä½†æ˜¯é¢˜ç›®ä¸­è¦æ±‚ä¸èƒ½ä½¿ç”¨å­—ç¬¦ä¸²ã€‚ç¬¬äºŒç§å°±æ˜¯æŠŠæ•´æ•°åè½¬ï¼Œå¯ä»¥æ•´è½¬æˆ–è€…åŠè½¬ï¼ŒåŠè½¬çš„æ•ˆç‡ç›¸å¯¹è¾ƒé«˜ï¼Œæ‰€ä»¥é‡‡ç”¨åŠè½¬çš„æ–¹æ³•ã€‚</p><h3 id="java"><a class="anchor" href="#java"></a> Java</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isPalindrome</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (x &lt; <span class="number">0</span> || (x % <span class="number">10</span> == <span class="number">0</span> &amp;&amp; x != <span class="number">0</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">long</span> reverseNumber = <span class="number">0</span>;</span><br><span class="line">  reverseNumber = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (reverseNumber &lt; x) &#123;</span><br><span class="line">    reverseNumber = reverseNumber * <span class="number">10</span> + x % <span class="number">10</span>;</span><br><span class="line">    x = x / <span class="number">10</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> x == reverseNumber || x == reverseNumber / <span class="number">10</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="python"><a class="anchor" href="#python"></a> Python</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isPalindrome</span><span class="params">(self, x: int)</span> -&gt; bool:</span></span><br><span class="line">  <span class="keyword">if</span> x &lt; <span class="number">0</span> <span class="keyword">or</span> x % <span class="number">10</span> == <span class="number">0</span> <span class="keyword">and</span> x != <span class="number">0</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">False</span>;</span><br><span class="line">  reverseNumber = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (reverseNumber &lt; x):</span><br><span class="line">    reverseNumber = reverseNumber * <span class="number">10</span> + x % <span class="number">10</span></span><br><span class="line">    x = x // <span class="number">10</span></span><br><span class="line">    <span class="keyword">return</span> x == reverseNumber <span class="keyword">or</span> x == reverseNumber // <span class="number">10</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>Runtime</th><th>Memory</th><th>Language</th></tr></thead><tbody><tr><td>84 ms</td><td>13.2 MB</td><td>python</td></tr><tr><td>6 ms</td><td>34.5 MB</td><td>java</td></tr></tbody></table><h2 id="database"><a class="anchor" href="#database"></a> Database</h2><blockquote><p><strong>183. Customers Who Never Order</strong></p><p>Suppose that a website contains two tables, the <code>Customers</code> table and the <code>Orders</code> table. Write a SQL query to find all customers who never order anything.</p></blockquote><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Customers.Name <span class="keyword">AS</span> Customers</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">    Customers.Id <span class="keyword">NOT</span> <span class="keyword">IN</span> </span><br><span class="line">        (<span class="keyword">SELECT</span> Orders.CustomerId <span class="keyword">FROM</span> Orders)</span><br></pre></td></tr></table></figure><p>ä¸»è¦ç”¨åˆ°äº†<code>NOT IN</code>å…³é”®å­—ã€‚</p><h2 id="review"><a class="anchor" href="#review"></a> Review</h2><p>æœ¬å‘¨ç”±äºå·¥ä½œæ¯”è¾ƒå¿™ï¼Œæ‰€ä»¥åªçœ‹äº†RxJavaç³»åˆ—çš„æ–‡ç« ä¸­çš„ç¬¬ä¸€ç¯‡ã€‚ä¸»è¦è®²è¿°äº† <code>Observable</code> ä»¥åŠå…¶åŸºæœ¬æ“ä½œï¼š</p><ul><li><p><strong>Create</strong>ï¼šObservable.create()æ–¹æ³•ï¼Œä¼ å…¥ObservableOnSubscribeå¯¹è±¡ï¼Œéœ€è¦å®ç°æ­¤å¯¹è±¡çš„<code>subscribe</code>æ–¹æ³•ï¼›</p></li><li><p><strong>Defer</strong>ï¼šå’Œ Create ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºä¸æ˜¯æ¯æ¬¡éƒ½åˆ›å»ºæ–°çš„ Observable å¯¹è±¡ï¼Œæ•ˆç‡æ›´é«˜ï¼›</p></li><li><p><strong>From</strong>ï¼šä»ä¸€ä¸ªæ•°ç»„æˆ–è€…è¿­ä»£å™¨åˆ›å»º Observable å¯¹è±¡ï¼ŒåŒ…æ‹¬<code>fromCallable(), fromFuture(), fromIterable(), fromPublisher(), fromArray()</code></p></li><li><p><strong>Interval</strong>ï¼š åˆ›å»ºæ¯éš”ä¸€å®šæ—¶é—´æäº¤æ—¶é—´çš„ Observable å¯¹è±¡ï¼›</p></li><li><p><strong>Just</strong>ï¼šä¼ å…¥ä¸€ç³»åˆ—çš„å‚æ•°(æœ€å¤š10ä¸ª)ï¼Œæ‰€åˆ›å»ºçš„ Observable å¯¹è±¡ä¾æ¬¡æŠŠè¿™äº›å‚æ•°è½¬æ¢æˆ Observable å…ƒç´ å¹¶è¿›è¡Œäº‹ä»¶å‘é€ã€‚</p><div class="alert info"><p>from å’Œ just çš„åŒºåˆ«åœ¨äº just ä¸€æ¬¡æŠŠæ‰€æœ‰çš„å…ƒç´ å‘å¸ƒå‡ºæ¥ï¼Œä½†æ˜¯ from åˆ™æ˜¯æŠŠå…ƒç´ ä¾æ¬¡å‘å¸ƒå‡ºæ¥</p></div></li><li><p><strong>Range</strong>ï¼šä¼ å…¥ä¸¤ä¸ªå‚æ•°åˆ†åˆ«åœ¨èµ·å§‹å€¼å’Œé•¿åº¦ï¼Œåˆ™ä¼šå‘å¸ƒå¯¹åº”çš„å…ƒç´ åºåˆ—ï¼›</p></li><li><p><strong>Repeat</strong>ï¼šå‘å¸ƒæ—¶é—´çš„é‡å¤æ¬¡æ•°</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Observable.range(<span class="number">2</span>, <span class="number">5</span>)</span><br><span class="line">          .repeat(<span class="number">2</span>) <span class="comment">//ä¸Šé¢çš„åºåˆ—è¿ç»­å‘å¸ƒä¸¤æ¬¡</span></span><br></pre></td></tr></table></figure></li><li><p><strong>Timer</strong>ï¼šåˆ›å»ºä¸€ä¸ª Observable å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨ç‰¹å®šæ—¶é—´ä¹‹åå‘å¸ƒä¸€ä¸ªäº‹ä»¶ï¼›</p><div class="alert info"><p>interval å’Œ timer çš„åŒºåˆ«åœ¨äº time ä»…ä»…åªå‘é€ä¸€æ¬¡äº‹ä»¶ï¼Œä½†æ˜¯ interval åˆ™æ˜¯æ¯éš”ä¸€å®šæ—¶é—´ä¼šå‘å¸ƒäº‹ä»¶ï¼›</p></div></li></ul><p><a href="https://proandroiddev.com/exploring-rxjava-in-android-e52ed7ef32e2">Exploring RxJava in Androidâ€Šâ€”â€ŠIntroduction</a></p><h2 id="tips"><a class="anchor" href="#tips"></a> Tips</h2><ol><li><p>æœ¬åœ°å’Œè¿œç¨‹ä»“åº“å…³è”ï¼šgit branch --set-upstream-to &lt;æœ¬åœ°åˆ†æ”¯&gt; origin/&lt;è¿œç¨‹åˆ†æ”¯&gt;ï¼›</p></li><li><p>æœ¬åœ°ä»“åº“å…³è”è¿œç¨‹ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git remote add origin https://github.com/user_name/repositories_name.git</span><br></pre></td></tr></table></figure></li><li><p>å»ºç«‹ç´¢å¼•:</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> index_name <span class="keyword">on</span> table_name</span><br></pre></td></tr></table></figure></li></ol><h2 id="share"><a class="anchor" href="#share"></a> Share</h2><p>ä¸€ç¯‡ Android å†…å­˜ä¼˜åŒ–ç›¸å…³çš„æ–‡ç« ï¼š<a href="https://mp.weixin.qq.com/s/2MsEAR9pQfMr1Sfs7cPdWQ">Android å†…å­˜ä¼˜åŒ–æ€»ç»“&amp;å®è·µ</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;é©¬ä¸Šäº”ä¸€æ”¾å‡äº†ï½ä½†æ˜¯ï¼Œä½†æ˜¯ï¼ï¼ï¼ä½†æ˜¯äº”ä¸€è¦åŠ ç­ï¼Œå‘œå‘¼å“€å“‰ã€‚ã€‚ã€‚è¿™å‘¨çš„æ‰“å¡ä¸»è¦æ˜¯ä¸€é“å›æ–‡æ•°åˆ¤æ–­çš„é¢˜ç›®ï¼Œæ•°æ®åº“æ–¹é¢æ˜¯ä¸€é“&lt;code&gt;NOT IN&lt;/code&gt;å…³é”®å­—çš„é¢˜ç›®ï¼Œä»¥åŠ REVIEW ä¸€ç¯‡ RxJava çš„æ–‡ç« ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ARTSæ‰“å¡" scheme="http://www.istarx.cn/categories/ARTS%E6%89%93%E5%8D%A1/"/>
    
    
      <category term="ARTS" scheme="http://www.istarx.cn/tags/ARTS/"/>
    
  </entry>
  
  <entry>
    <title>ARTSæ‰“å¡â€”ç¬¬3å‘¨</title>
    <link href="http://www.istarx.cn/2019/04/21/arts-week-three/"/>
    <id>http://www.istarx.cn/2019/04/21/arts-week-three/</id>
    <published>2019-04-21T14:00:11.000Z</published>
    <updated>2019-04-21T14:52:25.571Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æœ¬å‘¨ä¸»è¦æ˜¯åšäº†ä¸€é“å…³äºé“¾è¡¨ç›¸å…³æ“ä½œçš„ç®—æ³•é¢˜ç›®ï¼Œæ•°æ®åº“æŸ¥è¯¢çš„é¢˜ç›®ï¼Œé˜…è¯»äº†ä¸€ç¯‡å…³äº UI è‡ªåŠ¨åŒ–æµ‹è¯•ç›¸å…³çš„è‹±æ–‡æ–‡ç« ï¼Œä»”ç»†å­¦ä¹ äº†ä¸‹ ConstraintLayout ç›¸å…³çš„èµ„æ–™ï¼ŒåæœŸè¦ä»”ç»†æ€»ç»“ä¸€ä¸‹ç›¸å…³çš„çŸ¥è¯†ã€‚</p><a id="more"></a><p><ul class="toc js-fixedContent"><li><a href="#algorithm">Algorithm</a><ul><li><a href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0">é¢˜ç›®æè¿°</a></li><li><a href="#java">Java</a></li><li><a href="#python">Python</a></li></ul></li><li><a href="#database">Database</a></li><li><a href="#review">Review</a></li><li><a href="#tips">Tips</a></li><li><a href="#share">Share</a></li></ul></p><h2 id="algorithm"><a class="anchor" href="#algorithm"></a> Algorithm</h2><h3 id="é¢˜ç›®æè¿°"><a class="anchor" href="#é¢˜ç›®æè¿°"></a> é¢˜ç›®æè¿°</h3><blockquote><p>You are given two <strong>non-empty</strong> linked lists representing two non-negative integers. The digits are stored in <strong>reverse order</strong> and each of their nodes contain a single digit. Add the two numbers and return it as a linked list.</p><p>You may assume the two numbers do not contain any leading zero, except the number 0 itself.</p><p><strong>Example:</strong></p><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">&gt; Input: (<span class="number">2</span> -&gt; <span class="number">4</span> -&gt; <span class="number">3</span>) + (<span class="number">5</span> -&gt; <span class="number">6</span> -&gt; <span class="number">4</span>)</span><br><span class="line">&gt; Output: <span class="number">7</span> -&gt; <span class="number">0</span> -&gt; <span class="number">8</span></span><br><span class="line">&gt; Explanation: <span class="number">342</span> + <span class="number">465</span> = <span class="number">807.</span></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><p>é¢˜ç›®ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œåªæ˜¯ç®€å•çš„é“¾è¡¨æ“ä½œã€‚</p><h3 id="java"><a class="anchor" href="#java"></a> Java</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">addTwoNumbers</span><span class="params">(ListNode l1, ListNode l2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l1 == <span class="keyword">null</span> || l2 == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> l1 == <span class="keyword">null</span> ? l2 == <span class="keyword">null</span> ? <span class="keyword">null</span> : l2 : l1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> upNum = <span class="number">0</span>;</span><br><span class="line">    ListNode current = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</span><br><span class="line">    ListNode res = current;</span><br><span class="line">    <span class="keyword">while</span> (l1 != <span class="keyword">null</span> || l2 != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> tmp = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (l1 != <span class="keyword">null</span>) &#123;</span><br><span class="line">            tmp += l1.val;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (l2 != <span class="keyword">null</span>) &#123;</span><br><span class="line">            tmp += l2.val;</span><br><span class="line">        &#125;</span><br><span class="line">        tmp += upNum;</span><br><span class="line">        ListNode tmpNode= <span class="keyword">new</span> ListNode(tmp % <span class="number">10</span>);</span><br><span class="line">        current.next = tmpNode;</span><br><span class="line">        current = tmpNode;</span><br><span class="line">        upNum = tmp / <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">if</span> (l1 != <span class="keyword">null</span>) &#123;</span><br><span class="line">            l1 = l1.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (l2 != <span class="keyword">null</span>) &#123;</span><br><span class="line">            l2 = l2.next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (upNum != <span class="number">0</span>) &#123;</span><br><span class="line">        current.next = <span class="keyword">new</span> ListNode(upNum);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res.next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="python"><a class="anchor" href="#python"></a> Python</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addTwoNumbers</span><span class="params">(self, l1: ListNode, l2: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> l1 <span class="keyword">or</span> <span class="keyword">not</span> l2:</span><br><span class="line">        <span class="keyword">if</span> l1:</span><br><span class="line">            <span class="keyword">return</span> l1</span><br><span class="line">        <span class="keyword">elif</span> l2:</span><br><span class="line">            <span class="keyword">return</span> l2</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">None</span></span><br><span class="line">    current = ListNode(<span class="number">0</span>)</span><br><span class="line">    res = current</span><br><span class="line">    upNum = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> l1 <span class="keyword">or</span> l2:</span><br><span class="line">        tmp = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> l1:</span><br><span class="line">            tmp = tmp + l1.val</span><br><span class="line">        <span class="keyword">if</span> l2:</span><br><span class="line">            tmp = tmp + l2.val</span><br><span class="line">        tmp = tmp + upNum</span><br><span class="line">        upNum = tmp // <span class="number">10</span></span><br><span class="line">        tmpNode = ListNode(tmp % <span class="number">10</span>)</span><br><span class="line">        current.next = tmpNode</span><br><span class="line">        current = tmpNode</span><br><span class="line">        <span class="keyword">if</span> l1:</span><br><span class="line">            l1 = l1.next</span><br><span class="line">        <span class="keyword">if</span> l2:</span><br><span class="line">            l2 = l2.next</span><br><span class="line">    <span class="keyword">if</span> upNum != <span class="number">0</span>:</span><br><span class="line">        current.next = ListNode(upNum)</span><br><span class="line">    <span class="keyword">return</span> res.next</span><br></pre></td></tr></table></figure><table><thead><tr><th>Runtime</th><th>Memory</th><th>Language</th></tr></thead><tbody><tr><td>96ms</td><td>13.4 MB</td><td>python</td></tr><tr><td>2ms</td><td>45.1 MB</td><td>java</td></tr></tbody></table><h2 id="database"><a class="anchor" href="#database"></a> Database</h2><blockquote><p><strong>181. Employees Earning More Than Their Managers</strong></p><p>The <code>Employee</code> table holds all employees including their managers. Every employee has an Id, and there is also a column for the manager Id.</p><figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">&gt; +----+-------+--------+-----------+</span><br><span class="line">&gt; |<span class="string"> Id </span>|<span class="string"> Name  </span>|<span class="string"> Salary </span>|<span class="string"> ManagerId </span>|</span><br><span class="line">&gt; +----+-------+--------+-----------+</span><br><span class="line">&gt; |<span class="string"> 1  </span>|<span class="string"> Joe   </span>|<span class="string"> 70000  </span>|<span class="string"> 3         </span>|</span><br><span class="line">&gt; |<span class="string"> 2  </span>|<span class="string"> Henry </span>|<span class="string"> 80000  </span>|<span class="string"> 4         </span>|</span><br><span class="line">&gt; |<span class="string"> 3  </span>|<span class="string"> Sam   </span>|<span class="string"> 60000  </span>|<span class="string"> NULL      </span>|</span><br><span class="line">&gt; |<span class="string"> 4  </span>|<span class="string"> Max   </span>|<span class="string"> 90000  </span>|<span class="string"> NULL      </span>|</span><br><span class="line">&gt; +----+-------+--------+-----------+</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p>Given the <code>Employee</code> table, write a SQL query that finds out employees who earn more than their managers. For the above table, Joe is the only employee who earns more than his manager.</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> +----------+</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> | Employee |</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> +----------+</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> | Joe      |</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> +----------+</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"></span></span><br></pre></td></tr></table></figure></blockquote><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    a.Name <span class="keyword">AS</span> Employee</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">    Employee <span class="keyword">AS</span> a,</span><br><span class="line">    Employee <span class="keyword">AS</span> b</span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">    a.ManagerId = b.Id <span class="keyword">AND</span> a.Salary &gt; b.Salary</span><br></pre></td></tr></table></figure><p>ç”¨åˆ°çš„æ–¹æ³•å°±æ˜¯æ˜¯æŠŠè¡¨æŸ¥è¯¢ä¸¤éï¼Œé€šè¿‡å¯¹æ¯”ä¸¤ä¸ªè¡¨çš„æ•°æ®æ¥ç¡®å®šæœ€åçš„ç»“æœã€‚</p><h2 id="review"><a class="anchor" href="#review"></a> Review</h2><p>æœ¬å‘¨ä¸»è¦å­¦ä¹ äº†å’Œ UI æµ‹è¯•ç›¸å…³çš„æ–‡ç« ï¼Œæ–‡ç« ä¸­ç”¨åˆ°äº† Espressã€Mock æ¡†æ¶ï¼Œå¯¹å¼‚æ­¥åˆ·æ–° UI æ•°æ®çš„æƒ…å†µè¿›è¡Œäº†æµ‹è¯•æ–¹æ³•çš„ä»‹ç»ã€‚</p><p><a href="https://medium.com/@timstreet_52329/espresso-ui-testing-in-android-a-unit-testing-approach-b785b2a46411">Espresso UI Testing With Android Architecture Components</a></p><h2 id="tips"><a class="anchor" href="#tips"></a> Tips</h2><ol><li>python å–ä½™<code>%</code>ï¼Œè¿™ä¸€ç‚¹å’Œjavaä¸€æ ·ï¼Œå–æ•´æ•°<code>\\</code>,å’Œjavaæœ‰æ‰€å·®å¼‚ã€‚</li><li>è°·æ­Œæä¾›çš„æ–°çš„å¸ƒå±€<code>ConstraintLayout</code>ï¼Œè™½ç„¶å¯ä»¥å‡å°‘å¸ƒå±€å±‚æ¬¡ï¼Œä½†æ˜¯è¿™ä¸ªæ–°å¸ƒå±€measureè¿‡ç¨‹ç›¸å¯¹ä¼ ç»Ÿå¸ƒå±€æ¥è¯´è¾ƒé•¿ï¼Œå°¤å…¶æ˜¯è¯¥å¸ƒå±€ç”¨åœ¨ListItemçš„è‡ªå®šä¹‰ View æ—¶ï¼Œå¯åŠ¨é€Ÿåº¦ä¼šè¾ƒæ…¢ã€‚</li></ol><h2 id="share"><a class="anchor" href="#share"></a> Share</h2><p>ä¸€ç¯‡çº¦æŸå¸ƒå±€ç›¸å…³çš„æ–‡ç« ï¼š<a href="https://blog.csdn.net/guolin_blog/article/details/53122387">https://blog.csdn.net/guolin_blog/article/details/53122387</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ¬å‘¨ä¸»è¦æ˜¯åšäº†ä¸€é“å…³äºé“¾è¡¨ç›¸å…³æ“ä½œçš„ç®—æ³•é¢˜ç›®ï¼Œæ•°æ®åº“æŸ¥è¯¢çš„é¢˜ç›®ï¼Œé˜…è¯»äº†ä¸€ç¯‡å…³äº UI è‡ªåŠ¨åŒ–æµ‹è¯•ç›¸å…³çš„è‹±æ–‡æ–‡ç« ï¼Œä»”ç»†å­¦ä¹ äº†ä¸‹ ConstraintLayout ç›¸å…³çš„èµ„æ–™ï¼ŒåæœŸè¦ä»”ç»†æ€»ç»“ä¸€ä¸‹ç›¸å…³çš„çŸ¥è¯†ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ARTSæ‰“å¡" scheme="http://www.istarx.cn/categories/ARTS%E6%89%93%E5%8D%A1/"/>
    
    
      <category term="ARTS" scheme="http://www.istarx.cn/tags/ARTS/"/>
    
  </entry>
  
  <entry>
    <title>ARTSæ‰“å¡â€”ç¬¬2å‘¨</title>
    <link href="http://www.istarx.cn/2019/04/14/arts-week-two/"/>
    <id>http://www.istarx.cn/2019/04/14/arts-week-two/</id>
    <published>2019-04-14T10:16:11.000Z</published>
    <updated>2019-04-14T10:52:15.062Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æ¸…æ˜æ”¾å‡å‡ºå»æ—…æ¸¸ï¼Œæ²¡æœ‰æ‰“å¡ï¼Œè¿™æ¬¡æ—¶è¡¥ä¸Šå‘¨çš„æ‰“å¡ã€‚æœ¬å‘¨ä¸»è¦å¯¹Leetcode ç½‘ç«™ä¸Šåšäº†ä¸€é“ç®—æ³•é¢˜åŠä¸€é“æ•°æ®ç»“æ„é¢˜ï¼Œç®—æ³•æ¶‰åŠåˆ°äº†åŠ¨æ€è§„åˆ’ï¼Œæ•°æ®ç»“æ„æ¶‰åŠåˆ°äº†Limitçš„ç”¨æ³•ã€‚</p><a id="more"></a><p><ul class="toc js-fixedContent"><li><a href="#algorithm">Algorithm</a><ul><li><a href="#%E6%8F%8F%E8%BF%B0">æè¿°</a></li><li><a href="#%E5%88%86%E6%9E%90">åˆ†æ</a></li><li><a href="#%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%E6%96%B9%E6%B3%95%E4%BB%A3%E7%A0%81">åŠ¨æ€è§„åˆ’æ–¹æ³•ä»£ç </a><ul><li><a href="#java">Java</a></li><li><a href="#python">Python</a></li></ul></li></ul></li><li><a href="#database">DataBase</a></li><li><a href="#review">Review</a></li><li><a href="#tips">Tips</a></li><li><a href="#share">Share</a></li></ul></p><h2 id="algorithm"><a class="anchor" href="#algorithm"></a> Algorithm</h2><h3 id="æè¿°"><a class="anchor" href="#æè¿°"></a> æè¿°</h3><blockquote><p>Given a string <strong>s</strong>, find the longest palindromic substring in <strong>s</strong>. You may assume that the maximum length of <strong>s</strong> is 1000.</p><p><strong>Example 1:</strong></p><p><strong>Input</strong>: â€œbabadâ€<br><strong>Output</strong>: â€œbabâ€<br><strong>Note</strong>: â€œabaâ€ is also a valid answer.</p><p><strong>Example 2:</strong></p><p><strong>Input</strong>: â€œcbbdâ€<br><strong>Output</strong>: â€œbbâ€</p></blockquote><p>å¤§è‡´æ„æ€å°±æ˜¯ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ±‚å…¶æœ€å¤§çš„å›æ–‡å­—ç¬¦ä¸²ï¼Œæ‰€è°“å›æ–‡å­—ç¬¦ä¸²ï¼Œç®€å•æ¥è®²å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ­£ç€è¯»å’Œå€’ç€è¯»è¯—ä¸€æ ·çš„ï¼Œä¹Ÿå°±æ˜¯ä»¥ä¸­å¿ƒç‚¹å¯¹ç§°çš„ã€‚</p><h3 id="åˆ†æ"><a class="anchor" href="#åˆ†æ"></a> åˆ†æ</h3><p>é¢˜ç›®è§£å†³æ–¹æ³•æœ‰å¥½å‡ ç§ï¼Œæ¯”å¦‚</p><ul><li><p>æš´åŠ›è§£æ³•ï¼šå¾ªç¯å­—ç¬¦ä¸²ä¸­æ¯ä¸ªå­—ç¬¦ï¼Œä»¥è¯¥å­—ç¬¦èµ·ç‚¹åˆ†åˆ«å‘å·¦å³ä¸¤ä¾§å­—ç¬¦è¿›è¡Œæ¯”è¾ƒï¼Œç›´åˆ°é‡åˆ°ä¸¤ä¾§æœ‰ä¸ç›¸åŒçš„å­—ç¬¦ä¸ºæ­¢ã€‚è¿™ç§æ–¹æ³•éœ€è¦æ³¨æ„å¶æ•°å¯¹ç§°å’Œå¥‡æ•°å¯¹ç§°çš„å·®å¼‚åŒ–å¤„ç†ã€‚</p></li><li><p>æœ€é•¿å…¬å…±å­ä¸²ï¼šæŠŠç»™å®šçš„å­—ç¬¦ä¼ åè½¬å¾—åˆ°æ–°çš„å­—ç¬¦ä¼ ï¼Œæ±‚ä¸¤ä¸ªå­—ç¬¦ä¸²æœ€å¤§çš„å…¬å…±å­—ç¬¦ä¸²ï¼Œä½†æ˜¯è¿™ç§æƒ…å†µä¸‹æœ‰äº›è§£æ˜¯é”™è¯¯çš„ã€‚</p></li><li><p>åŠ¨æ€è§„åˆ’ï¼š</p><p>å®šä¹‰</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mtext>Â </mtext><mi>j</mi><mo>)</mo><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi><mo separator="true">,</mo><mtext>Â </mtext><mi mathvariant="normal">ä¸‹</mi><mi mathvariant="normal">æ ‡</mi><mi mathvariant="normal">ä»</mi><mi>i</mi><mi mathvariant="normal">åˆ°</mi><mi>j</mi><mi mathvariant="normal">çš„</mi><mi mathvariant="normal">å­</mi><mi mathvariant="normal">ä¸²</mi><mi mathvariant="normal">æ˜¯</mi><mi mathvariant="normal">å›</mi><mi mathvariant="normal">æ–‡</mi><mi mathvariant="normal">å­</mi><mi mathvariant="normal">ä¸²</mi></mrow><annotation encoding="application/x-tex">P(i,\ j)=true, \ ä¸‹æ ‡ä» i åˆ° j çš„å­ä¸²æ˜¯å›æ–‡å­ä¸²</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mord cjk_fallback">ä¸‹</span><span class="mord cjk_fallback">æ ‡</span><span class="mord cjk_fallback">ä»</span><span class="mord mathdefault">i</span><span class="mord cjk_fallback">åˆ°</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">å­</span><span class="mord cjk_fallback">ä¸²</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord cjk_fallback">å›</span><span class="mord cjk_fallback">æ–‡</span><span class="mord cjk_fallback">å­</span><span class="mord cjk_fallback">ä¸²</span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mtext>Â </mtext><mi>j</mi><mo>)</mo><mo>=</mo><mi>f</mi><mi>a</mi><mi>l</mi><mi>s</mi><mi>e</mi><mo separator="true">,</mo><mtext>Â </mtext><mi mathvariant="normal">å…¶</mi><mi mathvariant="normal">å®ƒ</mi><mi mathvariant="normal">æƒ…</mi><mi mathvariant="normal">å†µ</mi></mrow><annotation encoding="application/x-tex">P(i,\ j)=false,\ å…¶å®ƒæƒ…å†µ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mord cjk_fallback">å…¶</span><span class="mord cjk_fallback">å®ƒ</span><span class="mord cjk_fallback">æƒ…</span><span class="mord cjk_fallback">å†µ</span></span></span></span></span></p><p>å› æ­¤</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo>)</mo><mtext>Â Â </mtext><mi>a</mi><mi>n</mi><mi>d</mi><mtext>Â Â </mtext><mi>S</mi><mtext>Â </mtext><mi>i</mi><mtext>Â </mtext><mo>=</mo><mo>=</mo><mi>S</mi><mtext>Â </mtext><mi>j</mi><mtext>Â </mtext></mrow><annotation encoding="application/x-tex">P(i, j) = P(i + 1, j - 1) \ \ and \ \ S~i~ == S~j~</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace nobreak">Â </span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace nobreak">Â </span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace nobreak">Â </span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace nobreak">Â </span></span></span></span></span></p><p>æ‰€ä»¥é€’æ¨å…¬å¼ä¸ºï¼š</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mtext>Â </mtext><mi>i</mi><mo>)</mo><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">P(i, \ i) = true</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>)</mo><mo>=</mo><mo>(</mo><mi>S</mi><mtext>Â </mtext><mi>i</mi><mtext>Â </mtext><mo>=</mo><mo>=</mo><mi>S</mi><mtext>Â </mtext><mi>i</mi><mo>+</mo><mn>1</mn><mtext>Â </mtext><mo>)</mo></mrow><annotation encoding="application/x-tex">P(i, i + 1) = (S~i~ == S~i+1~)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace nobreak">Â </span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace nobreak">Â </span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace nobreak">Â </span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mspace nobreak">Â </span><span class="mclose">)</span></span></span></span></span></p></li></ul><h3 id="åŠ¨æ€è§„åˆ’æ–¹æ³•ä»£ç "><a class="anchor" href="#åŠ¨æ€è§„åˆ’æ–¹æ³•ä»£ç "></a> åŠ¨æ€è§„åˆ’æ–¹æ³•ä»£ç </h3><h4 id="java"><a class="anchor" href="#java"></a> Java</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function">String <span class="title">longestPalindrome</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (s == <span class="keyword">null</span> || s.length() == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">int</span> len = s.length();</span><br><span class="line">  <span class="keyword">boolean</span>[][] temp = <span class="keyword">new</span> <span class="keyword">boolean</span>[len][len];</span><br><span class="line">  <span class="keyword">int</span> maxLen = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">int</span> start = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; i++) &#123;</span><br><span class="line">    temp[i][i] = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (s.charAt(i) == s.charAt(i + <span class="number">1</span>)) &#123;</span><br><span class="line">      maxLen = <span class="number">2</span>;</span><br><span class="line">      temp[i][i + <span class="number">1</span>] = <span class="keyword">true</span>;</span><br><span class="line">      start = i;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  temp[len - <span class="number">1</span>][len - <span class="number">1</span>] = <span class="keyword">true</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> tmpLen = <span class="number">3</span>; tmpLen &lt;= len; tmpLen++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len - tmpLen + <span class="number">1</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">int</span> j = i + tmpLen - <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> (temp[i + <span class="number">1</span>][j - <span class="number">1</span>] &amp;&amp; s.charAt(i) == s.charAt(j)) &#123;</span><br><span class="line">        maxLen = tmpLen;</span><br><span class="line">        start = i;</span><br><span class="line">        temp[i][j] = <span class="keyword">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> s.substring(start, start + maxLen);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="python"><a class="anchor" href="#python"></a> Python</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">longestPalindrome</span><span class="params">(self, s: str)</span> -&gt; str:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> s <span class="keyword">or</span> len(s) == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">''</span></span><br><span class="line">        res = [[<span class="keyword">False</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s))] <span class="keyword">for</span> j <span class="keyword">in</span> range(len(s))]</span><br><span class="line">        max_len = <span class="number">1</span></span><br><span class="line">        start = <span class="number">0</span></span><br><span class="line">        str_len = len(s)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(str_len - <span class="number">1</span>):</span><br><span class="line">            res[i][i] = <span class="keyword">True</span></span><br><span class="line">            <span class="keyword">if</span> s[i] == s[i + <span class="number">1</span>]:</span><br><span class="line">                res[i][i + <span class="number">1</span>] = <span class="keyword">True</span></span><br><span class="line">                start = i</span><br><span class="line">                max_len = <span class="number">2</span></span><br><span class="line">        res[str_len - <span class="number">1</span>][str_len - <span class="number">1</span>] = <span class="keyword">True</span></span><br><span class="line">        <span class="keyword">for</span> tmp_len <span class="keyword">in</span> range(<span class="number">3</span>, str_len + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(str_len - tmp_len + <span class="number">1</span>):</span><br><span class="line">                j = i + tmp_len - <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> res[i+<span class="number">1</span>][j<span class="number">-1</span>] <span class="keyword">and</span> s[i] == s[j]:</span><br><span class="line">                    max_len = tmp_len;</span><br><span class="line">                    start = i</span><br><span class="line">                    res[i][j]=<span class="keyword">True</span></span><br><span class="line">        <span class="keyword">return</span> s[start: start + max_len]</span><br></pre></td></tr></table></figure><p>è¿è¡Œæ•°æ®å¦‚ä¸‹ï¼š</p><table><thead><tr><th>Language</th><th>Time</th><th>Memory</th></tr></thead><tbody><tr><td>python3</td><td>3768 ms</td><td>21.7 MB</td></tr><tr><td>java</td><td>35 ms</td><td>39.4 MB</td></tr></tbody></table><p>è²Œä¼¼å¯ä»¥ä¼˜åŒ–ï¼Ÿä¸è¿‡è¿™æ ·ç›¸å¯¹æ¯”è¾ƒå¥½ç†è§£å•Š</p><h2 id="database"><a class="anchor" href="#database"></a> DataBase</h2><blockquote><p>Write a SQL query to get the second highest salary from the <code>Employee</code> table.</p></blockquote><blockquote><p>Write a SQL query to get the <em>n</em><sup>th</sup> highest salary from the <code>Employee</code> table.</p></blockquote><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç¬¬äºŒé«˜</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">IFNULL</span>(</span><br><span class="line">        (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> Salary</span><br><span class="line">        <span class="keyword">FROM</span> Employee</span><br><span class="line">        <span class="keyword">ORDER</span> <span class="keyword">BY</span> Salary <span class="keyword">DESC</span></span><br><span class="line">        <span class="keyword">LIMIT</span> <span class="number">1</span>,<span class="number">1</span>),</span><br><span class="line">    <span class="literal">NULL</span>) <span class="keyword">AS</span> SecondHighestSalary</span><br><span class="line"><span class="comment"># ç¬¬Né«˜</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> getNthHighestSalary(N <span class="built_in">INT</span>) <span class="keyword">RETURNS</span> <span class="built_in">INT</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">set</span> N = N - <span class="number">1</span>;</span><br><span class="line">  RETURN (</span><br><span class="line">      <span class="comment"># Write your MySQL query statement below.</span></span><br><span class="line">      <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> Salary</span><br><span class="line">      <span class="keyword">FROM</span> Employee</span><br><span class="line">      <span class="keyword">ORDER</span> <span class="keyword">BY</span> Salary <span class="keyword">DESC</span></span><br><span class="line">      <span class="keyword">LIMIT</span> <span class="number">1</span> <span class="keyword">OFFSET</span> N</span><br><span class="line">  );</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure><h2 id="review"><a class="anchor" href="#review"></a> Review</h2><p><a href="https://medium.com/mindorks/understanding-clean-code-in-android-ebe42ad89a99">Understanding Clean Code in Android</a></p><p>ä¸»è¦è®²äº†Androidä¸­çš„ä»£ç è§„èŒƒï¼š<code>S.O.L.I.D</code>è§„èŒƒ:</p><ul><li>Single Responsibility Principleâ€Šâ€”â€ŠSRPï¼š æ¯ä¸ªç±»å¿…é¡»åªæœ‰å•ä¸€çš„åŠŸèƒ½</li><li>Open-Closed Principleâ€Šâ€”â€ŠOCPï¼šå¯¹ç»§æ‰¿å¼€æ”¾ï¼Œä½†æ˜¯è¦å¯¹ä¿®æ”¹å…³é—­</li><li>Liskov Substitutions Principleâ€Šâ€”â€ŠLSPï¼šå­ç±»å¯ä»¥ç»§æ‰¿å¹¶é‡å†™è‡ªå·±çš„åŠŸèƒ½ï¼Œä½†æ˜¯ä¸èƒ½æ”¹å˜çˆ¶ç±»çš„åŠŸèƒ½</li><li>Interface Segregation Principleâ€Šâ€”â€ŠISPï¼šå®ç°æ¥å£æ—¶ä¸åº”è¯¥å®ç°æ‰€æœ‰æ¥å£æ–¹æ³•ï¼Œåº”åªå®ç°ä½¿ç”¨åˆ°çš„æ–¹æ³•</li><li>Dependency Inversion Principleâ€Šâ€”â€ŠDIPï¼šé«˜çº§æ¨¡å—ä¸åº”ä¾èµ–ä½çº§æ¨¡å—ï¼ŒæŠ½è±¡ä¸åº”ä¾èµ–äºç»†èŠ‚ï¼Œç»†èŠ‚åº”ä¾èµ–æŠ½è±¡</li></ul><h2 id="tips"><a class="anchor" href="#tips"></a> Tips</h2><ul><li><p>ä¿®æ”¹Ubuntuå¤šç³»ç»Ÿçš„é»˜è®¤å¯åŠ¨é¡ºåº</p><ul><li><code>sudo gedit /etc/default/grub</code>ä¿®æ”¹# <code>GRUB_DEFAULT=0</code>ä¸€è¡Œ</li><li><code>sudo update-grub</code></li></ul></li><li><p>pythonä¸­äº¤æ¢ list ä¸­ i, j ä¸¤ä¸ªå…ƒç´ çš„ä½ç½®ï¼š</p><p><code>num[i], num[j] = num[j], num[i]</code></p></li><li><p>git status ä¸æ˜¾ç¤ºæ–‡ä»¶æƒé™ä¿®æ”¹</p><p><code>git config fileMode false</code></p></li></ul><h2 id="share"><a class="anchor" href="#share"></a> Share</h2><p><a href="https://blog.csdn.net/Luoshengyang/article/details/6564592">https://blog.csdn.net/Luoshengyang/article/details/6564592</a></p><p>è€ç½—çš„ Android è¯¾ä¸­çš„ä¸‹è½½ android å†…æ ¸ä»£ç çš„æ–¹æ³•ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ¸…æ˜æ”¾å‡å‡ºå»æ—…æ¸¸ï¼Œæ²¡æœ‰æ‰“å¡ï¼Œè¿™æ¬¡æ—¶è¡¥ä¸Šå‘¨çš„æ‰“å¡ã€‚æœ¬å‘¨ä¸»è¦å¯¹Leetcode ç½‘ç«™ä¸Šåšäº†ä¸€é“ç®—æ³•é¢˜åŠä¸€é“æ•°æ®ç»“æ„é¢˜ï¼Œç®—æ³•æ¶‰åŠåˆ°äº†åŠ¨æ€è§„åˆ’ï¼Œæ•°æ®ç»“æ„æ¶‰åŠåˆ°äº†Limitçš„ç”¨æ³•ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ARTSæ‰“å¡" scheme="http://www.istarx.cn/categories/ARTS%E6%89%93%E5%8D%A1/"/>
    
    
      <category term="ARTS" scheme="http://www.istarx.cn/tags/ARTS/"/>
    
  </entry>
  
  <entry>
    <title>ARTSæ‰“å¡â€”ç¬¬1å‘¨</title>
    <link href="http://www.istarx.cn/2019/03/31/arts-week-one/"/>
    <id>http://www.istarx.cn/2019/03/31/arts-week-one/</id>
    <published>2019-03-31T02:40:11.000Z</published>
    <updated>2019-03-31T07:32:11.936Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æœ¬å‘¨ä¸»è¦æ˜¯åšäº†ä¸€é“LeetCodeçš„ç®—æ³•é¢˜åŠä¸€é“DataBaseçš„é¢˜ï¼Œæ¶‰åŠåˆ°äº†å¿«é€Ÿæ’åºä»¥åŠ SQL è¯­å¥ä¸­çš„<code>LEFT JOIN</code>è¯­å¥ï¼Œé¡ºä¾¿å­¦ä¹ äº†ä¸€ä¸‹å‡ ä¸ªè¡¨åˆå¹¶æ–¹å¼çš„åŒºåˆ«ï¼ŒåæœŸä¼šåšä¸€ä¸ªæ€»ç»“ã€‚</p><a id="more"></a><p><ul class="toc js-fixedContent"><li><a href="#algorithm">Algorithm</a><ul><li><a href="#java">Java</a></li><li><a href="#python">Python</a></li></ul></li><li><a href="#database">Database</a></li><li><a href="#review">Review</a></li><li><a href="#tips">Tips</a></li><li><a href="#share">Share</a></li></ul></p><h2 id="algorithm"><a class="anchor" href="#algorithm"></a> Algorithm</h2><p>æœ¬å‘¨é¢˜ç›®æè¿°å¦‚ä¸‹ï¼š</p><blockquote><p>Given an array <code>A</code> of positive lengths, return the largest perimeter of a triangle with <strong>non-zero area</strong>, formed from 3 of these lengths.</p><p>If it is impossible to form any triangle of non-zero area, return <code>0</code>.</p></blockquote><p>é¢˜ç›®å¾ˆç®€å•ï¼Œç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œæ±‚å‘¨é•¿æœ€å¤§çš„ä¸‰è§’å½¢ï¼Œå¦‚æœæ²¡æœ‰å¯ä»¥ç»„æˆä¸‰è§’å½¢çš„ä¸‰ä¸ªæ•°ï¼Œåˆ™è¿”å›0ã€‚æœ€ç®€å•çš„å½“ç„¶å°±æ˜¯æš´åŠ›ç®—æ³•äº†ï¼Œä¸‰ä¸ª for å¾ªç¯ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯$$O(n^3)$$ã€‚å¦å¤–ä¸€ç§è§£æ³•å°±æ˜¯åˆ©ç”¨æ’åºï¼Œä»å¤§åˆ°å°ä¾æ¬¡å¯»æ‰¾æ»¡è¶³ä¸‰è§’å½¢æ¡ä»¶çš„æ•´æ•°ï¼Œè®¡ç®—å…¶å‘¨é•¿ï¼Œå¦‚ä¸å­˜åœ¨åˆ™è¿”å›é›¶ã€‚Java æœ¬èº«çš„<code>Arrays</code>ç±»ä¸­å¸¦äº†æ’åºçš„æ–¹æ³•ï¼Œä½†æ˜¯æ²¡ç”¨ï¼Œæƒ³ç€å¤ä¹ ç€å†™å†™å¿«æ’ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><h3 id="java"><a class="anchor" href="#java"></a> Java</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NO976_LargestPerimeterTriangle</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] A = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>&#125;;</span><br><span class="line">        System.out.println(largestPerimeter(A));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">largestPerimeter</span><span class="params">(<span class="keyword">int</span>[] A)</span> </span>&#123;</span><br><span class="line">        quickSort(A, <span class="number">0</span>, A.length - <span class="number">1</span>); <span class="comment">// increase</span></span><br><span class="line">        <span class="keyword">int</span> numCount = A.length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> index = numCount - <span class="number">3</span>; index &gt;= <span class="number">0</span>; index--) &#123;</span><br><span class="line">            <span class="keyword">if</span> (A[index] + A[index + <span class="number">1</span>] &gt; A[index + <span class="number">2</span>]) &#123;</span><br><span class="line">                <span class="keyword">return</span> A[index] + A[index + <span class="number">1</span>] + A[index + <span class="number">2</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">quickSort</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (start &gt;= end) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> pivot = partition(nums, start, end);</span><br><span class="line">        quickSort(nums, start, pivot - <span class="number">1</span>);</span><br><span class="line">        quickSort(nums, pivot + <span class="number">1</span>, end);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">partition</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> pivot = nums[end];</span><br><span class="line">        <span class="keyword">int</span> i = start;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = start; j &lt; end; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[j] &lt; pivot) &#123;</span><br><span class="line">                swap(nums, i, j);</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        swap(nums, i, end);</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> tmp = nums[j];</span><br><span class="line">        nums[j] = nums[i];</span><br><span class="line">        nums[i] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="python"><a class="anchor" href="#python"></a> Python</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">largestPerimeter</span><span class="params">(self, A: list)</span> -&gt; int:</span></span><br><span class="line">        self.quick_sort(A, <span class="number">0</span>, len(A) - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(A) - <span class="number">3</span>, <span class="number">-1</span>, <span class="number">-1</span>): <span class="comment"># -1 </span></span><br><span class="line">            <span class="keyword">if</span> A[i] + A[i + <span class="number">1</span>] &gt; A[i + <span class="number">2</span>]:</span><br><span class="line">                <span class="keyword">return</span> A[i] + A[i + <span class="number">1</span>] + A[i + <span class="number">2</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">quick_sort</span><span class="params">(self, A: list, start: int, end: int)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="keyword">if</span> start &gt;= end:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        pivot = self.partition(A, start, end)</span><br><span class="line">        self.quick_sort(A, start, pivot - <span class="number">1</span>)</span><br><span class="line">        self.quick_sort(A, pivot + <span class="number">1</span>, end)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">partition</span><span class="params">(A: list, start: int, end: int)</span> -&gt; int:</span></span><br><span class="line">        pivot = A[end]</span><br><span class="line">        i = start</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(start, end, <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> A[j] &lt; pivot:</span><br><span class="line">                A[i], A[j] = A[j], A[i]</span><br><span class="line">                i = i + <span class="number">1</span></span><br><span class="line">        A[i], A[end] = A[end], A[i]</span><br><span class="line">        <span class="keyword">return</span> i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    print(str(Solution().largestPerimeter([<span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>])))</span><br></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦ä¸º $$O(n)$$ .</p><table><thead><tr><th>è¯­è¨€</th><th>Runtime</th><th>Memory</th></tr></thead><tbody><tr><td>Java</td><td>9ms</td><td>41.8M</td></tr><tr><td>Python</td><td>352ms</td><td>14M</td></tr></tbody></table><h2 id="database"><a class="anchor" href="#database"></a> Database</h2><blockquote><p>Table: <code>Person(PersonId, FirstName, LastName)</code> and Table: <code>Address(AddressId, PersonId, City, State)</code>. Write a SQL query for a report that provides the following information for each person in the Person table, regardless if there is an address for each of those people:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> FirstName, LastName, City, State</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"></span></span><br></pre></td></tr></table></figure></blockquote><p>SQLè¯­å¥å¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    FirstName, LastName, City, State</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    Person</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span></span><br><span class="line">    Address</span><br><span class="line"><span class="keyword">ON</span></span><br><span class="line">    Person.personId = Address.PersonId</span><br></pre></td></tr></table></figure><h2 id="review"><a class="anchor" href="#review"></a> Review</h2><p>è¿™å‘¨å¼€å§‹å­¦ä¹ äº†ä¸€ä¸‹ä¼˜ç¾çš„<code>RxJava</code>åŠ<code>RxAndroid</code>ï¼Œä¸»è¦çœ‹githubçš„é¡¹ç›®wikiï¼Œè®¡åˆ’ä¸¤å‘¨æ—¶é—´å†…é˜…è¯»å®Œè¯¥wikiï¼š</p><p><a href="https://github.com/ReactiveX/RxJava/wiki">https://github.com/ReactiveX/RxJava/wiki</a></p><h2 id="tips"><a class="anchor" href="#tips"></a> Tips</h2><ul><li><p>ä¿®æ”¹Ubuntuå¤šç³»ç»Ÿçš„é»˜è®¤å¯åŠ¨é¡ºåº</p><p><img src="stat-item.png" alt="stat-item"></p><p>å®‰è£…Ubuntuå’ŒWindowsåŒç³»ç»Ÿä¹‹åï¼Œå¼€æœºé»˜è®¤ä¼šè¿›ubuntuç³»ç»Ÿï¼Œåˆ‡æ¢é»˜è®¤å¯åŠ¨é¡¹çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p><ol><li>åœ¨ termianl ä¸­æ‰§è¡Œä¸€ä¸‹ä»£ç ï¼š</li></ol><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo gedit /etc/default/grub</span><br></pre></td></tr></table></figure><ol start="2"><li>è¾“å…¥å¯†ç åä¼šæ‰“å¼€ä¸€ä¸ªé—®é¢˜ï¼Œç¼–è¾‘å…¶ä¸­<code>GRUB_DEFAULT=0</code>ä¸€è¡Œï¼Œå°†<code>0</code>ä¿®æ”¹ä¸º<code>4</code>ï¼Œå¹¶ä¿å­˜</li></ol><div class="alert info"><p><code>4</code>ä¸ºä¸Šå›¾å¯åŠ¨é¡¹æ‰€åœ¨çš„åºå·ï¼Œä»<code>0</code>å¼€å§‹è®¡æ•°</p></div><div class="alert info"><p>å¯ä»¥ä¿®æ”¹<code>GRUB_TIMEOUT</code>é¡¹ï¼Œè¡¨ç¤ºåœ¨é€‰æ‹©ç•Œé¢ç­‰å¾…æ—¶é—´ã€‚</p></div><ol start="3"><li>åœ¨ terminal ä¸­æ‰§è¡Œä»¥ä¸‹ä»£ç æ›´æ–°grub</li></ol><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo update-grub</span><br></pre></td></tr></table></figure><p>è¿™ä¸€æ­¥å¾ˆé‡è¦ï¼Œå¦åˆ™ä¸ä¼šç”Ÿæ•ˆã€‚</p></li><li><p>pythonä¸­äº¤æ¢ list ä¸­ i, j ä¸¤ä¸ªå…ƒç´ çš„ä½ç½®ï¼š</p></li></ul>  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">num[i], num[j] = num[j], num[i]</span><br></pre></td></tr></table></figure><h2 id="share"><a class="anchor" href="#share"></a> Share</h2><p>åˆ†äº«ä¸€ç¯‡å¾ˆèµçš„æ–‡ç« ï¼Œå…³äºRxJavaçš„ç»™ <a href="http://gank.io/post/560e15be2dca930e00da1083">Android å¼€å‘è€…çš„ RxJava è¯¦è§£</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ¬å‘¨ä¸»è¦æ˜¯åšäº†ä¸€é“LeetCodeçš„ç®—æ³•é¢˜åŠä¸€é“DataBaseçš„é¢˜ï¼Œæ¶‰åŠåˆ°äº†å¿«é€Ÿæ’åºä»¥åŠ SQL è¯­å¥ä¸­çš„&lt;code&gt;LEFT JOIN&lt;/code&gt;è¯­å¥ï¼Œé¡ºä¾¿å­¦ä¹ äº†ä¸€ä¸‹å‡ ä¸ªè¡¨åˆå¹¶æ–¹å¼çš„åŒºåˆ«ï¼ŒåæœŸä¼šåšä¸€ä¸ªæ€»ç»“ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ARTSæ‰“å¡" scheme="http://www.istarx.cn/categories/ARTS%E6%89%93%E5%8D%A1/"/>
    
    
      <category term="ARTS" scheme="http://www.istarx.cn/tags/ARTS/"/>
    
  </entry>
  
  <entry>
    <title>ARTSæ‰“å¡â€”ç¬¬0å‘¨</title>
    <link href="http://www.istarx.cn/2019/03/22/arts-week-zero/"/>
    <id>http://www.istarx.cn/2019/03/22/arts-week-zero/</id>
    <published>2019-03-22T15:03:23.000Z</published>
    <updated>2019-03-24T12:56:43.692Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æœ€è¿‘å‚åŠ äº†è€—å­å”çš„ARTS100å¤©æ‰“å¡æ´»åŠ¨ï¼Œæ¯å‘¨ä¸€æ¬¡ã€‚æœ¬å‘¨æ‰“å¡ä¸ºç¬¬ä¸€å‘¨ã€‚å¸Œæœ›èƒ½å¤Ÿå€ŸåŠ©ARTSæ‰“å¡æ´»åŠ¨å…»æˆè‰¯å¥½çš„ä¹ æƒ¯ï¼Œèƒ½å¤Ÿåœ¨æŠ€æœ¯å’Œæ¯…åŠ›ç­‰å¤šæ–¹é¢æœ‰è¿›æ­¥ï¼Œå¹¶ä¸”èƒ½å…‹æœæ‹–å»¶ç—‡ã€‚</p><a id="more"></a><p><ul class="toc js-fixedContent"><li><a href="#%E4%BB%80%E4%B9%88%E6%98%AFarts">ä»€ä¹ˆæ˜¯ARTS</a></li><li><a href="#algorithm">Algorithm</a><ul><li><a href="#%E6%8F%8F%E8%BF%B0">æè¿°</a></li><li><a href="#%E8%A7%A3%E6%B3%95">è§£æ³•</a><ul><li><a href="#java%E7%89%88">Javaç‰ˆ</a></li><li><a href="#python%E7%89%88">Pythonç‰ˆ</a></li></ul></li></ul></li><li><a href="#database">Database</a></li><li><a href="#review">Review</a></li><li><a href="#tip">Tip</a></li><li><a href="#share">Share</a></li></ul></p><h2 id="ä»€ä¹ˆæ˜¯arts"><a class="anchor" href="#ä»€ä¹ˆæ˜¯arts"></a> ä»€ä¹ˆæ˜¯ARTS</h2><p>ARTSæ˜¯è€—å­å‘èµ·çš„ä¸€é¡¹æ‰“å¡æ´»åŠ¨ï¼Œæ¯å‘¨è¦å®Œæˆä¸€ä¸ªARTSæ‰“å¡ä¸€æ¬¡ã€‚</p><p>ä»¥ARTSåˆ†åˆ«è¡¨ç¤ºä¸º</p><ul><li>A-<strong>Algorithm</strong>ï¼šæ¯å‘¨è‡³å°‘åš<a href="https://leetcode.com/problemset/all/">LeetCode</a>ä¸€é“ç®—æ³•é¢˜ï¼›</li><li>R-<strong>Review</strong>ï¼šæ¯å‘¨è‡³å°‘é˜…è¯»ä¸€ç¯‡è‹±æ–‡æ–‡ç« ï¼Œå­¦ä¹ è‹±æ–‡çš„åŒæ—¶å­¦ä¹ æŠ€æœ¯ï¼›</li><li>T-<strong>Tip</strong>ï¼šæ¯å‘¨è‡³å°‘å­¦ä¹ ä¸€ä¸ªå°æŠ€å·§ï¼›</li><li>S-<strong>Share</strong>ï¼šæ¯å‘¨åˆ†äº«ä¸€ç¯‡æœ‰è§‚ç‚¹å’Œæ€è€ƒçš„æŠ€æœ¯æ–‡ç« ï¼›</li></ul><p>é™¤äº†ä»¥ä¸Šçš„å†…å®¹å¤–ï¼Œè‡ªå·±ç»™è‡ªå·±åŠ äº†ç‚¹æ–™ï¼šåœ¨Algorithmä¸­åˆ†åˆ«ç”¨Javaå’ŒPythonå®ç°ï¼Œå¹¶ç ”ç©¶å…¶ç”¨åˆ°çš„çŸ¥è¯†ç‚¹åŠç®—æ³•çŸ¥è¯†ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šæ¯å‘¨åšä¸€é“æ•°æ®åº“çš„é¢˜ï¼›æ¯ä¸¤å‘¨éœ€è¦è‡³å°‘ä¸€ç¯‡çš„æ€»ç»“åšå®¢è¾“å‡ºã€‚</p><h2 id="algorithm"><a class="anchor" href="#algorithm"></a> Algorithm</h2><h3 id="æè¿°"><a class="anchor" href="#æè¿°"></a> æè¿°</h3><p>Given an array of integers, return <strong>indices</strong> of the two numbers such that they add up to a specific target.</p><p>You may assume that each input would have <strong>exactly</strong> one solution, and you may not use the <em>same</em> element twice.</p><p><strong>Example</strong></p><p>è¾“å…¥ï¼šnums = [2, 7, 11, 15], target = 9</p><p>è¾“å‡ºï¼š[0,1]ï¼Œå› ä¸ºnums[0] + nums[1] == target</p><h3 id="è§£æ³•"><a class="anchor" href="#è§£æ³•"></a> è§£æ³•</h3><p>è¿™ä¸ªæ˜¯æ¯”è¾ƒç®€å•çš„é¢˜ç›®äº†ï¼Œä¸è€ƒè™‘æ—¶é—´çš„æƒ…å†µä¸‹å¯ä»¥è€ƒè™‘æš´åŠ›è§£æ³•ï¼Œå¦‚æœè€ƒè™‘æ—¶é—´çš„è¯åˆ™éœ€è¦ä¼˜åŒ–ç®—æ³•ã€‚</p><ul><li>æš´åŠ›è§£æ³•ï¼šå¯¹æ•°ç»„åšåŒå±‚forå¾ªç¯ï¼ŒæŒ‰ä¸ªå¯»æ‰¾æ»¡è¶³æ¡ä»¶çš„è§£ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n<sup>2</sup>)ï¼Œæ•°æ®é‡è¿‡å¤§æ—¶åˆ™ä¼šæ—¶é—´è¶…è¶Šä¸Šé™ï¼›</li><li>åˆ©ç”¨Mapæˆ–è€…dictå‡å°‘æ—¶é—´å¤æ‚åº¦ï¼Œä¿å­˜å½“å‰target-å½“å‰å…ƒç´ ä»¥åŠå½“å‰ç´¢å¼•å€¼ï¼›</li></ul><h4 id="javaç‰ˆ"><a class="anchor" href="#javaç‰ˆ"></a> Javaç‰ˆ</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] twoSum(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line">        Map&lt;Integer,Integer&gt; tmp = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line"><span class="keyword">if</span> (tmp.containsKey(nums[i])) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[] &#123;tmp.get(nums[i]), i&#125;;</span><br><span class="line">&#125;</span><br><span class="line">            tmp.put(target - nums[i], i);</span><br><span class="line">            </span><br><span class="line">&#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="pythonç‰ˆ"><a class="anchor" href="#pythonç‰ˆ"></a> Pythonç‰ˆ</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">twoSum</span><span class="params">(self, nums: List[int], target: int)</span> -&gt; List[int]:</span></span><br><span class="line">        tmp_dic = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)):</span><br><span class="line">            <span class="keyword">if</span> nums[i] <span class="keyword">in</span> tmp_dic:</span><br><span class="line">                <span class="keyword">return</span> [tmp_dic.get(nums[i]), i]</span><br><span class="line">            tmp_dic[target - nums[i]] = i</span><br></pre></td></tr></table></figure><table><thead><tr><th>è¯­è¨€</th><th>Runtime</th><th>Memory</th></tr></thead><tbody><tr><td>Java</td><td>4ms</td><td>39.8M</td></tr><tr><td>Python</td><td>40ms</td><td>14.6M</td></tr></tbody></table><h2 id="database"><a class="anchor" href="#database"></a> Database</h2><p>éšæœºåˆ°äº†ä¸€é“å¾ˆç®€å•çš„é¢˜ç›®ï¼Œåªæ¶‰åŠåˆ°äº†<code>OR</code>å…³é”®å­—ã€‚é¢˜ç›®æè¿°å¦‚ä¸‹ï¼š</p><p>æŸ¥è¯¢Wordè¡¨ä¸­æ»¡è¶³area &gt; 3000000 æˆ–è€… population &gt; 25000000 çš„åŸå¸‚çš„nameï¼ŒpopulationåŠareaã€‚</p><p>æŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    <span class="keyword">name</span>, population,area </span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">    World </span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">    area &gt; <span class="number">3000000</span> <span class="keyword">OR</span> population &gt; <span class="number">25000000</span></span><br></pre></td></tr></table></figure><p>é¢˜ç›®å¾ˆç®€å•ï¼Œçœ‹äº†ä¸€ä¸‹LeetCodeä¸Šçš„æ ‡å‡†è§£ç­”ï¼Œæœ‰ä¸€ç§è§£æ³•æ˜¯åˆ©ç”¨è¡¨åˆå¹¶ï¼Œå³æŸ¥è¯¢åˆ†åˆ«æ»¡è¶³ä¸€ä¸ªæ¡ä»¶çš„è¡¨ï¼Œå¹¶æŠŠç»“æœè¿›è¡Œåˆå¹¶ï¼Œæ¶‰åŠåˆ°çš„å…³é”®å­—æ˜¯<code>UNION</code>ï¼ŒæŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">name</span>, population, area</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    World</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    area &gt; <span class="number">3000000</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">name</span>, population, area</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    World</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    population &gt; <span class="number">25000000</span></span><br></pre></td></tr></table></figure><h2 id="review"><a class="anchor" href="#review"></a> Review</h2><p>æœ¬å‘¨é˜…è¯»çš„è‹±æ–‡æ–‡ç« æ˜¯æ¥è‡ªMediumçš„ä¸€ç¯‡æ–‡ç« <a href="https://android.jlelse.eu/android-shape-drawables-tutorial-17fbece6fef5/">Shape Drawables</a>ï¼ŒShape Drawableså¯ä»¥æ›¿æ¢pngå›¾ç‰‡ä»¥å‡å°‘åŠ è½½åŠç»˜åˆ¶æ—¶é—´ï¼Œè¿˜å¯ä»¥å‡å°apkæœ¬èº«çš„å¤§å°ã€‚</p><p>Androidçš„å¼€æ”¾æ€§å†³å®šäº†åº”ç”¨éœ€è¦é€‚é…ä¸åŒå¤§å°å±å¹•ï¼Œåœ¨ä½¿ç”¨<code>jpg</code>æˆ–è€…<code>png</code>å›¾ç‰‡åšå±å¹•é€‚é…æ—¶ï¼Œéœ€è¦è®¾è®¡å¸ˆåšé’ˆå¯¹ä¸åŒå±å¹•åˆ†è¾¨ç‡çš„å›¾ç‰‡ï¼Œå¹¶æ‹·è´åˆ°å¯¹åº”çš„èµ„æºæ–‡ä»¶ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´åŒä¸€å¼ ä¸åŒå¤§å°çš„å›¾ç‰‡éœ€è¦ä¿å­˜å¾ˆå¤šä»½ã€‚ä¸ºäº†é¿å…ä¸Šè¿°æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨<code>xml</code>ä»£æ›¿jpgå’Œpngå›¾ç‰‡ã€‚</p><p>ShapeDrawableæ˜¯Drawableçš„å­ç±»ï¼Œå¯ä»¥é€šè¿‡åœ¨drawableæ–‡ä»¶å¤¹ä¸­æ–°å»ºæ ¹æ ‡ç­¾ä¸º<code>shape</code>çš„xmlæ–‡ä»¶ï¼Œå¹¶åœ¨layoutæ–‡ä»¶ä¸­å¼•ç”¨å¾—åˆ°ï¼Œxmlæ–‡ä»¶å¤§è‡´å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">shape</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:shape</span>=<span class="string">"line"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">corners</span> <span class="attr">android:radius</span>=<span class="string">"8dp"</span> /&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--æ¸å˜è‰²--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">gradient</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">padding</span> <span class="attr">android:bottom</span>=<span class="string">"2dp"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">solid</span> <span class="attr">android:color</span>=<span class="string">"@color/colorPrimaryDark"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">size</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:height</span>=<span class="string">"16dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:width</span>=<span class="string">"16dp"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">stroke</span> <span class="attr">android:width</span>=<span class="string">"2dp"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">shape</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>android:shapeå¯é€‰é¡¹æœ‰<code>line</code>ã€<code>rectangle</code>ã€<code>oval</code>ã€<code>ring</code>ç­‰ï¼›</li><li>strokeå¯ä»¥ç†è§£æˆç”»ç¬”ï¼›</li></ul><div class="alert info"><p>xmlæ–‡ä»¶å»ºç«‹è™šçº¿ShapeDrawableæ—¶ï¼Œéœ€è¦ç”¨åˆ°stroke itemä¸‹çš„<code>dashWidth</code>åŠ<code>dashGap</code>åˆ†åˆ«è¡¨ç¤ºå®çº¿å®½åº¦åŠç©ºéš™å®½åº¦ã€‚è¿˜éœ€è¦æ³¨æ„çš„æ˜¯sizeçš„å®½åº¦å¿…é¡»è¦å¤§äºstrokeçš„å®½åº¦ï¼Œå¦åˆ™æ— æ³•æ˜¾ç¤ºè™šçº¿ï¼›</p></div><h2 id="tip"><a class="anchor" href="#tip"></a> Tip</h2><ol><li><p>åˆ†äº«ä¸€ä¸ªgitç›¸å…³çš„å°æŠ€å·§çš„ï¼Œä»åŒäº‹é‚£å­¦ä¹ çš„ï¼Œç¡®å®åœ¨ä»£ç åˆå…¥çš„æ—¶å€™å¸®åŠ©å¾ˆå¤§ï¼›</p><p>å‡å¦‚æœ¬åœ°æœ‰ä¸‰ä¸ªæœªpushåˆ°è¿œç¨‹çš„èŠ‚ç‚¹Aã€Bã€Cï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p><p><img src="commit-state.gif" alt="commit-state"></p><p>git logè®°å½•å¦‚ä¸‹ï¼š</p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">commit af75163b2dd46891ccef6989a9c661e001d372f5 (HEAD -&gt; master)</span><br><span class="line">Author: Cherlas &lt;vm@li.cm&gt;</span><br><span class="line">Date:   Sun Mar 24 10:53:18 2019 +0800</span><br><span class="line"></span><br><span class="line">    commitA</span><br><span class="line"></span><br><span class="line">commit ab2b7b369d5e6f79626850c602a05b5101c4fd49</span><br><span class="line">Author: Cherlas &lt;vm@li.cm&gt;</span><br><span class="line">Date:   Sun Mar 24 10:52:48 2019 +0800</span><br><span class="line"></span><br><span class="line">    commitB</span><br><span class="line"></span><br><span class="line">commit 1b0a9a519a83f9771ef57a60084e7a58e365468c</span><br><span class="line">Author: Cherlas &lt;vm@li.cm&gt;</span><br><span class="line">Date:   Sun Mar 24 10:52:11 2019 +0800</span><br><span class="line"></span><br><span class="line">    commitC</span><br></pre></td></tr></table></figure><p>å¦‚æœä»…ä»…è¦ä¿®æ”¹BèŠ‚ç‚¹è€Œä¸å½±å“Aå’ŒCï¼Œåˆ™æ“ä½œå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git rebase -i 1b0a9a519a83f9771ef57a60084e7a58e365468c</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°å‘½ä»¤ä¸­çš„èŠ‚ç‚¹å·ä¸ºè¦ä¿®æ”¹çš„èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹å³CèŠ‚ç‚¹çš„ç¼–å·ï¼Œä¸Šè¿°å‘½ä»¤æ‰§è¡Œåä¼šæœ‰vimç¼–è¾‘æç¤ºå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pick ab2b7b3 commitB</span><br><span class="line">pick af75163 commitA</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Rebase 1b0a9a5..af75163 onto 1b0a9a5 (2 commands)</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­æ¯”è¾ƒé‡è¦çš„æ˜¯<code>pick</code>å…³é”®è¯ï¼Œå¯ä»¥ä¿®æ”¹æ­¤å…³é”®è¯è¾¾åˆ°ä¿®æ”¹ã€åˆ é™¤åŠåˆå¹¶ç­‰æ“ä½œï¼š</p><table><thead><tr><th>å…³é”®è¯</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>pick</td><td>ä¿æŒå½“å‰èŠ‚ç‚¹æ‰€æœ‰å†…å®¹ä¸å˜</td></tr><tr><td>reword</td><td>ä»…ä¿®æ”¹è¯¥èŠ‚ç‚¹çš„commit message</td></tr><tr><td>edit</td><td>å¯ä»¥ä¿®æ”¹æäº¤å†…å®¹åŠcommit message</td></tr><tr><td>squash</td><td>å½“å‰èŠ‚ç‚¹å’Œä¸Šä¸€èŠ‚ç‚¹åˆå¹¶</td></tr><tr><td>break</td><td>rebaseåˆ°å½“å‰èŠ‚ç‚¹æ—¶åœç•™ï¼Œä¹‹åéœ€è¦æ‰‹åŠ¨rebase --continue</td></tr><tr><td>drop</td><td>åˆ é™¤å½“å‰èŠ‚ç‚¹ï¼Œå¦‚æœvimç¼–è¾‘æ¡†ä¸­çš„æŸä¸€èŠ‚ç‚¹æ‰€åœ¨çš„è¡Œåˆ é™¤ä¹Ÿå¯ä»¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœ</td></tr></tbody></table><p>æŠŠvimç¼–è¾‘å†…å®¹ä¸­commitBå¯¹åº”çš„<code>pick</code>ä¿®æ”¹ä¸º<code>edit</code>ä¿å­˜å¹¶æ¨å‡ºï¼Œgitä¼šrebaseåˆ°commitBèŠ‚ç‚¹å¹¶åœç•™ï¼Œæç¤ºå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Stopped at ab2b7b3...  commitB</span><br><span class="line">You can amend the commit now, with</span><br><span class="line"></span><br><span class="line">  git commit --amend </span><br><span class="line">Once you are satisfied with your changes, run</span><br><span class="line"></span><br><span class="line">  git rebase --continue</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å°±å¯ä»¥ç›´æ¥ä¿®æ”¹BèŠ‚ç‚¹çš„å†…å®¹ï¼Œå¹¶åœ¨ä¿®æ”¹ä¹‹åè¿›è¡Œcommit æ‰“patchå¹¶è¿›è¡Œrebaseå³å¯ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">touch commitB_edit</span><br><span class="line">git add commitB_edit</span><br><span class="line">git commit --amend</span><br><span class="line">git rebase --continue</span><br></pre></td></tr></table></figure><h2 id="share"><a class="anchor" href="#share"></a> Share</h2><p>æœ¬å‘¨åˆ†äº«çš„æ–‡ç« çš„æ–‡ç« æ—¶æ¥è‡ªMediunä¸­AndroidPubæ¿å—ä¸­çš„å…³äºMVMåŠMVVMçš„ä¸€ç¯‡æ–‡ç« ï¼š</p><p><a href="https://android.jlelse.eu/why-to-choose-mvvm-over-mvp-android-architecture-33c0f2de5516">Why to choose MVVM over MVPâ€Šâ€”â€ŠAndroid Architecture</a></p><p>ä¸»è¦è®²äº†Architectureçš„å®šä¹‰ï¼šç®€å•å®šä¹‰ä¸ºåšå†³ä»£ç ç¼–å†™è¿‡ç¨‹ä¸­ä»£ç è€¦åˆæ€§è¾ƒå¼ºç­‰é—®é¢˜çš„ä¸€ç§æ–¹æ³•æˆ–æ¨¡å¼ã€‚</p><p>æ–‡ç« ä¸­è®²åˆ°äº†MVPçš„ç¼ºç‚¹:Presenterå’ŒViewä¹‹é—´äº’æœ‰å¯¹æ–¹çš„å¼•ç”¨(è¯„è®ºä¸­ä¹Ÿæœ‰äººåé©³è¿™ä¸€ç‚¹)ï¼Œç»™æµ‹è¯•åŠä»£ç åˆ†ç¦»ç­‰å¸¦æ¥å›°éš¾ã€‚è€ŒMVVMæ¨¡å¼ä¸­çš„ViewModuleåˆ™åªå¯¹å¤–æš´éœ²æ•°æ®è€Œä¸çŸ¥é“æ•°æ®å…·ä½“æ˜¯è°ç”¨ï¼Œå•ä¸ªçš„View(Activity)ä¹Ÿå¯ä»¥æœ‰å¤šä¸ªViewModuleçš„å®ä¾‹ï¼Œåœ¨å¯æµ‹è¯•æ€§åŠä»£ç è€¦åˆæ€§æ–¹é¢è¦ä¼˜äºPresenterã€‚</p><p>æ‰“å¡å®Œæ¯•ï¼Œæ„Ÿè§‰ç›¸å½“çš„å¯ä»¥ï¼Œåé¢ä¹Ÿä¼šç»™è‡ªå·±é€‚å½“çš„å†åŠ ä¸€äº›å†…å®¹ï¼ŒFightingâ€¦</p></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘å‚åŠ äº†è€—å­å”çš„ARTS100å¤©æ‰“å¡æ´»åŠ¨ï¼Œæ¯å‘¨ä¸€æ¬¡ã€‚æœ¬å‘¨æ‰“å¡ä¸ºç¬¬ä¸€å‘¨ã€‚å¸Œæœ›èƒ½å¤Ÿå€ŸåŠ©ARTSæ‰“å¡æ´»åŠ¨å…»æˆè‰¯å¥½çš„ä¹ æƒ¯ï¼Œèƒ½å¤Ÿåœ¨æŠ€æœ¯å’Œæ¯…åŠ›ç­‰å¤šæ–¹é¢æœ‰è¿›æ­¥ï¼Œå¹¶ä¸”èƒ½å…‹æœæ‹–å»¶ç—‡ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ARTSæ‰“å¡" scheme="http://www.istarx.cn/categories/ARTS%E6%89%93%E5%8D%A1/"/>
    
    
      <category term="ARTS" scheme="http://www.istarx.cn/tags/ARTS/"/>
    
  </entry>
  
  <entry>
    <title>SQL ä¸­çš„ UNIQUE å…³é”®å­—</title>
    <link href="http://www.istarx.cn/2018/12/17/unique-keyword-of-mysql/"/>
    <id>http://www.istarx.cn/2018/12/17/unique-keyword-of-mysql/</id>
    <published>2018-12-17T08:19:45.000Z</published>
    <updated>2019-02-18T17:02:24.232Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æœ¬æ–‡ä¸»è¦å¯¹å·¥ä½œä¸­ç”±<code>UNIQUE</code>å”¯ä¸€æ€§çº¦æŸæ›´æ”¹å¯¼è‡´æ•°æ®åº“å‡çº§æ‹·è´æ•°æ®çš„æ—¶å€™å¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Œå¼•å‘VPNæ”¹å˜çš„é—®é¢˜åšä¸€ä¸ªç®€å•çš„ç¬”è®°ï¼Œé¡ºä¾¿æ¢³ç†ä¸€ä¸‹UNIQUEå…³é”®å­—ç›¸å…³çš„çŸ¥è¯†ã€‚</p><a id="more"></a><p><ul class="toc js-fixedContent"><li><a href="#%E8%B5%B7%E5%9B%A0">èµ·å› </a></li><li><a href="#%E8%A7%A3%E5%86%B3%E8%BF%87%E7%A8%8B">è§£å†³è¿‡ç¨‹</a></li><li><a href="#%E6%B6%89%E5%8F%8A%E5%88%B0%E7%9A%84%E7%9F%A5%E8%AF%86">æ¶‰åŠåˆ°çš„çŸ¥è¯†</a><ul><li><a href="#%E5%BC%80%E5%90%AFsql-log">å¼€å¯SQL log</a><ul><li><a href="#%E6%AD%A3%E5%B8%B8%E5%BC%80%E5%90%AFsql-log%E7%9A%84%E6%96%B9%E6%B3%95">æ­£å¸¸å¼€å¯SQL logçš„æ–¹æ³•</a></li><li><a href="#%E9%80%9A%E8%BF%87%E4%BF%AE%E6%94%B9prop%E6%96%87%E4%BB%B6%E8%BF%9B%E8%A1%8C%E5%BC%80%E5%90%AFlog">é€šè¿‡ä¿®æ”¹propæ–‡ä»¶è¿›è¡Œå¼€å¯log</a></li><li><a href="#example">Example</a></li></ul></li></ul></li></ul></p><h2 id="èµ·å› "><a class="anchor" href="#èµ·å› "></a> èµ·å› </h2><p>å‰å‡ å¤©æ”¶åˆ°äº†ç”¨æˆ·æçš„ä¸€ä¸ªæ•…éšœï¼Œæ•…éšœæè¿°æ˜¯è¿™æ ·çš„ï¼šä»Android Oç‰ˆæœ¬é€šè¿‡fotaå‡çº§åˆ°Pç‰ˆæœ¬çš„æ—¶å€™ï¼Œä¼šå¯¼è‡´å‡çº§ä¹‹åçš„VPNå‘ç”Ÿæ”¹å˜ï¼Œç”±cmnetæ›´æ”¹ä¸ºcmwapã€‚åœ¨ç”¨æˆ·æ‰‹æœºä¸Šçš„è¡¨ç°ä¸ºå‡çº§ä¹‹åç½‘ç»œå¼‚å¸¸å¡é¡¿ï¼Œå¾®ä¿¡æ¶ˆæ¯æ¥å—ç¼“æ…¢ï¼Œå°¤å…¶èŠå¤©å›¾ç‰‡ç”šè‡³å‘ç”Ÿå‘é€ä¸å‡ºå»æˆ–è€…æ¥æ”¶ä¸åˆ°çš„æƒ…å†µã€‚</p><h2 id="è§£å†³è¿‡ç¨‹"><a class="anchor" href="#è§£å†³è¿‡ç¨‹"></a> è§£å†³è¿‡ç¨‹</h2><p>åœ¨ Android ä¸­ä¸ VPNç›¸å…³çš„æ¨¡å—ä¸º TelephonyProviderï¼Œè€Œåœ¨è®¾ç½®é‡Œé¢åŠ è½½é»˜è®¤APNçš„æ—¶å€™ä¹Ÿæ˜¯é€šè¿‡uriå» TelephonyProvider ä¸­è¿›è¡ŒæŸ¥è¯¢ã€‚æ‰€æœ‰è¿è¥å•†çš„ APN ç›¸å…³çš„é…ç½®æ˜¯é€šè¿‡éœ€æ±‚ä»è¿è¥å•†æ‹¿åˆ°æ•°æ®ä¹‹åé…ç½®åˆ°apn-config.xml æ–‡ä»¶ä¸­çš„ï¼Œè€Œæ‰‹æœºç¬¬ä¸€æ¬¡å¼€æœºçš„æ—¶å€™ TelephonyProvider ä¼šè§£ææ­¤ xml æ–‡ä»¶ï¼ŒåŠ è½½æ‰€æœ‰ APNï¼Œå¹¶ä¿å­˜åˆ° telephony.db æ•°æ®åº“é‡Œé¢çš„ carriers è¡¨ä¸­(å…·ä½“è·¯å¾„ä¸ºï¼š/data/user_de/0/com.android.providers.telephony/databases/telephony.dbï¼Œéœ€è¦rootæ‰èƒ½çœ‹å¾—åˆ°)ã€‚å› æ­¤æ­¤æ¬¡é—®é¢˜å°±å¯ä»¥å®šä½åˆ°äº† TelephonyProvider ä¸­çš„æ•°æ®åº“ä»Oå‡çº§åˆ°P çš„æ—¶å€™å‘ç”Ÿå¼‚å¸¸ã€‚</p><p>APNåŠ è½½æ˜¯ç”¨sharedPreference ä¿å­˜çš„apn_idè¿›è¡Œæ•°æ®åº“æŸ¥è¯¢ï¼Œåœ¨å‡çº§onUpgradeå®Œæˆä¹‹ååˆ©ç”¨æ­¤idæ›´æ–°ä¸€äº›å¿…è¦çš„å­—æ®µï¼Œåœ¨åŠ è½½æ–°ç‰ˆæœ¬çš„apn-config.xmlæ–‡ä»¶ä¹‹ååå‘åˆ©ç”¨è¿™äº›å­—æ®µæŸ¥è¯¢apn_id.æŸ¥çœ‹xmlä¿å­˜çš„å­—æ®µå†…å®¹å‘ç°æŸ¥è¯¢åˆ°çš„è¯¥apn_idå¯¹åº”çš„å­—æ®µå’Œå‡çº§ä¹‹å‰æ•°æ®åº“ä¸­æ•°æ®ä¸ä¸€è‡´ï¼Œè¿›è€Œä¹Ÿè¯´æ˜äº†æ•°æ®åº“å‡çº§çš„æ—¶å€™å‘ç”Ÿäº†å¼‚å¸¸ã€‚</p><p>æ¥ç€å†è¯´è¯´ TelephonyProvider æ¨¡å—ä¸­å’Œ apn ç›¸å…³çš„æ•°æ®åº“å‡çº§æµç¨‹ã€‚ç”±äºè¦å…¼å®¹å„ä¸ª Android ç‰ˆæœ¬ï¼Œæ‰€ä»¥åœ¨providerçš„onUpgrade()æ–¹æ³•ä¸­å¯¹ä¸åŒç‰ˆæœ¬çš„æ•°æ®åº“è¿›è¡Œäº†å¤„ç†ï¼Œä¸»è¦åšçš„å·¥ä½œæœ‰ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p><ul><li>é€šè¿‡ ALTER å…³é”®å­—å¯¹æ—§ç‰ˆæœ¬æ•°æ®åº“å¢åŠ åˆ—ï¼›</li><li>å¯¹æ—§è¡¨æ•°æ®è¿›è¡Œæ‹·è´ï¼›<ul><li>åˆ›å»ºä¸€ä¸ªcarriers_tmp è¡¨ï¼ˆæ–°ç‰ˆæœ¬çš„å»ºè¡¨è¯­å¥ï¼‰;</li><li><span class="highlight-text red">æŸ¥è¯¢ carriers è¡¨ä¸­çš„æ‰€æœ‰æ•°æ®å¹¶é€æ¡æ’å…¥åˆ°carriers_tmpè¡¨ä¸­ï¼›</span></li><li>åˆ é™¤ carriers è¡¨ï¼›</li><li>å°†carriers_tmp é‡å‘½åä¸º carriers;</li></ul></li></ul><p>æ¥åˆ°è¿™ä¸ªé—®é¢˜ç¬¬ä¸€æ—¶é—´çœ‹äº†ä¸‹logå‘ç°æ²¡æœ‰ä¸è¡¨æ‹·è´ç›¸å…³çš„è¾“å…¥ï¼Œå› æ­¤åŠ äº†ä¸€äº›è¾“å‡ºlogå¹¶æ¨¡æ‹Ÿfotaå‡çº§æµç¨‹ï¼Œæœä¸å…¶ç„¶æ˜¯ä¸Šè¿°çº¢è‰²æ­¥éª¤å‡ºäº†é—®é¢˜ï¼šåœ¨æ‰§è¡Œå®Œä¸Šè¿°ç¬¬äºŒæ­¥ä¹‹ååˆ©ç”¨apn_idæŸ¥è¯¢å¯¹åº”çš„æ•°æ®åº“å†…å®¹å·²ç»å’Œç¬¬äºŒæ­¥æ‰§è¡Œä¹‹å‰çš„æ•°æ®åº“å†…å®¹ä¸ä¸€è‡´(å®é™…é—®é¢˜ä¸­å·®äº†ä¸€è¡Œ)ï¼›</p><p>å¼€å¯SQLiteç›¸å…³logå‘ç°åœ¨æ•°æ®æ‹·è´çš„è¿‡ç¨‹ä¸­æ’å…¥æŸä¸€è¡Œçš„æ—¶å€™ä¼šæ’å…¥å¤±è´¥ï¼Œæç¤ºè¿åå”¯ä¸€æ€§çº¦æŸã€‚æ–°è¡¨æ¯”æ—§è¡¨å°‘äº†ä¸€è¡Œæ•°æ®ï¼Œæ‰€ä»¥æŸ¥è¯¢å†…å®¹å‡ºé”™ä¹Ÿå°±é‚£ä¹ˆæ„å¤–äº†ã€‚</p><p>æ¥ç€å¯¹æ¯”å‡çº§å‰åçš„ä»£ç æœç„¶å‘ç°åœ¨å‡çº§åçš„æ•°æ®åº“å»ºè¡¨è¯­å¥ä¸­å‡å°‘äº†ä¸€ä¸ªå”¯ä¸€æ€§çº¦æŸæ¡ä»¶ï¼Œè¿™ä¹Ÿå°±æ˜¯è¿™ä¸ªé—®é¢˜çš„ç½ªé­ç¥¸é¦–äº†ã€‚</p><div class="alert info"><p>å¦‚æœå»ºè¡¨çš„æ—¶å€™åšäº†å”¯ä¸€æ€§çº¦æŸï¼Œé‚£ä¹ˆåœ¨æ’å…¥æ•°æ®çš„æ—¶å€™æ•°æ®åº“ä¼šå¯¹çº¦æŸå­—æ®µè¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœè¿™äº›å­—æ®µå’Œå·²æœ‰æ•°æ®ä¸­æŸä¸€è¡Œä¸€è‡´ï¼Œéš¾ä¹ˆæ’å…¥æ–°æ•°æ®çš„æ—¶å€™ä¼šäº§ç”Ÿå†²çªï¼Œjavaä¸­å¯ä»¥åˆ©ç”¨<code>insertWithOnConflict()</code>æ–¹æ³•å®ç°ã€‚</p></div><h2 id="æ¶‰åŠåˆ°çš„çŸ¥è¯†"><a class="anchor" href="#æ¶‰åŠåˆ°çš„çŸ¥è¯†"></a> æ¶‰åŠåˆ°çš„çŸ¥è¯†</h2><h3 id="å¼€å¯sql-log"><a class="anchor" href="#å¼€å¯sql-log"></a> å¼€å¯SQL log</h3><h4 id="æ­£å¸¸å¼€å¯sql-logçš„æ–¹æ³•"><a class="anchor" href="#æ­£å¸¸å¼€å¯sql-logçš„æ–¹æ³•"></a> æ­£å¸¸å¼€å¯SQL logçš„æ–¹æ³•</h4><p>Androidä¸Šé»˜è®¤æ˜¯å…³é—­SQL logçš„ï¼Œåœ¨å¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œçš„æ—¶å€™é™¤éåœ¨javaä»£ç é‡Œé¢æ‰“å°ï¼Œå¦åˆ™çœ‹ä¸åˆ°æ•°æ®åº“æ“ä½œè¯¦æƒ…ï¼Œå°±ç®—åœ¨javaä»£ç é‡Œé¢è¿›è¡Œäº†æ‰“å°ï¼Œä¹Ÿä¸ä¸€å®šå‘ç°æ•°æ®åº“æ“ä½œå‘ç”Ÿçš„é—®é¢˜ã€‚</p><p>å› æ­¤åœ¨åšæ•°æ®åº“ç›¸å…³åˆ†æçš„æ—¶å€™é™¤äº†åœ¨javaå±‚è¿›è¡Œæ‰“å°ï¼Œä¹Ÿåº”è¯¥æ‰“å¼€SQL ç›¸å…³çš„logè¿›è¡Œåˆ†æï¼›æ‰“å¼€æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">adb shell setprop log.tag.SQLiteLog VERBOSE</span><br><span class="line">adb shell setprop log.tag.SQLiteStatements VERBOSE</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ä¸Šè¿°æ–¹æ³•æœ‰ä¸å¥½çš„ä¸€ç‚¹å°±æ˜¯å¦‚æœæ‰‹æœºé‡å¯ï¼Œåˆ™ä¸Šè¿°æ–¹æ³•ä¼šåœ¨é‡å¯ä¹‹åå¤±æ•ˆã€‚ç”±äºåšTelephonyProviderå‡çº§ç›¸å…³çš„åˆ†æï¼Œæ‰‹æœºå¿…é¡»å¾—é‡å¯ã€‚å› æ­¤ä¸Šè¿°æ–¹æ³•ä¸è§å¾—å¯è¡Œã€‚</p><h4 id="é€šè¿‡ä¿®æ”¹propæ–‡ä»¶è¿›è¡Œå¼€å¯log"><a class="anchor" href="#é€šè¿‡ä¿®æ”¹propæ–‡ä»¶è¿›è¡Œå¼€å¯log"></a> é€šè¿‡ä¿®æ”¹propæ–‡ä»¶è¿›è¡Œå¼€å¯log</h4><p>åœ¨Android å¼€æœºçš„æ—¶å€™ä¼šä»<code>/vendor/build.prop</code> å’Œ <code>system/build.prop</code>ä»¥åŠ<code>/product/build.prop</code>æ–‡ä»¶åŠ è½½propå±æ€§ã€‚å› æ­¤åªéœ€è¦ä¿®æ”¹propæ–‡ä»¶å°±å¯ä»¥è¾¾åˆ°é‡å¯å¯ç”¨çš„ç›®çš„ã€‚</p><p>è¿™é‡Œä¿®æ”¹/vendor/build.prop`æ–‡ä»¶ï¼ŒåŠ å…¥ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">log.tag.SQLiteLog=VERBOSE</span><br><span class="line">log.tag.SQLiteStatements=VERBOSE</span><br></pre></td></tr></table></figure><p>ä¹‹åè¿›è¡Œé‡å¯é‚£ä¹ˆSQL logä¹Ÿä¸ä¼šå…³é—­äº†ã€‚</p><div class="alert info"><ul><li>æ­¤æ–¹æ³•å¿…é¡»åœ¨æ‰‹æœºrootä¹‹åæˆ–è€…åˆ·debugã€engç‰ˆæœ¬æ‰å¯ä»¥æ“ä½œï¼›</li><li>åœ¨ä¿®æ”¹propæ–‡ä»¶çš„æ—¶å€™å¯èƒ½å› ä¸ºæƒé™æ— æ³•ä¿®æ”¹ï¼Œæ­¤æ—¶è¦ä¹ˆä¿®æ”¹æƒé™ï¼Œè¦ä¹ˆå¯ä»¥æŠŠæ–‡ä»¶pullå‡ºæ¥ä¿®æ”¹å®Œæ¯•å†pushè¿›å»å³å¯ï¼›</li></ul></div><p>###SQLè¯­å¥ä¸­çš„ UNIQUE å…³é”®å­—</p><p><code>UNIQUE</code>æ˜¯SQLä¸­ç”¨æ¥å¯¹å­—æ®µè¿›è¡Œå”¯ä¸€æ€§çº¦æŸçš„å…³é”®å­—ï¼Œå®ƒå¯ä»¥çº¦æŸä¸€ä¸ªé”®ï¼Œä¹Ÿå¯ä»¥çº¦æŸå¤šä¸ªé”®ï¼ˆçº¦æŸå¤šä¸ªé”®æ—¶è¿™ä¸ªé”®å€¼çš„ç»„åˆå”¯ä¸€ï¼‰ã€‚SQL å…³é”®å­—ä¸­å’Œ UNIQUEåŠŸèƒ½æ¯”è¾ƒç›¸ä¼¼çš„æ˜¯<code>PRIMARY</code>ï¼Œè¿™ä¸¤ä¸ªå…³é”®å­—è™½ç„¶åŠŸèƒ½ä¸Šå¾ˆç›¸ä¼¼ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€å®šçš„åŒºåˆ«ï¼š</p><ul><li><p><code>PRIMARY</code>åªå¯ä»¥çº¦æŸä¸€ä¸ªé”®ï¼Œè¢«çº¦æŸçš„é”®ç§°ä¸º<code>ä¸»é”®</code>ï¼Œè€Œ<code>UNIQUE</code>å¯ä»¥ä¿®é¥°å¤šä¸ªé”®ï¼Œä½†å”¯ä¸€æ€§çº¦æŸæ‰€åœ¨çš„åˆ—å¹¶ä¸æ˜¯è¡¨çš„ä¸»é”®åˆ—ï¼›</p></li><li><p><code>UNIQUE</code> çº¦æŸçš„é”®å€¼å¯ä»¥ä¸ºç©ºï¼Œä½†æ˜¯<code>PRIMARY</code>çº¦æŸçš„é”®å€¼ä¸å¯ä»¥ä¸ºç©ºå¹¶ä¸å¯é‡å¤ï¼Œå³ï¼š</p><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">PRIMARY</span> = <span class="keyword">UNIQUE</span> + <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br></pre></td></tr></table></figure></li><li><p>PRIMARY çº¦æŸæ˜¯ä¸ºäº†è®©å¤–é”®å¼•ç”¨ï¼›</p></li><li><p>ä¸€ä¸ªè¡¨æœ€å¤šåªæœ‰ä¸€ä¸ªä¸»é”®ï¼Œä½†å¯ä»¥æœ‰å¾ˆå¤šUNIQUEçº¦æŸçš„é”®ï¼›</p></li></ul><h4 id="example"><a class="anchor" href="#example"></a> Example</h4><p>æ–°å»ºä¸€ä¸ªç”¨æˆ·èµ„æ–™è¡¨ï¼Œå»ºè¡¨è¯­å¥å¦‚ä¸‹ï¼Œå…¶ä¸­_idä¸ºä¸»é”®ï¼Œname_textå’Œid_card_numberç”¨å”¯ä¸€æ€§çº¦æŸã€‚</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> unique_test ( </span><br><span class="line">_id <span class="built_in">INTEGER</span> AUTO_INCREMENT PRIMARY <span class="keyword">KEY</span> , </span><br><span class="line">name_text <span class="built_in">VARCHAR</span> ( <span class="number">20</span> ), </span><br><span class="line">age <span class="built_in">INTEGER</span>, </span><br><span class="line">id_card_number <span class="built_in">VARCHAR</span> ( <span class="number">18</span> ), </span><br><span class="line"><span class="keyword">UNIQUE</span> ( name_text, id_card_number ) );</span><br></pre></td></tr></table></figure><p>æ¥ç€æ’å…¥ä¸‰æ¡æ•°æ®åˆ°è¯¥è¡¨ä¸­ï¼š</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> unique_test(name_text,age,id_card_number)  <span class="keyword">VALUES</span>(<span class="string">"name1"</span>,<span class="number">10</span>,<span class="string">"123456"</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> unique_test(name_text,age,id_card_number)  <span class="keyword">VALUES</span>(<span class="string">"name2"</span>,<span class="number">20</span>,<span class="string">"234561"</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> unique_test(name_text,age,id_card_number)  <span class="keyword">VALUES</span>(<span class="string">"name1"</span>,<span class="number">30</span>,<span class="string">"234561"</span>);</span><br></pre></td></tr></table></figure><p>æ¥ç€æ’å…¥ä¸‹é¢è¿™æ¡æ•°æ®ï¼š</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> unique_test(name_text,age,id_card_number)  <span class="keyword">VALUES</span>(<span class="string">"name1"</span>,<span class="number">30</span>,<span class="string">"123456"</span>);</span><br></pre></td></tr></table></figure><p>è¿è¡Œå®Œè¿™æ¡è¯­å¥åˆ™ä¼šæŠ¥é”™ï¼Œæç¤ºå¦‚ä¸‹ï¼š</p><figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">Duplicate <span class="keyword">entry</span> <span class="symbol">'name1</span>-<span class="number">123456</span>' <span class="keyword">for</span> key <span class="symbol">'name_text</span>'</span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæ˜¯å› ä¸ºname_textå­—æ®µå’Œid_card_numberå­—æ®µæ˜¯è¢«UNIQUEè¿›è¡Œçº¦æŸçš„ï¼Œå› æ­¤è¿™ä¸¤ä¸ªå­—æ–­çš„ç»„åˆåœ¨æ•°æ®åº“è¡¨ä¸­åº”è¯¥ä¿æŒå”¯ä¸€ï¼Œä½†æ˜¯ä¸Šé¢ä¸€å¤©æ•°æ®çš„ç»„åˆ<code>name1-123456</code>å’Œæ’å…¥çš„ç¬¬ä¸€æ¡æ•°æ®é‡å¤ï¼Œå› æ­¤ä¼šæç¤ºé”™è¯¯ã€‚</p><p>å¦‚æœè¦æ’å…¥çš„æ—¶å€™ä¸æŠ¥é”™ï¼Œåˆ™å¯ä»¥ä½¿ç”¨<code>ignore</code>æˆ–è€…<code>update</code>æ–¹æ³•ï¼š</p><ul><li><p><code>ignore</code></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">IGNORE</span> <span class="keyword">INTO</span> unique_test(name_text,age,id_card_number)  <span class="keyword">VALUES</span>(<span class="string">"name1"</span>,<span class="number">30</span>,<span class="string">"123456"</span>);</span><br></pre></td></tr></table></figure><p>è¿™æ¡æ’å…¥çš„æ•°æ®ç›´æ¥è¢«å¿½ç•¥ï¼›</p></li><li><p><code>update</code>æ–¹æ³•:</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> unique_test(name_text,age,id_card_number)  <span class="keyword">VALUES</span>(<span class="string">"name1"</span>,<span class="number">30</span>,<span class="string">"123456"</span>) <span class="keyword">ON</span> <span class="keyword">DUPLICATE</span> <span class="keyword">KEY</span> <span class="keyword">UPDATE</span> id_card_number = <span class="string">'654321'</span>;</span><br></pre></td></tr></table></figure><p>è¿è¡Œå®Œæ¯•åå½“å‰æ•°æ®åº“è¡¨ä¸­çš„è®°å½•ä¸ªæ•°ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œä½†æ˜¯å·²æœ‰çš„æ•°æ®ä¼šä¸­çš„<code>id_card_number</code>å€¼ä¼šè¢«æ›´æ–°ä¸º<code>654321</code>ã€‚</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ¬æ–‡ä¸»è¦å¯¹å·¥ä½œä¸­ç”±&lt;code&gt;UNIQUE&lt;/code&gt;å”¯ä¸€æ€§çº¦æŸæ›´æ”¹å¯¼è‡´æ•°æ®åº“å‡çº§æ‹·è´æ•°æ®çš„æ—¶å€™å¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Œå¼•å‘VPNæ”¹å˜çš„é—®é¢˜åšä¸€ä¸ªç®€å•çš„ç¬”è®°ï¼Œé¡ºä¾¿æ¢³ç†ä¸€ä¸‹UNIQUEå…³é”®å­—ç›¸å…³çš„çŸ¥è¯†ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç¨‹åºçŒ¿è¿›åŒ–ä¹‹è·¯" scheme="http://www.istarx.cn/categories/%E7%A8%8B%E5%BA%8F%E7%8C%BF%E8%BF%9B%E5%8C%96%E4%B9%8B%E8%B7%AF/"/>
    
    
      <category term="sql" scheme="http://www.istarx.cn/tags/sql/"/>
    
  </entry>
  
  <entry>
    <title>å•å…ƒæµ‹è¯•ä¹‹ â€”  Robolectric æ¡†æ¶</title>
    <link href="http://www.istarx.cn/2018/05/07/robolectric-framework/"/>
    <id>http://www.istarx.cn/2018/05/07/robolectric-framework/</id>
    <published>2018-05-07T15:21:28.000Z</published>
    <updated>2019-02-18T16:56:16.445Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>Robolectric æ¡†æ¶æ˜¯ä¸€æ¬¾å¯ä»¥åœ¨JVM ä¸Šè¿è¡Œ Android ç›¸å…³ä»£ç çš„æ¡†æ¶ï¼Œåœ¨ Android å•å…ƒæµ‹è¯•æ€»èµ·åˆ°è‡³å…³é‡è¦çš„ä½œç”¨ã€‚å®ƒæ—¢æœ‰å‡å°‘ç¼–è¯‘ã€æµ‹è¯•ç”¨ä¾‹è¿è¡Œçš„æ—¶é—´ç­‰ä¼˜ç‚¹ã€‚</p><a id="more"></a><p><ul class="toc js-fixedContent"><li><a href="#robolectric-%E6%A1%86%E6%9E%B6%E7%AE%80%E4%BB%8B">Robolectric æ¡†æ¶ç®€ä»‹</a></li><li><a href="#gralde-%E9%85%8D%E7%BD%AE">Gralde é…ç½®</a></li><li><a href="#robolectric-%E9%85%8D%E7%BD%AE">Robolectric é…ç½®</a></li><li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89-runner-%E5%8A%A0%E5%BF%AB%E4%B8%8B%E8%BD%BD-jar-%E5%8C%85%E7%9A%84%E9%80%9F%E5%BA%A6">è‡ªå®šä¹‰ Runner åŠ å¿«ä¸‹è½½ jar åŒ…çš„é€Ÿåº¦</a></li><li><a href="#%E6%B5%8B%E8%AF%95-android-%E7%BB%84%E4%BB%B6">æµ‹è¯• Android ç»„ä»¶</a><ul><li><a href="#activity%E6%B5%8B%E8%AF%95">Activityæµ‹è¯•</a><ul><li><a href="#activity-%E5%88%9B%E5%BB%BA%E6%B5%8B%E8%AF%95">Activity åˆ›å»ºæµ‹è¯•</a></li><li><a href="#activity-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%B5%8B%E8%AF%95">Activity ç”Ÿå‘½å‘¨æœŸæµ‹è¯•</a></li><li><a href="#activity-%E8%B7%B3%E8%BD%AC%E6%B5%8B%E8%AF%95">Activity è·³è½¬æµ‹è¯•</a></li></ul></li><li><a href="#dialog-%E6%B5%8B%E8%AF%95">Dialog æµ‹è¯•</a></li><li><a href="#toast-%E6%B5%8B%E8%AF%95">Toast æµ‹è¯•</a></li><li><a href="#%E6%8E%A7%E4%BB%B6%E7%8A%B6%E6%80%81%E6%B5%8B%E8%AF%95">æ§ä»¶çŠ¶æ€æµ‹è¯•</a></li><li><a href="#broadcastreceiver-%E6%B5%8B%E8%AF%95">BroadCastReceiver æµ‹è¯•</a></li><li><a href="#service-%E6%B5%8B%E8%AF%95">Service æµ‹è¯•</a></li><li><a href="#%E8%B5%84%E6%BA%90%E6%B5%8B%E8%AF%95">èµ„æºæµ‹è¯•</a></li><li><a href="#looper-%E6%B5%8B%E8%AF%95">Looper æµ‹è¯•</a></li></ul></li><li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89-shadow">è‡ªå®šä¹‰ Shadow</a></li><li><a href="#%E5%B0%8F%E7%BB%93">å°ç»“</a></li></ul></p><h2 id="robolectric-æ¡†æ¶ç®€ä»‹"><a class="anchor" href="#robolectric-æ¡†æ¶ç®€ä»‹"></a> Robolectric æ¡†æ¶ç®€ä»‹</h2><p>Android æµ‹è¯•ç”¨ä¾‹ç¼–å†™çš„è¿‡ç¨‹ä¸­ï¼Œå’Œ Android æ¡†æ¶è¿›è¡Œäº¤äº’çš„å•å…ƒæ˜¯æµ‹è¯•éš¾ç‚¹æ‰€åœ¨ï¼Œä¹Ÿæ˜¯ä¸»è¦è€—è´¹æ—¶é—´çš„åœ°æ–¹ï¼Œé’ˆå¯¹è¿™ç±»é—®é¢˜ï¼Œåœ¨ Robolectric æ¡†æ¶å‡ºç°ä¹‹å‰ä¸»è¦æœ‰ä¸¤ç§è§£æ³•ï¼š</p><ul><li>ç¼–å†™ Android JUnit Testï¼Œè¿™ç±»æµ‹è¯•ç”¨ä¾‹çš„ä¼˜ç‚¹æ˜¯ä¸ç”¨å¯¹æ¡†æ¶ç›¸å…³çš„ä»£ç è¿›è¡Œç‰¹æ®Šå¤„ç†ï¼Œç¼ºç‚¹æ˜¯æ¯æ¬¡è¿è¡Œéƒ½éœ€è¦ç¼–è¯‘è¢«æµ‹è¯•ä»£ç  apk å’Œæµ‹è¯•ä»£ç  apkï¼Œæ¯”è¾ƒè€—æ—¶ï¼›</li><li>å¯¹ Android æ¡†æ¶ç›¸å…³çš„ç±»ã€æ–¹æ³•ç­‰è¿›è¡Œ mockï¼Œæ­¤æ–¹æ³•å¯ä»¥å‡å°‘ç¼–è¯‘åŠè¿è¡Œæ—¶é—´ï¼Œä½†æ˜¯å¯¹å¤§é‡æ¡†æ¶ç›¸å…³ä»£ç çš„mock å¯¹æµ‹è¯•ç”¨ä¾‹ç¼–å†™å¸¦æ¥äº†ä¸€å®šçš„éš¾åº¦åŠå¤æ‚åº¦ï¼›</li></ul><p>å¹¸è¿çš„æ˜¯ Robolectric æ¡†æ¶çš„å‡ºç°è§£å†³äº†è¿™ä¸€ç³»åˆ—é—®é¢˜ã€‚Robolectricå¯ä»¥åœ¨ JVM ä¸Šè¿è¡Œ Android ç›¸å…³çš„ä»£ç ï¼Œä¸éœ€è¦å€ŸåŠ©æ‰‹æœºå°±å¯ä»¥å¯¹ Activityã€Service ç­‰å››å¤§ç»„ä»¶ã€èµ„æºç­‰è¿›è¡Œæµ‹è¯•ï¼Œç»™ Android æµ‹è¯•å¸¦æ¥äº†å¾ˆå¤§çš„ä¾¿åˆ©ã€‚</p><p>Robolectric æ¡†æ¶ä¸»è¦æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š</p><ul><li><p>æ¡†æ¶å¯¹ Android.jar åŒ…ä¸­å‡ ä¹æ‰€æœ‰çš„ç±»éƒ½è¿›è¡Œäº†æ˜ å°„(Shadow)ï¼Œå³å¯¹äºä¸€ä¸ªç±»<code>X</code>ï¼Œåˆ™æœ‰ä¸€ä¸ªå…¶å½±å­<code>ShadowX</code>ï¼Œæ¯”å¦‚ï¼Œ<code>Log</code>ç±»å¯¹åº”çš„å½±å­ä¸º<code>ShadowLog</code>ï¼Œæµ‹è¯•ç”¨ä¾‹è¿‡ç¨‹ä¸­å¯ä»¥æƒ³æ“ä½œåŸå§‹ç±»ä¸€æ ·æ“ä½œå…¶æ˜ å°„ã€‚åŒæ—¶Robolectric è¿˜æä¾›äº†è‡ªå®šä¹‰å½±å­çš„æ–¹æ³•ï¼Œè¿™ç‚¹åé¢ä¼šè¯´åˆ°ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼ŒRobolectric æ¡†æ¶è¿˜å¯¹èµ„æºã€Native æ–¹æ³•éƒ½è¿›è¡Œäº†ç‰¹æ®Šçš„å¤„ç†ï¼Œä½¿ä¹‹èƒ½åœ¨ JVM ä¸Šè¿è¡Œã€‚</p></li><li><p>åœ¨è™šæ‹Ÿæœºå’ŒçœŸå®è®¾å¤‡ä¹‹å¤–è¿è¡Œæµ‹è¯•ç”¨ä¾‹ï¼Œæ­£å¦‚å‰é¢è¯´åˆ°çš„ä¸€æ ·ï¼ŒRobolectric å¯¹æ¡†æ¶çš„ä»£ç åšäº†é‡æ–°å®ç°ï¼Œä½¿ä¹‹å¯ä»¥è„±ç¦»æ‰‹æœºæˆ–è€…è™šæ‹Ÿæœºè¿è¡Œã€‚</p></li><li><p>ä¸éœ€è¦å» mock æ¡†æ¶ç›¸å…³ä»£ç ï¼Œå½“ç„¶ï¼Œå¿…è¦çš„æƒ…å†µä¸‹å¯ä»¥é…åˆ mock æˆ–è€… powermock ç­‰ mock æ¡†æ¶è¿›è¡Œæ›´å…¨é¢çš„æµ‹è¯•(åç»­æ–‡ç« ä¼šé™åˆ° Robolectric å’Œ PowerMock æ¡†æ¶æ­é…è¿›è¡Œå•å…ƒæµ‹è¯•)ã€‚</p></li></ul><h2 id="gralde-é…ç½®"><a class="anchor" href="#gralde-é…ç½®"></a> Gralde é…ç½®</h2><p>ä½¿ç”¨ Robolectric æ¡†æ¶éœ€è¦å¼•å…¥å…¶å¯¹åº”çš„ä¾èµ–åŒ…ï¼Œå¹¶åšå…¶å®ƒçš„ä¸€äº›ç®€å•é…ç½®ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">...</span><br><span class="line">    testOptions &#123;</span><br><span class="line">        unitTests &#123;</span><br><span class="line">            includeAndroidResources = <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">dependencies &#123;</span><br><span class="line">    testImplementation <span class="string">'org.robolectric:robolectric:3.8'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="robolectric-é…ç½®"><a class="anchor" href="#robolectric-é…ç½®"></a> Robolectric é…ç½®</h2><p>Robolectric æ¡†æ¶çš„é…ç½®ä¸»è¦åˆ†ä¸ºä¸¤ä¸ªï¼š</p><ul><li><p>Runner æŒ‡å®šï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(RobolectricTestRunner.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span>  <span class="title">RobolectricDemoTest</span></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åˆ©ç”¨ <code>@Config</code>æŒ‡å®šä¸€äº›å…¶å®ƒçš„é…ç½®ï¼Œå¯ä»¥æŒ‡å®šçš„é…ç½®ä¸»è¦æœ‰ä»¥ä¸‹ä¸€äº›ï¼š</p><table><thead><tr><th>é…ç½®å±æ€§</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>sdk</code> / <code>minSdk</code> / <code>maxSdk</code></td><td>æŒ‡å®šæµ‹è¯•ç”¨ä¾‹æ‰€å·¥ä½œ / æœ€å° / æœ€å¤§çš„ sdk ç‰ˆæœ¬</td></tr><tr><td><code>manifest</code></td><td>æŒ‡å®š Android manifest æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ä¸­çš„èµ„æºã€assert æ–‡ä»¶éƒ½å°†è¢«åŠ è½½ã€‚</td></tr><tr><td><code>constants</code></td><td>æŒ‡å®šç”± Gradle ç¼–è¯‘ç”Ÿæˆçš„ <code>BuildConfig</code>æ–‡ä»¶ï¼Œé»˜è®¤ä¸º <code>Void.class</code></td></tr><tr><td><code>packageName</code></td><td><code>R.class</code>æ–‡ä»¶æ‰€åœ¨çš„åŒ…åï¼Œå¦‚æœåœ¨ gradle æ–‡ä»¶çš„ productflavor å¯¹åŒ…åè¿›è¡Œäº†æ”¹å˜ï¼Œåˆ™éœ€è¦æŒ‡å®šè¯¥è®¾ç½®</td></tr><tr><td><code>application</code></td><td>æŒ‡å®šæµ‹è¯•ç”¨ä¾‹æ‰€ä½¿ç”¨çš„ <code>Application</code>ç±»ï¼Œæ¬¡æŒ‡å®šå°†ä¼šè¦†ç›– AndroidManifestä¸­æŒ‡å®šçš„ Application ç±»</td></tr><tr><td><code>qualifiers</code></td><td>æŒ‡å®šèµ„æºæ–‡ä»¶æ‰€ä½¿ç”¨çš„è¯­è¨€ã€æ¨ªç«–å±ç­‰ï¼Œåœ¨å¤šè¯­è¨€æµ‹è¯•æ—¶å¾ˆæœ‰ç”¨ï¼Œæ–¹æ³•å’Œç±»çº§åˆ«æ³¨è§£éƒ½å¯ä»¥</td></tr><tr><td><code>resourceDir</code></td><td>æŒ‡å®šåŠ è½½èµ„æºæ‰€ä½¿ç”¨çš„æ–‡ä»¶å¤¹ï¼Œé»˜è®¤ä¸º<code>res</code></td></tr><tr><td><code>assetDir</code></td><td>æŒ‡å®šåŠ è½½ assert æ–‡ä»¶æ‰€ä½¿ç”¨çš„æ–‡ä»¶å¤¹ï¼Œé»˜è®¤ä¸º<code>assets</code></td></tr><tr><td><code>shadows</code></td><td>æŒ‡å®šè‡ªå®šä¹‰ shadow æ–‡ä»¶ï¼Œå¯ä»¥åŒæ—¶æŒ‡å®šå¤šä¸ª</td></tr><tr><td><code>instrumentedPackages</code></td><td>å·²ç»è®¾å¤‡åŒ–çš„åŒ…ååˆ—è¡¨</td></tr><tr><td><code>libraries</code></td><td>å·¥ç¨‹æ‰€ä¾èµ–çš„ library æ–‡ä»¶å¤¹ï¼Œå¯ä»¥åŒæ—¶æŒ‡å®šå¤šä¸ªï¼Œé»˜è®¤ä¸º<code>{}</code></td></tr></tbody></table><p>ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Config</span>(manifest = <span class="string">"AndroidManifest.xml"</span>,</span><br><span class="line"><span class="comment">// sdk = 27,</span></span><br><span class="line">minSdk = <span class="number">26</span>,</span><br><span class="line">maxSdk = <span class="number">28</span>,</span><br><span class="line">shadows = CustomShadow.class,</span><br><span class="line">libraries = &#123;</span><br><span class="line">        <span class="string">"path/to/library1"</span>,</span><br><span class="line">        <span class="string">"path/to/library2"</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="meta">@RunWith</span>(RobolectricTestRunner.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RobolectricTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Config</span>(qualifiers = <span class="string">"zh-CN"</span>ï¼Œ</span><br><span class="line">           application = CustomApplication.class)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">name</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="alert warning"><p><code>minSdk</code>æˆ–<code>maxSdk</code>ä¸èƒ½åŒæ—¶å’Œ<code>sdk</code>åŒæ—¶å‡ºç°</p></div></li><li><p>gradle æ–‡ä»¶ä¸­é…ç½®ç³»ç»Ÿå±æ€§</p><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">  testOptions &#123;</span><br><span class="line">    unitTests.all &#123;</span><br><span class="line">      systemProperty <span class="string">'robolectric.dependency.repo.url'</span>, <span class="string">'https://local-mirror/repo'</span></span><br><span class="line">      systemProperty <span class="string">'robolectric.dependency.repo.id'</span>, <span class="string">'local'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="è‡ªå®šä¹‰-runner-åŠ å¿«ä¸‹è½½-jar-åŒ…çš„é€Ÿåº¦"><a class="anchor" href="#è‡ªå®šä¹‰-runner-åŠ å¿«ä¸‹è½½-jar-åŒ…çš„é€Ÿåº¦"></a> è‡ªå®šä¹‰ Runner åŠ å¿«ä¸‹è½½ jar åŒ…çš„é€Ÿåº¦</h2><p>ä»¥ RobolectricTestRunner ä½œä¸ºæ³¨è§£çš„æµ‹è¯•ç”¨ä¾‹åœ¨è¿è¡Œä¹‹å‰ä¼šä¸‹è½½ android-all-x.x.x ç›¸å…³æ–‡ä»¶ï¼Œä½†æ˜¯è¿™ä¸ªç½‘ç«™ä¸‹è½½é€Ÿåº¦æ˜¯èƒ½æ˜¯é¾Ÿé€Ÿï¼Œæœ‰æ—¶å€™è¿˜ä¼šå‡ºç°ä¸‹è½½å¤±è´¥çš„é—®é¢˜ã€‚è¿™ç§æƒ…å†µå¯ä»¥é€šè¿‡è‡ªå®šä¹‰ Runnerï¼Œæ·»åŠ è‡ªå®šä¹‰çš„ maven åœ°å€ï¼Œä¾‹å¦‚é˜¿é‡Œäº‘ç­‰ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ç¦»çº¿ä¸‹è½½åˆ°<code>&lt;USER_HOME&gt;/.m2/repository/org/robolectric/android-all/xxx/</code>ç›®å½•ä¸‹ï¼Œ<code>xxx</code>ä¸º jar åŒ…çš„ç‰ˆæœ¬å·ã€‚</p><p><code>RoboSettings</code> ç±»ä¸­å®šä¹‰ä¸¤ä¸ªé™æ€å˜é‡<code>mavenRepositoryId</code>å’Œ<code>mavenRepositoryUrl</code>ï¼Œåˆ†åˆ«ä¸º maven ä»“åº“çš„ id å’Œ urlï¼ŒRobolectric æ˜¯é€šè¿‡è¯»å–è¿™ä¸¤ä¸ªçš„å€¼æ¥è·å– maven ä»“åº“åœ°å€ï¼Œå› ä¸ºåªéœ€è¦åœ¨è‡ªå®šä¹‰ Runner ä¸­åˆ†åˆ«åˆ¶å®šè¿™ä¸¤ä¸ªå˜é‡å€¼ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomRobolectricRunner</span> <span class="keyword">extends</span> <span class="title">RobolectricTestRunner</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomRobolectricRunner</span><span class="params">(Class&lt;?&gt; testClass)</span> <span class="keyword">throws</span> InitializationError </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(testClass);</span><br><span class="line"><span class="comment">// è®¾ç½® maven ä»“åº“ id å’Œ url</span></span><br><span class="line">        RoboSettings.setMavenRepositoryId(<span class="string">"aliyun"</span>);</span><br><span class="line">        RoboSettings.setMavenRepositoryUrl(<span class="string">"http://maven.aliyun.com/nexus/content/groups/public/"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœè¦ä¿®æ”¹å…¨å±€é…ç½®ï¼Œåˆ™éœ€è¦åœ¨è‡ªå®šä¹‰ Runner ä¸­é‡å†™<code>buildGlobalConfig</code>æ–¹æ³•ã€‚</p><h2 id="æµ‹è¯•-android-ç»„ä»¶"><a class="anchor" href="#æµ‹è¯•-android-ç»„ä»¶"></a> æµ‹è¯• Android ç»„ä»¶</h2><p>Robolectric æ¡†æ¶ä¸ä»…å¯ä»¥æµ‹è¯• Activity ç­‰ Android å››å¤§ç»„ä»¶ï¼Œä¹Ÿå¯ä»¥æµ‹è¯•ä¾‹å¦‚ Dialogã€Toastç­‰ï¼Œä¹Ÿå¯ä»¥æµ‹è¯•æ§ä»¶çš„çŠ¶æ€ã€‚</p><h3 id="activityæµ‹è¯•"><a class="anchor" href="#activityæµ‹è¯•"></a> Activityæµ‹è¯•</h3><p>Activity æµ‹è¯•ä¸»è¦åŒ…æ‹¬ Activity çš„åˆ›å»ºã€ç”Ÿå‘½å‘¨æœŸä»¥åŠ Activity çš„è·³è½¬ç­‰ï¼Œä¸‹é¢åˆ†åˆ«è¿›è¡Œä¸¾ä¾‹ã€‚</p><h4 id="activity-åˆ›å»ºæµ‹è¯•"><a class="anchor" href="#activity-åˆ›å»ºæµ‹è¯•"></a> Activity åˆ›å»ºæµ‹è¯•</h4><p>Robolectric æ¡†æ¶æä¾›äº†<code>ActivityController</code> ç±»æ¥æ“ä½œ Activityï¼Œä¸ä»…å¯ä»¥åˆ›å»º Activityï¼Œè¿˜å¯ä»¥å¯¹ Activity çš„å‘¨æœŸå‡½æ•°è¿›è¡Œæ“ä½œã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">activitySetupTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    RobolectricDemoActivity activity = Robolectric.buildActivity(RobolectricDemoActivity.class)</span><br><span class="line">        .create()</span><br><span class="line">        .get();</span><br><span class="line"></span><br><span class="line">    assertNotNull(activity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="activity-ç”Ÿå‘½å‘¨æœŸæµ‹è¯•"><a class="anchor" href="#activity-ç”Ÿå‘½å‘¨æœŸæµ‹è¯•"></a> Activity ç”Ÿå‘½å‘¨æœŸæµ‹è¯•</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">activityLifeCycleTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ActivityController&lt;RobolectricDemoActivity&gt; controller = Robolectric.buildActivity(RobolectricDemoActivity.class);</span><br><span class="line"></span><br><span class="line">    controller.create(); <span class="comment">// ç›¸å½“äºæ‰§è¡Œå®Œ onCreate å‘¨æœŸå‡½æ•°</span></span><br><span class="line">    <span class="comment">// æµ‹è¯• onCreate æ‰§è¡Œä¹‹åçš„çŠ¶æ€</span></span><br><span class="line"></span><br><span class="line">    controller.resume(); <span class="comment">// ç›¸å½“äºæ‰§è¡Œå®Œ onResume å‘¨æœŸå‡½æ•°</span></span><br><span class="line">    <span class="comment">// æµ‹è¯• onResume æ‰§è¡Œä¹‹åçš„çŠ¶æ€</span></span><br><span class="line"></span><br><span class="line">    controller.pause(); <span class="comment">// ç›¸å½“äºæ‰§è¡Œå®Œ onPause å‘¨æœŸå‡½æ•°</span></span><br><span class="line">    <span class="comment">// æµ‹è¯• onPause æ‰§è¡Œä¹‹åçš„çŠ¶æ€</span></span><br><span class="line"></span><br><span class="line">    controller.stop(); <span class="comment">// ç›¸å½“äºæ‰§è¡Œå®Œ onStop å‘¨æœŸå‡½æ•°</span></span><br><span class="line">    <span class="comment">// æµ‹è¯• onStop æ‰§è¡Œä¹‹åçš„çŠ¶æ€</span></span><br><span class="line"></span><br><span class="line">    controller.destroy(); <span class="comment">// ç›¸å½“äºæ‰§è¡Œå®Œ onDestroy å‘¨æœŸå‡½æ•°</span></span><br><span class="line">    <span class="comment">// æµ‹è¯• onDestroy æ‰§è¡Œä¹‹åçš„çŠ¶æ€</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="activity-è·³è½¬æµ‹è¯•"><a class="anchor" href="#activity-è·³è½¬æµ‹è¯•"></a> Activity è·³è½¬æµ‹è¯•</h4><p>ä¸‹é¢æ˜¯æµ‹è¯•ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®èµ·åŠ¨ Activity çš„ç”¨ä¾‹</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">jumpActivityTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    RobolectricDemoActivity activity = Robolectric.buildActivity(RobolectricDemoActivity.class)</span><br><span class="line">        .create().get();</span><br><span class="line">    Button button = activity.findViewById(R.id.aty_jump);</span><br><span class="line"></span><br><span class="line">    Intent exceptIntent = <span class="keyword">new</span> Intent(activity, LoginActivity.class);</span><br><span class="line"></span><br><span class="line">    button.performClick(); <span class="comment">// æ¨¡æ‹Ÿç‚¹å‡»æŒ‰é”®</span></span><br><span class="line">    Intent actualIntent = ShadowApplication.getInstance().getNextStartedActivity();</span><br><span class="line"></span><br><span class="line">    assertEquals(exceptIntent.getComponent(), actualIntent.getComponent());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="dialog-æµ‹è¯•"><a class="anchor" href="#dialog-æµ‹è¯•"></a> Dialog æµ‹è¯•</h3><p>æµ‹è¯•ç‚¹å‡»æŒ‰é’®å¼¹å‡º Dialog çš„æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dialogTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    RobolectricDemoActivity activity = Robolectric.buildActivity(RobolectricDemoActivity.class)</span><br><span class="line">        .create().get();</span><br><span class="line">    Button button = activity.findViewById(R.id.show_dialog);</span><br><span class="line">    button.performClick();</span><br><span class="line">    ShadowDialog dialog = ShadowApplication.getInstance().getLatestDialog(); <span class="comment">// è·å–æœ€è¿‘å¼¹å‡ºçš„å¯¹è¯æ¡†</span></span><br><span class="line"></span><br><span class="line">    assertNotNull(dialog);</span><br><span class="line">    assertEquals(<span class="string">"DialogTest"</span>, dialog.getTitle());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="toast-æµ‹è¯•"><a class="anchor" href="#toast-æµ‹è¯•"></a> Toast æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">toastTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    RobolectricDemoActivity activity = Robolectric.buildActivity(RobolectricDemoActivity.class)</span><br><span class="line">        .create().get();</span><br><span class="line">    Button button = activity.findViewById(R.id.toast);</span><br><span class="line">    button.performClick();</span><br><span class="line">    Toast toast = ShadowToast.getLatestToast(); <span class="comment">// è·å–æœ€è¿‘å¼¹å‡ºçš„ toast</span></span><br><span class="line"></span><br><span class="line">    assertNotNull(toast);</span><br><span class="line">    assertEquals(<span class="string">"ToastTest"</span>, ShadowToast.getTextOfLatestToast());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ§ä»¶çŠ¶æ€æµ‹è¯•"><a class="anchor" href="#æ§ä»¶çŠ¶æ€æµ‹è¯•"></a> æ§ä»¶çŠ¶æ€æµ‹è¯•</h3><p>åœ¨ Activity èµ·åŠ¨è·å–åˆ°æ§ä»¶ä¹‹åï¼Œå¯ä»¥å¯¹æ§ä»¶çš„çŠ¶æ€è¿›è¡ŒéªŒè¯ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªéªŒè¯æ˜¯å¦å¯ç”¨çš„ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">widgetTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    RobolectricDemoActivity activity = Robolectric.buildActivity(RobolectricDemoActivity.class)</span><br><span class="line">        .create().get();</span><br><span class="line">    Button button = activity.findViewById(R.id.toast);</span><br><span class="line"></span><br><span class="line">    assertNotNull(button);</span><br><span class="line">    assertTrue(button.isEnabled());</span><br><span class="line">    assertEquals(<span class="string">"Toast"</span>, button.getText());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="broadcastreceiver-æµ‹è¯•"><a class="anchor" href="#broadcastreceiver-æµ‹è¯•"></a> BroadCastReceiver æµ‹è¯•</h3><p>å¹¿æ’­æ¥æ”¶å™¨çš„æµ‹è¯•ä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼š</p><ul><li>æ˜¯å¦æ³¨å†Œè¯¥å¹¿æ’­ï¼›</li><li>æ¥æ”¶åˆ°å¹¿æ’­ä¹‹åé€»è¾‘æ˜¯å¦æ­£å¸¸ï¼›</li></ul><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªæ¥æ”¶å¼¹å‡º Toast çš„ä¸€ä¸ªå¹¿æ’­æ¥æ”¶å™¨çš„æµ‹è¯•ç”¨ä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiverTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Intent intent = <span class="keyword">new</span> Intent(<span class="string">"cc.istarx.MyReceiver"</span>);</span><br><span class="line">    intent.putExtra(<span class="string">"receiver_test"</span>, <span class="string">"Receiver Test"</span>);</span><br><span class="line"></span><br><span class="line">    MyReceiver receiver = <span class="keyword">new</span> MyReceiver();</span><br><span class="line">    <span class="comment">// éªŒè¯æ˜¯å¦æ³¨å†Œ</span></span><br><span class="line">    assertTrue(ShadowApplication.getInstance().hasReceiverForIntent(intent));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éªŒè¯é€»è¾‘æ˜¯å¦æ­£ç¡®</span></span><br><span class="line">    ShadowApplication.getInstance().sendBroadcast(intent);</span><br><span class="line">    assertEquals(<span class="string">"Receiver Test"</span>, ShadowToast.getTextOfLatestToast());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="service-æµ‹è¯•"><a class="anchor" href="#service-æµ‹è¯•"></a> Service æµ‹è¯•</h3><p>ä»¥è‡ªå®šä¹‰ IntentService ä¸ºä¾‹ï¼Œservice ä¸»ä½“ä»£ç åŠæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyService</span> <span class="keyword">extends</span> <span class="title">IntentService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onHandleIntent</span><span class="params">(@Nullable Intent intent)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// do something here</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æµ‹è¯•ä»£ç </span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">serviceTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Intent intent = <span class="keyword">new</span> Intent();</span><br><span class="line"></span><br><span class="line">    MyService service = <span class="keyword">new</span> MyService(<span class="string">"test"</span>);</span><br><span class="line">    service.onHandleIntent(intent);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// verify logical here</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="èµ„æºæµ‹è¯•"><a class="anchor" href="#èµ„æºæµ‹è¯•"></a> èµ„æºæµ‹è¯•</h3><p>èµ„æºæµ‹æ˜¯é€šè¿‡<code>@Config(qualifiers = &quot;&quot;)</code>çŸ¥é“ä¸åŒè¯­è¨€ã€åˆ†è¾¨ç‡æˆ–è€…æ¨ªç«–å±ï¼Œå¯¹ä¸åŒçš„èµ„æºè¿›è¡Œæµ‹è¯•ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * res/values/strings.xml</span></span><br><span class="line"><span class="comment"> * &lt;string name="login_activity_res"&gt;This is Login Activity&lt;/string&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * res/values-zh-rCN/strings.xml</span></span><br><span class="line"><span class="comment"> * &lt;string name="login_activity_res"&gt;This is Login Activity with zh-rCN&lt;/string&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@Config</span>(qualifiers = <span class="string">"zh-rCN"</span>) <span class="comment">// æŒ‡å®šä¸­æ–‡è¯­è¨€</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">resourcesTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Context context = RuntimeEnvironment.application;</span><br><span class="line">    String str = context.getResources().getString(R.string.login_activity_res);</span><br><span class="line"></span><br><span class="line">    assertEquals(<span class="string">"This is Login Activity with zh-rCN"</span>, str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="looper-æµ‹è¯•"><a class="anchor" href="#looper-æµ‹è¯•"></a> Looper æµ‹è¯•</h3><p>Looper æµ‹è¯•ä¸»è¦æ˜¯æµ‹è¯•ä»£ç ä¸­ä½¿ç”¨ handlerå¤„ç†æ¶ˆæ¯äº§ç”Ÿå»¶è¿Ÿçš„æƒ…å†µã€‚å‡å¦‚ä½¿ç”¨ hanler å‘é€ä¸€ä¸ªå»¶æ—¶çš„æ¶ˆæ¯åˆ°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä½†æ˜¯åœ¨æµ‹è¯•ç”¨ä¾‹éªŒè¯çš„è¿‡ç¨‹ä¸­æ¬¡æ¶ˆæ¯ä¸ä¸€å®šè¢«æ‰§è¡Œåˆ°ï¼Œå› æ­¤åç»­çš„éªŒè¯ä¼šäº§ç”Ÿä¸€å®šçš„é”™è¯¯ï¼Œè¿™ç§æƒ…å†µä¸‹éœ€è¦åˆ©ç”¨Looper å•ç‹¬å»æµ‹è¯• handler æ‰€å‘æ¶ˆæ¯çš„é€»è¾‘ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// handle ä»£ç å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">useHandler</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Handler handler = <span class="keyword">new</span> Handler();</span><br><span class="line">    Message message = <span class="keyword">new</span> Message();</span><br><span class="line">    message.what =<span class="number">1</span>;</span><br><span class="line">    handler.postDelayed(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="comment">// do something here;</span></span><br><span class="line">            Log.d(<span class="string">"Looper"</span>, <span class="string">"Looper test."</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, <span class="number">100</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“æµ‹è¯•ä»£ç æ‰§è¡Œ<code>useHandler</code>æ–¹æ³•æ—¶ï¼Œrun å†…éƒ¨çš„é€»è¾‘ä¸ä¼šæ‰§è¡Œï¼ŒLog ä¸ä¼šæ‰“å°ï¼Œå› æ­¤æµ‹è¯•ç”¨ä¾‹ä»£ç éœ€è¦å•ç‹¬è¿è¡Œæ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">looperTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    RobolectricLooperDemo.useHandle();</span><br><span class="line"></span><br><span class="line">    ShadowLooper looper = ShadowLooper.getShadowMainLooper();</span><br><span class="line">    looper.runOneTask();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// verify</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ run æ–¹æ³•å°†ä¼šå¾—åˆ°æ‰§è¡Œã€‚</p><h2 id="è‡ªå®šä¹‰-shadow"><a class="anchor" href="#è‡ªå®šä¹‰-shadow"></a> è‡ªå®šä¹‰ Shadow</h2><p>Shadow ä½œä¸º Robolectric æ¡†æ¶çš„æ ¸å¿ƒæ‰€åœ¨ï¼Œæ˜¯è¯¥æ¡†æ¶çš„é‡ä¸­ä¹‹é‡ã€‚Shadow æ„ä¸ºå½±å­ï¼ŒRobolectric æ¡†æ¶å¯¹ <code>android.jar</code>åŒ…ä¸­å¤§éƒ¨åˆ†ç±»éƒ½åšäº†å½±å­ï¼Œä¾‹å¦‚<code>Activity</code>çš„å½±å­ä¸º<code>ShadowActivity</code>ã€<code>View</code> çš„å½±å­ä¸º<code>ShadowView</code>ã€‚è™½ç„¶ Robolectric åšäº†å¾ˆå¤šå½±å­ï¼Œä½†æ˜¯ä¸ä¸€å®šæ»¡è¶³æˆ‘ä»¬é¡¹ç›®æµ‹è¯•æ‰€éœ€ã€‚Robolectric è¿˜æ”¯æŒè‡ªå®šä¹‰å½±å­ï¼Œå¹¶ç”¨<code>@config</code>æ³¨è§£æŒ‡å®šå³å¯ã€‚</p><p>å‡å¦‚æœ‰ç±»æ–‡ä»¶å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getStr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Demo"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‡ªå®šä¹‰ Shadow çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li>ä»¥<code>@Implements(Demo.class)</code>æ³¨è§£è‡ªå®šä¹‰çš„ Shadow ç±»</li><li>ä¸ºè‡ªå®šä¹‰ Shadow æä¾›äº†ä¸€ä¸ª public çš„æ„é€ å‡½æ•°ï¼›</li><li>å¯¹åŸå§‹ç±»çš„æ–¹æ³•ä»¥<code>@Implementation</code>,å¹¶åšè‡ªå®šä¹‰å®ç°ï¼›</li><li>åœ¨ä½¿ç”¨çš„æµ‹è¯•ç±»æˆ–è€…æµ‹è¯•æ–¹æ³•ä¸Šä»¥<code>@Config(shadows = ShadowDemo.class)</code>;</li></ul><p>æ¥ä¸‹æ¥åœ¨æ‰§è¡Œæœ¬ä½“ç±»æ–¹æ³•çš„æ—¶å€™å°±ä¼šç”± Robolectric æ¡†æ¶è½¬åˆ°æ‰§è¡Œè‡ªå®šä¹‰ Shadow å†…éƒ¨çš„æ–¹æ³•ã€‚å¦å¤–ï¼Œè‡ªå®šä¹‰ Shadow ä¸ä»…å¯ä»¥å®ç°æœ¬ä½“çš„æ–¹æ³•ï¼Œè¿˜å¯ä»¥æ·»åŠ è‡ªå®šä¹‰æ–¹æ³•ä½œä¸ºæœ¬ä½“çš„ä¸€ç§æ‰©å±•ã€‚ä¸Šè¿°ç±»çš„è‡ªå®šä¹‰ Shadow å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Implements</span>(Demo.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShadowDemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ShadowDemo</span><span class="params">()</span></span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Implementation</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getStr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Shadow Demo implementation"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Config</span>(shadows = ShadowDemo.class)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">customShadowTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Demo demo = <span class="keyword">new</span> Demo();</span><br><span class="line">    assertEquals(<span class="string">"Shadow Demo implementation"</span>, demo.getStr());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨çŸ¥é“æœ¬ä½“å¯¹è±¡çš„æƒ…å†µä¸‹ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•å»è·å–å¯¹åº”çš„å½±å­å¯¹è±¡ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Demo demo = <span class="keyword">new</span> Demo();</span><br><span class="line">ShadowDemo shadowDemo = Shadows.shadowOf(demo);</span><br></pre></td></tr></table></figure><h2 id="å°ç»“"><a class="anchor" href="#å°ç»“"></a> å°ç»“</h2><p>Robolectric æ¡†æ¶åœ¨ Android æµ‹è¯•ä¸­æœ‰ç€å¾ˆå¤§çš„ä¾¿åˆ©æ€§ï¼Œå¯ä»¥å¿«é€Ÿç¼–å†™å¹¶è¿è¡Œæµ‹è¯•ç”¨ä¾‹ã€‚åœ¨æˆ‘å†™æµ‹è¯•ç”¨ä¾‹çš„è¿‡ç¨‹ä¸­ï¼ŒRobolectric æ¡†æ¶ç›¸å…³çš„å äº†å¾ˆå¤§çš„æ¯”ä¾‹ã€‚ä¸Šè¿°æ‰€è®²åˆ°çš„åªæ˜¯ Robolectric æ¡†æ¶å¾ˆå°çš„ä¸€éƒ¨åˆ†ï¼Œå…¶å®ƒç”¨æ³•è¿˜éœ€è¦é˜…è¯»æ–‡æ¡£æˆ–è€…çœ‹æºä»£ç è¿›è¡ŒæŒ–æ˜ã€‚</p><p>æœ¬æ–‡æ‰€æœ‰çš„ç¤ºç¤ºä¾‹ä»£ç ï¼š<a href="https://github.com/cherlas/BlogDemo/tree/master/robolectricdemo">Robolectric Demo</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Robolectric æ¡†æ¶æ˜¯ä¸€æ¬¾å¯ä»¥åœ¨JVM ä¸Šè¿è¡Œ Android ç›¸å…³ä»£ç çš„æ¡†æ¶ï¼Œåœ¨ Android å•å…ƒæµ‹è¯•æ€»èµ·åˆ°è‡³å…³é‡è¦çš„ä½œç”¨ã€‚å®ƒæ—¢æœ‰å‡å°‘ç¼–è¯‘ã€æµ‹è¯•ç”¨ä¾‹è¿è¡Œçš„æ—¶é—´ç­‰ä¼˜ç‚¹ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç¨‹åºçŒ¿è¿›åŒ–ä¹‹è·¯" scheme="http://www.istarx.cn/categories/%E7%A8%8B%E5%BA%8F%E7%8C%BF%E8%BF%9B%E5%8C%96%E4%B9%8B%E8%B7%AF/"/>
    
      <category term="è‡ªåŠ¨åŒ–æµ‹è¯•" scheme="http://www.istarx.cn/categories/%E7%A8%8B%E5%BA%8F%E7%8C%BF%E8%BF%9B%E5%8C%96%E4%B9%8B%E8%B7%AF/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="è‡ªåŠ¨åŒ–æµ‹è¯•" scheme="http://www.istarx.cn/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/"/>
    
      <category term="unit-test" scheme="http://www.istarx.cn/tags/unit-test/"/>
    
      <category term="robolectric" scheme="http://www.istarx.cn/tags/robolectric/"/>
    
  </entry>
  
  <entry>
    <title>å•å…ƒæµ‹è¯•ä¹‹â€” PowerMock æ¡†æ¶</title>
    <link href="http://www.istarx.cn/2018/05/02/powermock-framework/"/>
    <id>http://www.istarx.cn/2018/05/02/powermock-framework/</id>
    <published>2018-05-02T13:29:46.000Z</published>
    <updated>2019-02-18T16:56:27.118Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>PowerMock æ¡†æ¶ä¹Ÿæ˜¯å±äº Mock æ¡†æ¶çš„ä¸€ç§ï¼Œå®ƒæ˜¯ä» EasyMock å’Œ Mockito ä¸¤ä¸ªæ¡†æ¶æ‰©å±•è€Œæ¥çš„ï¼Œå…¶æœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯å¯ä»¥ mock æˆ–è€…å±è”½ä¸€äº›ç§æœ‰ã€é™æ€ã€final ç­‰æ–¹æ³•ã€‚</p><a id="more"></a><p><ul class="toc js-fixedContent"><li><a href="#android-%E9%85%8D%E7%BD%AE-powermock">Android é…ç½® PowerMock</a></li><li><a href="#%E5%9F%BA%E6%9C%AC%E6%B3%A8%E9%87%8A">åŸºæœ¬æ³¨é‡Š</a></li><li><a href="#%E6%93%8D%E4%BD%9C%E7%A7%81%E6%9C%89%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95">æ“ä½œç§æœ‰å±æ€§å’Œæ–¹æ³•</a></li><li><a href="#%E5%B1%8F%E8%94%BD%E6%89%A7%E8%A1%8C">å±è”½æ‰§è¡Œ</a></li><li><a href="#mock-%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95">Mock é™æ€æ–¹æ³•</a></li><li><a href="#mock-%E7%A7%81%E6%9C%89%E6%96%B9%E6%B3%95">Mock ç§æœ‰æ–¹æ³•</a></li><li><a href="#mock-%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0">Mock æ„é€ å‡½æ•°</a></li><li><a href="#%E6%80%BB%E7%BB%93">æ€»ç»“</a></li></ul></p><p>PowerMock æ­£å¦‚å®ƒçš„åå­—ä¸€æ ·ï¼Œæ˜¯ä¸€ç§â€œå¼ºå¤§â€çš„ mock æ¡†æ¶ã€‚PowerMock å’Œ Mock ä¸€æ ·ï¼Œä¸»è¦ä¸ºäº†è§£å†³ä»£ç ä¸­éš¾ä»¥æ„å»ºæˆ–è€…éš¾ä»¥æµ‹è¯•éƒ¨åˆ†ï¼Œå®ƒé€šè¿‡åœ¨æµ‹è¯•ç”¨ä¾‹è¿è¡ŒæœŸé—´ä¿®æ”¹å­—èŠ‚ç æ–‡ä»¶å®ç° mockã€stub æˆ–å…¶å®ƒåŠŸèƒ½ã€‚å®ƒæ¶µç›–äº† <code>EasyMock</code>å’Œ<code>Mockito</code>çš„æ‰€æœ‰åŠŸèƒ½ï¼ŒåŒæ—¶å¯¹è¿™ä¸¤ä¸ªæ¡†æ¶è¿›è¡Œäº†æ‰©å±•ï¼Œå¼¥è¡¥äº†è¿™ä¸¤ä¸ªæ¡†æ¶ä¸èƒ½ mock ç§æœ‰ã€é™æ€ã€final æ–¹æ³•åŠå˜é‡ç­‰ç¼ºç‚¹ã€‚</p><p>PowerMock æ¡†æ¶æ”¯æŒ JUnit ä»¥åŠ TestNGï¼ŒåŒæ—¶æ”¯æŒå¤šä¸ªç‰ˆæœ¬çš„ JUnit ç‰ˆæœ¬ï¼Œåˆ†åˆ«ä¸º <code>JUnit 4.4+</code>å’Œ<code>JUnit 4.0~4.3</code>ï¼Œåœ¨ PowerMock 2.0 ç‰ˆæœ¬ä¹‹åï¼ŒJUnit 3 å·²è¢«åºŸé™¤ã€‚</p><h2 id="android-é…ç½®-powermock"><a class="anchor" href="#android-é…ç½®-powermock"></a> Android é…ç½® PowerMock</h2><p>Android Studio ä¸­ä½¿ç”¨ PowerMock æ¡†æ¶éœ€è¦æ·»åŠ å¦‚ä¸‹ä¾èµ–ï¼š</p><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    <span class="comment">// powermock framework</span></span><br><span class="line">    <span class="keyword">def</span> powerMockVersion = <span class="string">'2.0.0-beta.5'</span></span><br><span class="line">    <span class="comment">// powermock junit4</span></span><br><span class="line">    testImplementation <span class="string">"org.powermock:powermock-module-junit4:$&#123;powerMockVersion&#125;"</span></span><br><span class="line">    <span class="comment">// powermock with mockito2</span></span><br><span class="line">    testImplementation <span class="string">"org.powermock:powermock-api-mockito2:$&#123;powerMockVersion&#125;"</span></span><br><span class="line">    <span class="comment">// powermock with easymock</span></span><br><span class="line">    testImplementation <span class="string">"org.powermock:powermock-api-easymock:$&#123;powerMockVersion&#125;"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åŸºæœ¬æ³¨é‡Š"><a class="anchor" href="#åŸºæœ¬æ³¨é‡Š"></a> åŸºæœ¬æ³¨é‡Š</h2><ul><li><p><code>@RunWith(PowerMockRunner.class)</code></p><p>å¦‚æœæµ‹è¯•ç”¨ä¾‹ä½¿ç”¨ PowerMock æ¡†æ¶è¿è¡Œï¼Œåˆ™éœ€è¦åœ¨æµ‹è¯•ç±»å‰æ·»åŠ <code>@RunWith(PowerMockRunner.class)</code>æ³¨é‡Šï¼Œ<code>PowerMockRunner</code>ä¹Ÿå¯ä»¥æ›¿æ¢æˆè‡ªå®šä¹‰çš„ç»§æ‰¿è‡ª<code>PowerMockRunner</code>çš„ Runnerï¼›</p></li><li><p><code>@PrepareForTest({SomeClass.class}, ...)</code></p><p>æ­¤æ³¨é‡Šæ„ä¸ºå‘Šè¯‰ PowerMock å‡†å¤‡ä¸€äº›æµ‹è¯•æ‰€å¿…é¡»çš„ç±»ï¼ŒåŒ…æ‹¬ä¸€äº› final ä¿®é¥°çš„ç±»ï¼ŒåŒ…å«é™æ€æ–¹æ³•æˆ–å˜é‡ã€ç§æœ‰æ–¹æ³•æˆ–å˜é‡ä»¥åŠ native ä¿®é¥°çš„æ–¹æ³•ã€‚</p><p>è¯¥æ³¨é‡Šå¯ä»¥ç”¨æ¥æ³¨é‡ŠæŸä¸€(äº›)æµ‹è¯•ç±»ï¼Œä¹Ÿå¯ä»¥ä¿®é¥°ç‰¹å®šæµ‹è¯•æ–¹æ³•ï¼Œè¿™å–å†³äºä½ æµ‹è¯•ç”¨ä¾‹çš„è®¾è®¡ï¼Œå¦‚æœç”¨æ¥æ³¨é‡Šæµ‹è¯•ç±»ï¼Œåˆ™ PowerMock ä¼šä¸ºè¯¥æµ‹è¯•ç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•å‡†å¤‡æ‰€æŒ‡å®šçš„ç±»ï¼Œå¦‚æœåœ¨æµ‹è¯•ç±»å’Œæµ‹è¯•æ–¹æ³•éƒ½ç”¨<code>PrepareForTest()æ³¨é‡Š</code>ï¼Œåˆ™æµ‹è¯•ç±»æ–¹æ³•çš„æ³¨é‡Šä¼šè¦†ç›–æµ‹è¯•ç±»çš„æ³¨é‡Šã€‚</p></li><li><p><code>@PrepareOnlyThisForTest({SomeClass.class}, ...)</code></p><p>å’Œ<code>PrepareForTest()</code>æ–¹æ³•ç±»ä¼¼ï¼Œä¸¤è€…çš„åŒºåˆ«åœ¨äº<code>PrepareOnlyThisForTest()</code>åªé’ˆå¯¹æŸä¸ªç‰¹å®šçš„ç±»ï¼Œä¸å¯¹ç±»çš„å±‚æ¬¡ç»“æ„è¿›è¡Œæ“ä½œï¼Œä½†æ˜¯<code>PrepareForTest()</code>ä¼šå¯¹æ•´ä¸ªç±»çš„å±‚æ¬¡ç»“æ„è¿›è¡Œæ“ä½œã€‚</p></li><li><p><code>@PrepareEverythingForTest()</code></p><p>æ­¤æ³¨é‡Šæ„ä¸ºå‡†å¤‡é™¤ç‰¹å®šçš„ç³»ç»Ÿå’Œæµ‹è¯•ç›¸å…³ç±»ä»¥å¤–çš„æ‰€æœ‰ç±»ç”¨æ¥æµ‹è¯•ï¼Œä½†æ˜¯åŒæ ·ä¼šåŠ è½½é™æ€åˆå§‹åŒ–å—ã€‚</p></li><li><p><code>@PoweMockIgnore</code></p><p>åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼ŒPowerMock ä¼šä½¿ç”¨<code>MockClassLoader</code>åŠ è½½æ‰€æœ‰çš„ç±»ï¼Œä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ä¸éœ€è¦ä½¿ç”¨ PowerMock çš„ç±»åŠ è½½å™¨åŠ è½½ï¼Œä¾‹å¦‚åœ¨ PowerMock å’Œ Robolectric æ¡†æ¶æ­é…ä½¿ç”¨æ—¶ï¼Œæ­¤æ—¶éœ€è¦ä½¿ç”¨<code>@PowerMockIgnore</code>å¯¹å…¶è¿›è¡Œæ³¨é‡Šï¼Œå…¶å‚æ•°å¯ä»¥æ˜¯æŸä¸€ä¸ªç±»ä¹Ÿå¯ä»¥åŒ…ï¼Œä¾‹å¦‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(PowerMockRunner.class)</span><br><span class="line"><span class="meta">@PowerMockIgnore</span>(&#123;<span class="string">"cc.istarx.MainActivity"</span>,<span class="string">"android.*"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExamplePowerMockTest</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ä½¿ç”¨<code>@PowerMockIgnore</code>æ³¨é‡Šçš„æœ€å¤§çš„ç¼ºç‚¹å°±æ˜¯å¿…é¡»å¯¹æ¯ä¸ªä¸åŒçš„æµ‹è¯•ç±»éƒ½éœ€è¦è¯¥æ³¨é‡Šï¼Œè¿™æ ·å°±é€ æˆäº†ç›¸åŒçš„ä»£ç åœ¨å¾ˆå¤šå¤„éƒ½å­˜åœ¨ï¼Œç»™ç»´æŠ¤å¸¦æ¥å¾ˆå¤§çš„ä¸ä¾¿ã€‚å¯¹äºè¿™ç§æƒ…å†µæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥è§£å†³ï¼š</p><ul><li><p>ç¼–å†™åŸºç±»ï¼Œå¹¶æŠŠå…¬æœ‰çš„ç±»å’ŒåŒ…åœ¨åŸºç±»ä¸­ä½¿ç”¨<code>@PowerMockIgnore</code>æ³¨é‡Šï¼Œå¹¶è®©æ‰€æœ‰çš„æµ‹è¯•ç±»éƒ½ç»§æ‰¿è¯¥åŸºç±»</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(PowerMockRunner.class)</span><br><span class="line"><span class="meta">@PowerMockIgnore</span>(&#123;<span class="string">"cc.istarx.MainActivity"</span>,<span class="string">"android.*"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseClass</span> </span>&#123; </span><br><span class="line">    <span class="comment">// åŸºç±»</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> TestClass1 extends BaseClass &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// do some test here</span></span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åˆ©ç”¨ PowerMock 1.7.0 ç‰ˆæœ¬ä¹‹åå¯ä»¥ä½¿ç”¨é…ç½®æ–‡ä»¶æŒ‡å®šå¿½ç•¥åŠ è½½çš„ç±»å’ŒåŒ…ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">powermock.global-ignore=<span class="string">"cc.istarx.MainActivity"</span> <span class="comment">// å•ä¸ªç±»</span></span><br><span class="line">powermock.global-ignore=<span class="string">"cc.istarx.MainActivity"</span>,<span class="string">"android.*"</span> <span class="comment">// å¤šä¸ªç±»å’ŒåŒ…</span></span><br></pre></td></tr></table></figure><p>æ‰€æœ‰ç”¨æˆ·å®šä¹‰çš„é…ç½®æ–‡ä»¶åœ¨ç›®å½•<code>org/powermock/extensions/configuration.properties</code>ä¸­ã€‚å¦‚æœåœ¨æŸä¸€æµ‹è¯•ç±»ä¸­éœ€è¦å–æ¶ˆè¿™äº›é…ç½®ï¼Œåˆ™åªéœ€å°†<code>globalIgnore</code>å€¼ç½®ä¸º<code>false</code>å³å¯ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(PowerMockRunner.class)</span><br><span class="line"><span class="meta">@PowerMockIgnore</span>(globalIgnore = <span class="keyword">false</span>)</span><br><span class="line"><span class="keyword">public</span> TestClass &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><div class="alert warning"><p>å½“<code>@PrepareForTest</code>ã€<code>@PrepareOnlyThisForTest</code>ã€<code>@PrepareEverythingForTest</code>ã€<code>@PowerMockIgnore</code>æ³¨é‡ŠåŒæ—¶å‡ºç°æ—¶ï¼Œ<code>@PrepareForTest</code>ã€<code>@PrepareOnlyThisForTest</code>ä¼˜å…ˆçº§è¦é«˜äº<code>@PowerMockIgnore</code>ï¼Œä½†æ˜¯ <code>@PrepareEverythingForTest</code>çš„ä¼˜å…ˆçº§è¦ä½äº<code>@PowerMockIgnore</code>ã€‚</p></div></li></ul><h2 id="æ“ä½œç§æœ‰å±æ€§å’Œæ–¹æ³•"><a class="anchor" href="#æ“ä½œç§æœ‰å±æ€§å’Œæ–¹æ³•"></a> æ“ä½œç§æœ‰å±æ€§å’Œæ–¹æ³•</h2><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸ºé™ä½ä»£ç çš„ä¾µå…¥æ€§ï¼Œä¸ä»‹æ„ä¿®æ”¹ç§æœ‰å˜é‡æˆ–è€…æ“ä½œç§æœ‰æ–¹æ³•å’Œæ„é€ å‡½æ•°ã€‚ä½†æ˜¯ä¸ºäº†è¾¾åˆ°æ›´é«˜çš„è¦†ç›–ç‡ï¼Œé˜²æ­¢åé¢ä»£ç é‡æ„ç ´ååŸæœ‰åŠŸèƒ½ï¼Œè¿™ç§æƒ…å†µä¸‹æ“ä½œç§æœ‰å˜é‡ã€æ–¹æ³•ä»¥åŠæ„é€ å‡½æ•°æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚</p><p>PowerMock æä¾›äº†ä¸€ä¸ªç”¨æ¥æ“ä½œç§æœ‰å±æ€§ã€æ–¹æ³•ä»¥åŠæ„å»ºå‡½æ•°ï¼Œè¯¥ç±»ä¸­æä¾›äº†æ“ä½œç§æœ‰å˜é‡ã€æ–¹æ³•ã€æ„é€ å‡½æ•°çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Whitebox.newInstance(Class&lt;T&gt; classToInstantiate); <span class="comment">// ä¸æ‰§è¡Œæ„é€ å‡½æ•°è€Œå®ä¾‹åŒ–</span></span><br><span class="line">Whitebox.ssetInternalState(Object object, Class&lt;?&gt; fieldType, Object value); <span class="comment">// ç§æœ‰å±æ€§çš„èµ‹å€¼</span></span><br><span class="line">Whitebox.invokeConstructor(Class&lt;T&gt; classThatContainsTheConstructorToTest, Class&lt;?&gt;[] parameterTypes, Object[] arguments); <span class="comment">// æ‰§è¡Œç§æœ‰çš„æ„å»ºå‡½æ•°</span></span><br><span class="line">Whitebox.invokeMethod(Class&lt;?&gt; klass, Object... arguments); <span class="comment">// æ‰§è¡Œç§æœ‰æ–¹æ³•</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­å¦‚ä¸‹ï¼š</p><p>è¢«æµ‹è¯•ç±»:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WhiteboxDemo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> WhiteboxDemo demo;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">WhiteboxDemo</span><span class="params">()</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> WhiteboxDemo <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (demo == <span class="keyword">null</span>) &#123;</span><br><span class="line">            demo = <span class="keyword">new</span> WhiteboxDemo();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> demo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> name; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123; <span class="keyword">this</span>.name = name; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„æµ‹è¯•ç”¨ä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">WhiteBoxTest</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    String name = <span class="string">"whitebox"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸æ‰§è¡Œæ„é€ å‡½æ•°è€Œå®ä¾‹åŒ–</span></span><br><span class="line">    WhiteboxDemo demo = Whitebox.newInstance(WhiteboxDemo.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é™æ€ç§æœ‰å±æ€§çš„èµ‹å€¼</span></span><br><span class="line">    Whitebox.setInternalState(WhiteboxDemo.class, <span class="string">"demo"</span>, demo);</span><br><span class="line">    <span class="comment">// éé™æ€ç§æœ‰å±æ€§çš„èµ‹å€¼</span></span><br><span class="line">    Whitebox.setInternalState(demo, <span class="string">"name"</span>, name);</span><br><span class="line">    Field field = Whitebox.getField(WhiteboxDemo.class, <span class="string">"name"</span>);</span><br><span class="line">    assertEquals(name, field.get(demo));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰§è¡Œç§æœ‰çš„æ„å»ºå‡½æ•°</span></span><br><span class="line">    WhiteboxDemo demo1 = Whitebox.invokeConstructor(WhiteboxDemo.class);</span><br><span class="line">    assertNotNull(demo1);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰§è¡Œç§æœ‰æ–¹æ³•</span></span><br><span class="line">    Whitebox.invokeMethod(demo, <span class="string">"setName"</span>,<span class="string">"setName"</span>);</span><br><span class="line">    assertEquals(<span class="string">"setName"</span>, Whitebox.getInternalState(demo, <span class="string">"name"</span>)); <span class="comment">// è·å–ç§æœ‰å˜é‡</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å±è”½æ‰§è¡Œ"><a class="anchor" href="#å±è”½æ‰§è¡Œ"></a> å±è”½æ‰§è¡Œ</h2><p>åœ¨è¢«æµ‹ä»£ç ä¸­ï¼ŒæŸäº›æ–¹æ³•çš„æ‰§è¡Œå¯¹æµ‹è¯•å¸¦æ¥äº†é˜»ç¢ï¼Œæ¯”å¦‚ <code>System.loadLibrary()</code>ç­‰ã€‚ç±»ä¼¼çš„ç³»ç»Ÿæ–¹æ³•å¯ä»¥åˆ©ç”¨ PowerMock æ¡†æ¶å¯ä»¥æ¨¡æ‹Ÿå‡ºæ¥ï¼Œä½†æ˜¯æŸäº›æƒ…å†µä¸‹ï¼Œæ¯”å¦‚æŸä¸ªå˜é‡ã€æ„é€ å‡½æ•°ç­‰ï¼Œä¸èƒ½åˆ©ç”¨æ¨¡æ‹Ÿçš„æ–¹æ³•è§£å†³è¿™ç±»é—®é¢˜ï¼ŒPowerMock æä¾›äº†ä¸€ç§æ–¹æ³•å¯ä»¥ç»•è¿‡è¿™äº›æ–¹æ³•ã€å˜é‡ã€æ„é€ å‡½æ•°çš„æ‰§è¡Œï¼Œæå¤§çš„æé«˜äº†æµ‹è¯•çš„ä¾¿åˆ©æ€§ã€‚</p><p>PowerMock ç”¨æ¥ç»•è¿‡æ‰§è¡Œçš„æ–¹æ³•æ˜¯<code>suppress()</code>ï¼Œè¯¥æ–¹æ³•åœ¨<code>org.powermock.api.support.membermodification.MemberModifier</code>ç±»ä¸­ï¼Œè¯¥æ–¹æ³•çš„å‚æ•°å¯ä»¥æ˜¯ <code>Mehtod</code>ã€<code>Fied</code>ã€<code>constructor</code>ï¼Œå¦‚æœåŒæ—¶ç»•è¿‡å¤šä¸ª<code>Field</code>æˆ–è€…<code>constructor</code>ï¼Œåˆ™å¯ä»¥æ„å»ºä¸€ç»´æ•°ç»„è¿›è¡Œä¼ é€’ã€‚</p><p>ç»•è¿‡æŸä¸ªæ–¹æ³•ã€å˜é‡ã€æ„é€ å‡½æ•°éœ€è¦æ³¨æ„ä¸€ä¸‹å‡ ç‚¹ï¼š</p><ul><li>æµ‹è¯•ç”¨ä¾‹æ‰€åœ¨çš„æµ‹è¯•ç±»å¿…é¡»è¦ä»¥<code>@RunWith(PowerMockRunner.class)</code>è¿›è¡Œæ³¨é‡Šï¼›</li><li>å¦‚æœè¦å±è”½æŸä¸ªç±»çš„é™æ€åˆå§‹åŒ–å—ï¼Œåˆ™éœ€è¦å¯¹å¯¹æµ‹è¯•ç±»æ·»åŠ æ³¨é‡Š<code>@SuppressStaticInitializationFor(class.want.to.suppress.ClassName)</code>;</li><li>å¦‚æœè¦å¯¹æŸä¸ªç±»çš„æ„é€ å‡½æ•°ã€æ–¹æ³•ã€å˜é‡è¿›è¡Œå±è”½ï¼Œåˆ™éœ€è¦åœ¨<code>æµ‹è¯•ç±»</code>ä¹‹å‰æ·»åŠ <code>@PrepareForTest()</code>æ³¨é‡Šï¼›</li></ul><p>ä¾‹å¦‚æœ‰å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SuppressDemo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> String firstName = <span class="string">"test"</span>;</span><br><span class="line">    <span class="keyword">public</span> String secondName;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        id = <span class="number">123</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SuppressDemo</span><span class="params">(String secondName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.secondName = secondName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSecondName</span> <span class="params">(String secondName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.secondName = secondName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">updateSecondName</span> <span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        setSecondName(name);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.secondName;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„æµ‹è¯•ç”¨ä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(PowerMockRunner.class)</span><br><span class="line"><span class="comment">// å±è”½é™æ€åˆå§‹åŒ–å—</span></span><br><span class="line"><span class="meta">@SuppressStaticInitializationFor</span>(<span class="string">"cc.istarx.powermockdemo.SuppressDemo"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExampleTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">suppressTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// å±è”½æ–¹æ³•çš„æ‰§è¡Œ</span></span><br><span class="line">        suppress(method(SuppressDemo.class,<span class="string">"setSecondName"</span>, String.class));</span><br><span class="line">        <span class="comment">// å±è”½æ„é€ å‡½æ•°ï¼Œ</span></span><br><span class="line">        suppress(constructor(SuppressDemo.class,String.class));</span><br><span class="line">        <span class="comment">// å±è”½å˜é‡</span></span><br><span class="line">        suppress(field(SuppressDemo.class,<span class="string">"firstName"</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å±è”½æ„é€ å‡½æ•°ä¹‹åå¯ä»¥åˆ©ç”¨ WhiteBox.newInstance() æ–¹æ³•å®ä¾‹åŒ–å‚æ•°</span></span><br><span class="line">        SuppressDemo demo = Whitebox.newInstance(SuppressDemo.class);</span><br><span class="line">        <span class="comment">// firstName å˜é‡è¢«å±è”½ï¼Œä¸‹é¢è¿™å¥æ–­è¨€ä½çœŸ</span></span><br><span class="line">        assertNull(demo.getFirstName());</span><br><span class="line">        <span class="comment">// é™æ€åˆå§‹åŒ–å—è¢«å±è”½ï¼Œä¸‹é¢è¿™å¥æ–­è¨€ä½çœŸ</span></span><br><span class="line">        assertEquals(<span class="number">0</span>, SuppressDemo.id);</span><br><span class="line">        <span class="comment">// å¯¹è±¡æˆå‘˜å˜é‡éƒ½æ˜¯é»˜è®¤å€¼</span></span><br><span class="line">        assertNull(demo.secondName);</span><br><span class="line">        <span class="comment">// ç”±äº setSecondName() æ–¹æ³•è¢«å±è”½ï¼Œæ‰€ä»¥ secondName ä¸ä¼šè¢«æ›´æ–°</span></span><br><span class="line">        assertNull(demo.updateSecondName(<span class="string">"suppress"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="mock-é™æ€æ–¹æ³•"><a class="anchor" href="#mock-é™æ€æ–¹æ³•"></a> Mock é™æ€æ–¹æ³•</h2><p>åœ¨å®é™…é¡¹ç›®æµ‹è¯•ä¸­ï¼Œè¢«æµ‹ä»£ç ä¸­éš¾å…ä¼šæœ‰é™æ€æ–¹æ³•ï¼Œç»™æµ‹è¯•å¸¦æ¥äº†ä¸€å®šçš„éš¾åº¦ã€‚PowerMock æ¯” Mockito æ¡†æ¶å¥½çš„åœ°æ–¹å°±æ˜¯å¯ä»¥å¯¹é™æ€ã€ç§æœ‰ã€finalç±»å‹çš„æ–¹æ³•ç­‰è¿›è¡Œæ¨¡æ‹Ÿã€‚PoweMock åœ¨æ¨¡æ‹Ÿä¸€ä¸ªé™æ€æ–¹æ³•æ—¶æœ‰ä¸€å¥—å›ºå®šçš„æµç¨‹ï¼Œä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š</p><ul><li><p>ä»¥<code>@RunWith(PowerMockRunner.class)</code>å¯¹æµ‹è¯•ç±»è¿›è¡Œæ³¨é‡Šï¼›</p></li><li><p>å¯¹åŒ…å«é™æ€æ–¹æ³•çš„ç±»ä»¥<code>@PrepareForTest()</code>æ³¨é‡Šï¼Œæ‰€å‡†å¤‡çš„ç±»ä¸ºåŒ…å«é™æ€æ–¹æ³•çš„ç±»ï¼Œæ¬¡æ³¨é‡Šå¯ä»¥æ˜¯ç±»çº§åˆ«ä¹Ÿå¯ä»¥æ˜¯æµ‹è¯•æ–¹æ³•çº§åˆ«ï¼›</p></li><li><p>åœ¨æµ‹è¯•ç”¨ä¾‹ä¸­çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">PowerMock.mockStatic(WithStaticMethod.class);</span><br><span class="line">when(WithStaticMethod.getNum()).thenReturn(<span class="number">11</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰§è¡Œé™æ€æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">PowerMockito.verifyStatic(WithStaticMethod.class);</span><br><span class="line">WithStaticMethod.getNum();</span><br></pre></td></tr></table></figure></li><li><p>åœ¨<code>verify</code>çš„æ—¶å€™åŒæ ·å¯ä»¥è¿›è¡Œå‚æ•°åŒ¹é…æˆ–è€…æ¬¡æ•°éªŒè¯:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">PowerMockito.verifyStatic(WithStaticMethod.class, times(<span class="number">1</span>));</span><br><span class="line">WithStaticMethod.getNumWithNum(anyInt());</span><br></pre></td></tr></table></figure><div class="alert warning"><p>å¿…é¡»åœ¨æ¯ä¸ªé™æ€æ–¹æ³•çš„éªŒè¯ä¹‹å‰è°ƒç”¨<code>PowerMockito.verifyStatic(Static.class)</code></p></div></li></ul><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¢«æµ‹è¯•ä»£ç </span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WithStaticMethod</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getNum</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">999</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getNumWithNum</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> num;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æµ‹è¯•ç”¨ä¾‹ä»£ç </span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@PrepareForTest</span>(WithStaticMethod.class)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mockStaticMethodTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    PowerMockito.mockStatic(WithStaticMethod.class);</span><br><span class="line">    when(WithStaticMethod.getNum()).thenReturn(<span class="number">11</span>);</span><br><span class="line">    when(WithStaticMethod.getNumWithNum(<span class="number">9</span>)).thenReturn(<span class="number">19</span>);</span><br><span class="line"></span><br><span class="line">    assertEquals(<span class="number">11</span>, WithStaticMethod.getNum());</span><br><span class="line">    assertEquals(<span class="number">19</span>, WithStaticMethod.getNumWithNum(<span class="number">9</span>));</span><br><span class="line"></span><br><span class="line">    PowerMockito.verifyStatic(WithStaticMethod.class, times(<span class="number">1</span>));</span><br><span class="line">    WithStaticMethod.getNum();</span><br><span class="line">    PowerMockito.verifyStatic(WithStaticMethod.class, atLeast(<span class="number">1</span>));</span><br><span class="line">    WithStaticMethod.getNumWithNum(eq(<span class="number">9</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="mock-ç§æœ‰æ–¹æ³•"><a class="anchor" href="#mock-ç§æœ‰æ–¹æ³•"></a> Mock ç§æœ‰æ–¹æ³•</h2><p>PowerMock æä¾›äº†éªŒè¯ç§æœ‰æ–¹æ³•çš„æ–¹æ³•<code>verifyPrivate(tested).invoke(&quot;privateMethodName&quot;, argument1)</code>ï¼Œä¾‹å¦‚ï¼š</p><p>å¾…æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VerifyPrivateAndConstructor</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">privateMethod</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> str;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getStr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> privateMethod(<span class="string">"test"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ç”¨ä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">verifyPrivateMethod</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    VerifyPrivateAndConstructor pr = mock(VerifyPrivateAndConstructor.class);</span><br><span class="line"></span><br><span class="line">    when(pr.getStr()).thenCallRealMethod();</span><br><span class="line">    pr.getStr();</span><br><span class="line"></span><br><span class="line">    PowerMockito.verifyPrivate(pr, times(<span class="number">1</span>)).invoke(<span class="string">"privateMethod"</span>, <span class="string">"test"</span>);</span><br><span class="line">    pr.getStr();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="mock-æ„é€ å‡½æ•°"><a class="anchor" href="#mock-æ„é€ å‡½æ•°"></a> Mock æ„é€ å‡½æ•°</h2><p>Mock æ„é€ å‡½æ•°æ—¶å¿…é¡»ç”¨<code>@PrepareForTest(XXX.class)</code>å¯¹æµ‹è¯•æ–¹æ³•æˆ–è€…ç±»è¿›è¡Œæ³¨é‡Šï¼Œå¹¶ç”¨<code>PowerMock.whenNew()</code>å¯¹æ„é€ å‡½æ•°è¿›è¡Œ mockï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span>(expected = IllegalArgumentException.class)</span><br><span class="line"><span class="meta">@PrepareForTest</span>(VerifyPrivateAndConstructor.class)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mockConstructorTest</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    whenNew(VerifyPrivateAndConstructor.class).withAnyArguments().thenThrow(<span class="keyword">new</span> IllegalArgumentException(<span class="string">"error message"</span>));</span><br><span class="line">    <span class="keyword">new</span> VerifyPrivateAndConstructor(<span class="string">"test"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a class="anchor" href="#æ€»ç»“"></a> æ€»ç»“</h2><p>PowerMock æ­£å¦‚å…¶åï¼Œç¡®å®å¾ˆå¼ºå¤§ï¼Œå¯ä»¥è§£å†³ä¸€äº›æµ‹è¯•ä¸­å¾ˆéš¾æµ‹è¯•çš„ç‚¹æˆ–è€…å’Œæ¡†æ¶ã€ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„åœ°æ–¹ï¼Œç»™æµ‹è¯•å¸¦æ¥äº†æå¤§çš„ä¾¿åˆ©æ€§ã€‚PowerMock ä¹Ÿå¯ä»¥å’Œå…¶å®ƒæ¡†æ¶è¿›è¡Œé…åˆä½¿ç”¨ï¼Œæ¯”å¦‚ Robolectricï¼Œå…³äº Robolectric åç»­ä¼šæœ‰ä¸“é—¨çš„ä»‹ç»ã€‚</p><p>è°¢è°¢é˜…è¯»ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ©ã€‚</p><p>æœ¬æ–‡ç¤ºä¾‹ä»£ç ï¼š<a href="https://github.com/cherlas/BlogDemo/tree/master/powermockdemo">PowerMock Demo</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;PowerMock æ¡†æ¶ä¹Ÿæ˜¯å±äº Mock æ¡†æ¶çš„ä¸€ç§ï¼Œå®ƒæ˜¯ä» EasyMock å’Œ Mockito ä¸¤ä¸ªæ¡†æ¶æ‰©å±•è€Œæ¥çš„ï¼Œå…¶æœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯å¯ä»¥ mock æˆ–è€…å±è”½ä¸€äº›ç§æœ‰ã€é™æ€ã€final ç­‰æ–¹æ³•ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç¨‹åºçŒ¿è¿›åŒ–ä¹‹è·¯" scheme="http://www.istarx.cn/categories/%E7%A8%8B%E5%BA%8F%E7%8C%BF%E8%BF%9B%E5%8C%96%E4%B9%8B%E8%B7%AF/"/>
    
      <category term="è‡ªåŠ¨åŒ–æµ‹è¯•" scheme="http://www.istarx.cn/categories/%E7%A8%8B%E5%BA%8F%E7%8C%BF%E8%BF%9B%E5%8C%96%E4%B9%8B%E8%B7%AF/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="è‡ªåŠ¨åŒ–æµ‹è¯•" scheme="http://www.istarx.cn/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/"/>
    
      <category term="unit-test" scheme="http://www.istarx.cn/tags/unit-test/"/>
    
      <category term="Mock" scheme="http://www.istarx.cn/tags/Mock/"/>
    
      <category term="PowerMock" scheme="http://www.istarx.cn/tags/PowerMock/"/>
    
  </entry>
  
  <entry>
    <title>å•å…ƒæµ‹è¯•ä¹‹â€” Mockito æ¡†æ¶</title>
    <link href="http://www.istarx.cn/2018/04/29/mockito-framework/"/>
    <id>http://www.istarx.cn/2018/04/29/mockito-framework/</id>
    <published>2018-04-29T13:26:25.000Z</published>
    <updated>2019-02-18T16:56:34.971Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>Mock æ„ä¸ºæ¨¡æ‹Ÿï¼ŒæŒ‡æ¨¡æ‹Ÿä¸€ä¸ªä»£ç æ‰€ä¾èµ–çš„æ¡†æ¶ã€ç¬¬ä¸‰æ–¹ä»£ç æˆ–è€…æ„å»ºèµ·æ¥è¾ƒä¸ºå¤æ‚çš„å¯¹è±¡ï¼Œå°†è¢«æµ‹è¯•çš„ä»£ç å’Œå…¶å®ƒä»£ç éš”ç¦»å¼€æ¥ï¼Œè€Œ Mockito æ¡†æ¶æ˜¯ä¸€æ¬¾æµè¡Œçš„ Mock æ¡†æ¶ã€‚</p><a id="more"></a><p><ul class="toc js-fixedContent"><li><a href="#mock%E7%AE%80%E4%BB%8B">Mockç®€ä»‹</a></li><li><a href="#android-studio-%E4%B8%AD%E9%85%8D%E7%BD%AE-mockito">Android Studio ä¸­é…ç½® Mockito</a></li><li><a href="#mockito-%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95">Mockito åŸºæœ¬ç”¨æ³•</a><ul><li><a href="#mock-%E4%B8%80%E4%B8%AA%E5%AF%B9%E8%B1%A1">Mock ä¸€ä¸ªå¯¹è±¡</a></li><li><a href="#serializable-mocks">Serializable Mocks</a><ul><li><a href="#%E9%87%8D%E7%BD%AE-mock">é‡ç½® Mock</a></li></ul></li><li><a href="#%E5%8F%82%E6%95%B0%E5%8C%B9%E9%85%8D">å‚æ•°åŒ¹é…</a></li><li><a href="#%E5%8F%82%E6%95%B0%E6%8D%95%E6%8D%89">å‚æ•°æ•æ‰</a></li><li><a href="#stub-%E6%8F%92%E6%A1%A9">Stub æ’æ¡©</a><ul><li><a href="#%E5%85%A8%E9%83%A8%E6%A8%A1%E6%8B%9Fmock-%E5%92%8C%E9%83%A8%E5%88%86%E6%A8%A1%E6%8B%9Fspy-%E8%BF%9B%E8%A1%8C-stub">å…¨éƒ¨æ¨¡æ‹Ÿ(Mock) å’Œéƒ¨åˆ†æ¨¡æ‹Ÿ(Spy) è¿›è¡Œ Stub</a></li><li><a href="#%E5%AF%B9-void-%E6%96%B9%E6%B3%95%E8%BF%9B%E8%A1%8C-stub">å¯¹ void æ–¹æ³•è¿›è¡Œ stub</a></li><li><a href="#%E5%AF%B9%E5%90%8C%E4%B8%80%E4%B8%AA%E6%96%B9%E6%B3%95%E8%BF%9B%E8%A1%8C%E8%BF%9E%E7%BB%AD-stub">å¯¹åŒä¸€ä¸ªæ–¹æ³•è¿›è¡Œè¿ç»­ stub</a></li><li><a href="#%E4%B8%BA%E6%9C%AA%E8%BF%9B%E8%A1%8C-stub-%E7%9A%84%E6%96%B9%E6%B3%95%E8%AE%BE%E7%BD%AE%E9%BB%98%E8%AE%A4%E8%BF%94%E5%9B%9E%E5%80%BC">ä¸ºæœªè¿›è¡Œ stub çš„æ–¹æ³•è®¾ç½®é»˜è®¤è¿”å›å€¼</a></li></ul></li><li><a href="#%E9%AA%8C%E8%AF%81-verify">éªŒè¯ verify</a><ul><li><a href="#%E8%A1%8C%E4%B8%BA%E9%AA%8C%E8%AF%81">è¡Œä¸ºéªŒè¯</a></li><li><a href="#%E8%B0%83%E7%94%A8%E6%AC%A1%E6%95%B0%E9%AA%8C%E8%AF%81">è°ƒç”¨æ¬¡æ•°éªŒè¯</a></li><li><a href="#%E8%B0%83%E7%94%A8%E6%AC%A1%E5%BA%8F%E9%AA%8C%E8%AF%81">è°ƒç”¨æ¬¡åºéªŒè¯</a></li><li><a href="#%E9%AA%8C%E8%AF%81-mock-%E5%AF%B9%E8%B1%A1%E6%98%AF%E5%90%A6%E4%BA%A4%E4%BA%92">éªŒè¯ mock å¯¹è±¡æ˜¯å¦äº¤äº’</a></li><li><a href="#%E6%9F%A5%E6%89%BE%E6%98%AF%E5%90%A6%E6%9C%89%E6%9C%AA%E9%AA%8C%E8%AF%81%E7%9A%84%E4%BA%A4%E4%BA%92">æŸ¥æ‰¾æ˜¯å¦æœ‰æœªéªŒè¯çš„äº¤äº’</a></li><li><a href="#%E8%B6%85%E6%97%B6%E9%AA%8C%E8%AF%81">è¶…æ—¶éªŒè¯</a></li></ul></li></ul></li></ul></p><h2 id="mockç®€ä»‹"><a class="anchor" href="#mockç®€ä»‹"></a> Mockç®€ä»‹</h2><p>å½“æˆ‘ä»¬æ‰€å†™çš„ä»£ç ç›¸å¯¹ç®€å•æ—¶ï¼Œè¢«æµ‹è¯•ä»£ç ä¸ä¼šæˆ–è€…å¾ˆå°‘ä¾èµ–å…¶å®ƒçš„ç±»å’Œä»£ç ï¼Œä½†æ˜¯å½“ä»£ç è¾ƒä¸ºå¤æ‚æ—¶ï¼Œè¢«æµ‹è¯•ä»£ç å…ä¸äº†äºç³»ç»Ÿä¸­å…¶å®ƒçš„éƒ¨åˆ†è¿›è¡Œäº¤äº’ï¼Œè¿™ç»™æµ‹è¯•å¸¦æ¥å¾ˆå¤§çš„ä¸ä¾¿ã€‚è¿˜æœ‰å¦å¤–ä¸€ç§æƒ…å†µï¼Œåœ¨æµ‹è¯•å»ºç«‹åˆå§‹æ¡ä»¶æ—¶ï¼Œå¯¹äºä¸€äº›æ„å»ºæ¯”è¾ƒå¤æ‚éš¾ä»¥æ„å»ºçš„å¯¹è±¡ï¼ŒåŒæ ·ç»™æµ‹è¯•å¸¦æ¥ä¸€å®šå›°éš¾ã€‚æ­¤æ—¶ Mock æ¡†æ¶å°±æ˜¾ç¤ºå‡ºäº†å…¶ä½œç”¨æ‰€åœ¨ã€‚</p><p>å•å…ƒæµ‹è¯•çš„ç›®çš„æ˜¯æŠŠè¢«æµ‹è¯•ä»£ç å’Œå…¶å®ƒéƒ¨åˆ†ç›¸éš”ç¦»ï¼Œå½“æˆä¸€ä¸ªç‹¬ç«‹çš„å•å…ƒæ¥è¿›è¡Œæµ‹è¯•ï¼Œè¿™æ ·å¯ä»¥è®©ä½ æ— è§†è¢«æµ‹è¯•å•å…ƒæ‰€ä¾èµ–éƒ¨åˆ†è¿è¡Œçš„å‡†ç¡®æ€§ï¼Œä»è€Œè¾¾åˆ°å‡†ç¡®æµ‹è¯•çš„ç›®çš„ã€‚</p><p><a href="https://github.com/mockito/mockito">Mockito</a> æ¡†æ¶æ˜¯ä¸€æ¬¾æ¯”è¾ƒæµè¡Œçš„ Mock æ¡†æ¶ï¼Œå½“å‰æœ€æ–°ç‰ˆæ˜¯ 2.18.5ï¼Œä½†æ˜¯ gradle æ’ä»¶åœ¨ maven ä»“åº“ä¸­åªèƒ½ä¸‹è½½åˆ°2.18.3 ç‰ˆæœ¬ã€‚å…¶ä¸ä»…å¯ä»¥ç”¨äº java å·¥ç¨‹ï¼Œè¿˜å¯ä»¥æ­é… <code>dexmaker</code> ç”¨äºAndroid é¡¹ç›®ä¸­ã€‚ç±»ä¼¼çš„æ¡†æ¶è¿˜æœ‰ EasyMockã€PowerMock ç­‰ã€‚</p><h2 id="android-studio-ä¸­é…ç½®-mockito"><a class="anchor" href="#android-studio-ä¸­é…ç½®-mockito"></a> Android Studio ä¸­é…ç½® Mockito</h2><p>åœ¨ Mockito 2.6.1ç‰ˆæœ¬å¼€å§‹ï¼ŒMockito å›¢é˜Ÿä¸“é—¨ä¸º Android åšäº†ç›¸å…³æ”¯æŒï¼Œä¸ºäº†åœ¨ Android Test æµ‹è¯•ä¸­ä½¿ç”¨ Mockitoï¼Œéœ€è¦å¼•å…¥ä»¥ä¸‹ä¾èµ–ï¼š</p><figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">repositories</span> &#123;</span><br><span class="line">jcenter() <span class="comment">// æˆ–è€… mavenCenter(), aliyunä»“åº“ç­‰</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">...</span><br><span class="line">testCompile <span class="string">'org.mockito:mockito-core:2.18.5'</span></span><br><span class="line">androidTestCompile <span class="string">'org.mockito:mockito-android:2.18.5'</span> <span class="comment">// ä¸èƒ½å’Œ inline mock maker ä¸€èµ·ä½¿ç”¨</span></span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>mockito-android:</code>ä¾èµ–ä¸­å·²ç»åŒ…å«äº†<code>mockito-core</code>ï¼Œæ‰€ä»¥ä¸éœ€è¦å•ç‹¬æ·»åŠ è¯¥ä¾èµ–ã€‚</p><h2 id="mockito-åŸºæœ¬ç”¨æ³•"><a class="anchor" href="#mockito-åŸºæœ¬ç”¨æ³•"></a> Mockito åŸºæœ¬ç”¨æ³•</h2><p>Mockito æ¡†æ¶æœ‰å®˜æ–¹è¯¦ç»†çš„è¯´æ˜æ–‡æ¡£ï¼Œåœ°å€ä¸º <a href="http://site.mockito.org/mockito/docs/current/org/mockito/Mockito.html">http://site.mockito.org/mockito/docs/current/org/mockito/Mockito.html</a></p><h3 id="mock-ä¸€ä¸ªå¯¹è±¡"><a class="anchor" href="#mock-ä¸€ä¸ªå¯¹è±¡"></a> Mock ä¸€ä¸ªå¯¹è±¡</h3><p>å‡è®¾æœ‰å¦‚ä¸‹ä¸€ä¸ªç±»ä»¥åŠä¸€ä¸ªæ¥å£ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentDatabaseHelper</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">queryStudentWithId</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateNewScoreWithId</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> score)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>ä½¿ç”¨<code>mock</code>æ–¹æ³•ï¼š</p><p><code>mock()</code>æ–¹æ³•æ˜¯æœ€åŸºæœ¬çš„ mock ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ï¼Œæ— è®ºæ˜¯ç±»ã€æ¥å£éƒ½å¯ä»¥è¿›è¡Œæ¨¡æ‹Ÿï¼Œå…·ä½“ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Student student = mock(Student.class);</span><br><span class="line">StudentDatabaseHelper databaseHelper = mock(StudentDatabaseHelper.class);</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨<code>@Mock</code>æ³¨é‡Šï¼š</p><p>ä½¿ç”¨<code>@Mock</code>æ³¨é‡Šæœ‰ä»¥ä¸‹å‡ ä¸ªæœ‰ç‚¹ï¼š</p><ul><li>å‡å°‘ä»£ç é‡ï¼›</li><li>å¢åŠ ä»£ç çš„å¯è¯»æ€§ï¼›</li><li>è®©verifyå‡ºé”™ä¿¡æ¯æ›´æ˜“è¯»ï¼Œå› ä¸ºå˜é‡åå¯ç”¨æ¥æè¿°æ ‡è®°mockå¯¹è±¡ï¼›</li></ul><p>å…·ä½“ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Mock</span> <span class="keyword">private</span> Student student;</span><br><span class="line"><span class="meta">@Mock</span> <span class="keyword">private</span> StudentDatabaseHelper databaseHelper;</span><br><span class="line">...</span><br><span class="line"><span class="meta">@Before</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">MockitoAnnotations.initMocks(<span class="keyword">this</span>);  <span class="comment">// å¾ˆé‡è¦ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨åŸºç±»æˆ–è€… Runner ä¸­</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨<code>Spy</code>æ–¹æ³•æˆ–è€…<code>@Spy</code>æ³¨é‡Šï¼š</p><p><code>Spy</code>å’Œ<code>Mock</code>çš„ä¸»è¦åŒºåˆ«åœ¨äº<code>Mock</code>æ¨¡æ‹Ÿçš„å¯¹è±¡æ˜¯å…¨éƒ¨æ¨¡æ‹Ÿï¼Œå¿…é¡»æ˜¾å¼çš„å¯¹ç±»æˆ–æ¥å£ä¸­çš„æ–¹æ³•è¿›è¡Œ stubï¼›è€Œ <code>Spy</code>åˆ™æ˜¯éƒ¨åˆ†æ¨¡æ‹Ÿï¼Œå…¶å¯¹æ˜¾å¼ stub çš„æ–¹æ³•æ‰§è¡Œ stub ç»“æœï¼Œä½†æ˜¯å¯¹æ²¡æœ‰æ˜¾å¼ stub çš„æ–¹æ³•åˆ™æ‰§è¡ŒåŸæ–¹æ³•ã€‚ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Spy</span> Student student = <span class="keyword">new</span> Student(); </span><br><span class="line"><span class="comment">//ä¸Šé¢çš„æ¨¡æ‹Ÿæ–¹æ³•å¯ä»¥ç®€å†™æˆ</span></span><br><span class="line"><span class="meta">@Spy</span> Student student; <span class="comment">// Mockito ä¼šè‡ªåŠ¨å®ä¾‹åŒ–</span></span><br><span class="line"><span class="comment">// ä»¥ä¸‹æ˜¯ç”¨ spy æ–¹æ³•æ¨¡æ‹Ÿ</span></span><br><span class="line">Student student = <span class="keyword">new</span> Student();</span><br><span class="line">Student spyStudent = spy(student);</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨<code>@InjectMocks</code>æ³¨é‡Šï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@InjectMocks</span> Student; <span class="comment">// Mockito ä¼šè‡ªåŠ¨å®ä¾‹åŒ–è¯¥ç±»</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="serializable-mocks"><a class="anchor" href="#serializable-mocks"></a> Serializable Mocks</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">serializableMockTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Student student = mock(Student.class, withSettings().serializable());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="é‡ç½®-mock"><a class="anchor" href="#é‡ç½®-mock"></a> é‡ç½® Mock</h4><p>å®˜æ–¹æ–‡æ¡£ä¸­æç¤ºä¸è¦åœ¨æµ‹è¯•ç”¨ä¾‹è¿›è¡Œè¿‡ç¨‹ä¸­ä½¿ç”¨é‡ç½® Mockã€‚é‡ç½® Mock ä½¿ç”¨ <code>reset()</code>æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">resetMockTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Student student = mock(Student.class);</span><br><span class="line">    doNothing().when(student).setScore(<span class="number">99</span>);</span><br><span class="line">    student.setScore(<span class="number">99</span>);</span><br><span class="line">    reset(student);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‚æ•°åŒ¹é…"><a class="anchor" href="#å‚æ•°åŒ¹é…"></a> å‚æ•°åŒ¹é…</h3><p>å½“å¯¹æ–¹æ³•è¿›è¡Œæ’æ¡©æˆ–è€…è¿›è¡ŒéªŒè¯æ—¶ï¼Œå¯ä»¥é…åˆ Harmcrest åŒ¹é…å™¨è¿›è¡Œå‚æ•°åŒ¹é…ï¼ŒMockito æ¡†æ¶é›†æˆäº†åŒ¹é…å™¨ï¼Œå¹¶å¯¹å…¶è¿›è¡Œäº†ä¸€å®šçš„æ‰©å±•ï¼Œå› æ­¤å¯ä»¥ç›´æ¥è¿›è¡Œä½¿ç”¨ï¼Œä¸éœ€è¦æ·»åŠ ä¾èµ–ã€‚</p><p>Mockito æ¡†æ¶å¯¹åŒ¹é…å™¨æ‰€åšçš„æ‰©å±•çš„ç±»ä¸º<code>MockitoHamcrest</code>ï¼Œå…¶å†…éƒ¨æ–¹æ³•éƒ½æ˜¯ä»¥å¦‚ä¸‹å½¢å¼å‘½åçš„ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> xxx <span class="title">xxxThat</span><span class="params">(Matcher&lt;xxx&gt; matcher)</span></span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­çš„<code>xxx</code>å¯ä»¥ä¸º<code>arg</code>ã€<code>boolean</code>ã€<code>byte</code>ã€<code>char</code>ä»¥åŠåŸºç¡€æ•°æ®ç±»å‹ï¼Œä¸€ä½å¯¹æŸä¸€ç±»å‹çš„å‚æ•°è¿›è¡ŒåŒ¹é…ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">argMatcherTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ArrayList&lt;String&gt; mockList = mock(ArrayList.class);</span><br><span class="line"></span><br><span class="line">    when(mockList.get(anyInt())).thenReturn(<span class="string">"arg matcher0"</span>);</span><br><span class="line">    assertEquals(<span class="string">"arg matcher0"</span>, mockList.get(<span class="number">0</span>));</span><br><span class="line">    assertEquals(<span class="string">"arg matcher0"</span>, mockList.get(<span class="number">4</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯ä»¥å†™ lambda è¡¨è¾¾å¼</span></span><br><span class="line">    when(mockList.get(intThat(i -&gt; i &gt; <span class="number">5</span>))).thenReturn(<span class="string">"big than 5"</span>);</span><br><span class="line">    assertEquals(<span class="string">"big than 5"</span>, mockList.get(<span class="number">999</span>));</span><br><span class="line"></span><br><span class="line">    when(mockList.indexOf(argThat((String str) -&gt; str.length() &gt; <span class="number">5</span>))).thenReturn(<span class="number">5</span>);</span><br><span class="line">    assertEquals(<span class="number">5</span>, mockList.indexOf(<span class="string">"arg matcher test"</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é™¤äº†ä»¥ä¸ŠåŒ¹é…å™¨ä»¥å¤–ï¼Œè¿˜å¯ä»¥è‡ªå®šä¹‰åŒ¹é…å™¨ï¼Œå…·ä½“è¯·æŸ¥çœ‹ <a href="http://www.istarx.cc/2018/02/11/hamcrest-matcher/">Harmcrest è‡ªå®šä¹‰åŒ¹é…å™¨</a> æ–‡ç« ã€‚</p><div class="alert warning"><p>å¦‚æœåœ¨ stub æˆ–è€… éªŒè¯çš„è¿‡ç¨‹ä¸­å¯¹æŸä¸ªæ–¹æ³•ä½¿ç”¨äº†å‚æ•°åŒ¹é…ï¼Œåˆ™æ‰€æœ‰çš„å‚æ•°éƒ½å¿…é¡»ä½¿ç”¨å‚æ•°åŒ¹é…ï¼Œå¯¹äºç¡®å®šçš„å€¼éœ€è¦ä½¿ç”¨<code>eq()</code>åŒ¹é…å™¨ã€‚</p></div><h3 id="å‚æ•°æ•æ‰"><a class="anchor" href="#å‚æ•°æ•æ‰"></a> å‚æ•°æ•æ‰</h3><p>å‚æ•°æ•æ‰æŒ‡å¯¹æŸä¸€æ–¹æ³•çš„å‚æ•°è¿›è¡Œæ•æ‰ï¼Œå¹¶å¯¹å…¶è¿›è¡ŒéªŒè¯ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">argumentCaptureTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Student student = mock(Student.class);</span><br><span class="line">    <span class="comment">// å®ä¾‹åŒ– ArgumentCaptor å¯¹è±¡</span></span><br><span class="line">    ArgumentCaptor&lt;Integer&gt; captor = ArgumentCaptor.forClass(Integer.class);</span><br><span class="line"></span><br><span class="line">    student.setScore(<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å…ˆéªŒè¯å†æ•æ‰å‚æ•°</span></span><br><span class="line">    verify(student).setScore(captor.capture());</span><br><span class="line">    assertEquals(<span class="number">100</span>, (<span class="keyword">int</span>)captor.getValue());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="stub-æ’æ¡©"><a class="anchor" href="#stub-æ’æ¡©"></a> Stub æ’æ¡©</h3><p>å¯¹æ¨¡æ‹Ÿçš„å¯¹è±¡è¿›è¡Œæ’æ¡©ä¸»è¦ä½¿ç”¨æ–¹æ³•<code>when</code>ï¼Œé…åˆ<code>thenReturn</code>ã€<code>doThrow</code>ç­‰æ–¹æ³•å®Œæˆã€‚å¯¹æ–¹æ³•è¿›è¡Œ stub æ˜¯ Mock æ¡†æ¶çš„æ ¸å¿ƒæ‰€åœ¨ã€‚</p><h4 id="å…¨éƒ¨æ¨¡æ‹Ÿmock-å’Œéƒ¨åˆ†æ¨¡æ‹Ÿspy-è¿›è¡Œ-stub"><a class="anchor" href="#å…¨éƒ¨æ¨¡æ‹Ÿmock-å’Œéƒ¨åˆ†æ¨¡æ‹Ÿspy-è¿›è¡Œ-stub"></a> å…¨éƒ¨æ¨¡æ‹Ÿ(Mock) å’Œéƒ¨åˆ†æ¨¡æ‹Ÿ(Spy) è¿›è¡Œ Stub</h4><p>ç”±äºæ¨¡æ‹Ÿä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™å¯ä»¥å…¨éƒ¨æ¨¡æ‹Ÿ(å³ Mock)ï¼Œä¹Ÿå¯ä»¥éƒ¨åˆ†æ¨¡æ‹Ÿ(å³Spy)ï¼Œä¸¤è€…ç¨å¾®æœ‰æ‰€åŒºåˆ«ã€‚ä¸‹é¢æ˜¯ä»¥ ArraryList è¿›è¡Œç®€å•çš„ä¸¾ä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span>(expected = IndexOutOfBoundsException.class)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stubbingTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// mock ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">    ArrayList&lt;String&gt; mockList = mock(ArrayList.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ’æ¡©</span></span><br><span class="line">    when(mockList.get(<span class="number">0</span>)).thenReturn(<span class="string">"mock stub test"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//éªŒè¯</span></span><br><span class="line">    assertEquals(<span class="string">"mock stub test"</span>, mockList.get(<span class="number">0</span>));</span><br><span class="line">    assertNull(mockList.get(<span class="number">1</span>)); <span class="comment">// å› ä¸º mockList.get(1) æ–¹æ³•æ²¡æœ‰æ’æ¡©ï¼Œæ‰€ä»¥è¿”å› nullï¼›</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// spy ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">    ArrayList&lt;String&gt; arrayList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    ArrayList&lt;String&gt; spyList = spy(arrayList);</span><br><span class="line"></span><br><span class="line">    spyList.add(<span class="string">"one"</span>);</span><br><span class="line">    spyList.add(<span class="string">"two"</span>);</span><br><span class="line"></span><br><span class="line">    assertEquals(<span class="string">"one"</span>, spyList.get(<span class="number">0</span>));</span><br><span class="line">    <span class="comment">// ä¸‹é¢è¯­å¥ä¼šè¾“å‡º two.</span></span><br><span class="line">    System.out.println(spyList.get(<span class="number">1</span>));</span><br><span class="line">    <span class="comment">// spyList.get(2) ä¼šæŠ›å‡º IndexOutOfBoundsException</span></span><br><span class="line">    assertNull(spyList.get(<span class="number">2</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¯¹-void-æ–¹æ³•è¿›è¡Œ-stub"><a class="anchor" href="#å¯¹-void-æ–¹æ³•è¿›è¡Œ-stub"></a> å¯¹ void æ–¹æ³•è¿›è¡Œ stub</h4><p>å¦‚æœä¸€ä¸ªæ–¹æ³•è¿”å›è¿”å›ä¸ºç©ºï¼Œåˆ™éœ€è¦ç‰¹å®šçš„æ–¹æ³•è¿›è¡Œ stubã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">doXXX().when(mockObj).someMethod([arg1, arg2, ...]);</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>doXXX()</code>å¯ä»¥æ˜¯<code>doNothing()</code>ã€<code>doCallRealMethod</code>ã€<code>doThrow()</code>ã€<code>doAnswer()</code>å…¶ä¸­çš„ä¸€ç§ï¼šä¸¾ä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stubVoidMethodTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    StudentDatabaseHelper helper = mock(StudentDatabaseHelper.class);</span><br><span class="line">    Object object = <span class="keyword">new</span> Object();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰§è¡Œè¯¥ stub çš„æ–¹æ³•æ—¶ä¸åšä»»ä½•äº‹</span></span><br><span class="line">    doNothing().when(helper).updateNewScoreWithId(anyInt(), anyInt());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰§è¡Œè¯¥ stub çš„æ–¹æ³•æ—¶æ‰§è¡Œè¯¥æ–¹æ³•çœŸæ­£çš„æ–¹æ³•ä½“ï¼Œç”±äºæœ¬æ–¹æ³•æ˜¯ abstract çš„ï¼Œæ‰€ä»¥æ­¤å¤„åœ¨ç¼–è¯‘æ—¶ä¼šæŠ¥é”™</span></span><br><span class="line">    <span class="comment">// doCallRealMethod().when(helper).updateNewScoreWithId(anyInt(), anyInt());</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰§è¡Œè¯¥ stub çš„æ–¹æ³•æ—¶æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸</span></span><br><span class="line">    doThrow(RuntimeException.class).when(helper).updateNewScoreWithId(anyInt(), anyInt());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰§è¡Œè¯¥ stub çš„æ–¹æ³•æ—¶æ‰§è¡Œç‰¹å®šçš„æ“ä½œ</span></span><br><span class="line">    doAnswer(invocation -&gt; &#123;</span><br><span class="line">        Object[] arguments = invocation.getArguments();</span><br><span class="line">        <span class="keyword">if</span> (arguments.length == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> arguments[<span class="number">0</span>];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> arguments[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;).when(helper).updateNewScoreWithId(anyInt(), anyInt());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¯¹åŒä¸€ä¸ªæ–¹æ³•è¿›è¡Œè¿ç»­-stub"><a class="anchor" href="#å¯¹åŒä¸€ä¸ªæ–¹æ³•è¿›è¡Œè¿ç»­-stub"></a> å¯¹åŒä¸€ä¸ªæ–¹æ³•è¿›è¡Œè¿ç»­ stub</h4><p>æŸäº›æ—¶å€™ï¼Œåœ¨æµ‹è¯•çš„è¿‡ç¨‹ä¸­é‡å¤è°ƒç”¨äº†æŸä¸ªæ–¹æ³•ï¼Œå¹¶ä¸”æ­¤æ–¹æ³•æ˜¯è¢«æµ‹è¯•å•å…ƒä¹‹å¤–éœ€è¦è¿›è¡Œ stub çš„ã€‚ä½¿ç”¨ä¹‹å‰çš„æ–¹æ³•ï¼Œå¯¹æ¯æ¬¡æ–¹æ³•çš„è°ƒç”¨éƒ½ä½¿ç”¨</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">when(mockObj.someMethod()).thenReturn(<span class="string">"value"</span>);</span><br></pre></td></tr></table></figure><p>ä¼šæ˜¾å¾—ä»£ç ä¼šå¾ˆç´¯èµ˜ã€‚Mockito æ¡†æ¶æä¾›äº†ä¸€ç§ç®€å•çš„è¿­ä»£çš„æ–¹æ³•å¯¹åŒä¸€ä¸ªæ–¹æ³•è¿›è¡Œ stubã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">consecutiveStubTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Student mockStudent = mock(Student.class);</span><br><span class="line"></span><br><span class="line">    when(mockStudent.getName())</span><br><span class="line">        .thenReturn(<span class="string">"name1"</span>)</span><br><span class="line">        .thenReturn(<span class="string">"name2"</span>)</span><br><span class="line">        .thenReturn(<span class="string">"name3"</span>)</span><br><span class="line">        .thenReturn(<span class="string">"name4"</span>);</span><br><span class="line"></span><br><span class="line">    assertEquals(<span class="string">"name1"</span>, mockStudent.getName());</span><br><span class="line">    assertEquals(<span class="string">"name2"</span>, mockStudent.getName());</span><br><span class="line">    assertEquals(<span class="string">"name3"</span>, mockStudent.getName());</span><br><span class="line">    assertEquals(<span class="string">"name4"</span>, mockStudent.getName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ä¸ºæœªè¿›è¡Œ-stub-çš„æ–¹æ³•è®¾ç½®é»˜è®¤è¿”å›å€¼"><a class="anchor" href="#ä¸ºæœªè¿›è¡Œ-stub-çš„æ–¹æ³•è®¾ç½®é»˜è®¤è¿”å›å€¼"></a> ä¸ºæœªè¿›è¡Œ stub çš„æ–¹æ³•è®¾ç½®é»˜è®¤è¿”å›å€¼</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDefaultReturnValues</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Student student = mock(Student.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ©ç”¨ thenAnswer() è®¾ç½®é»˜è®¤è¿”å›å€¼</span></span><br><span class="line">    when(student.getName()).thenAnswer(invocation -&gt; <span class="string">"default value"</span>);</span><br><span class="line"></span><br><span class="line">    assertEquals(<span class="string">"default value"</span>, student.getName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="éªŒè¯-verify"><a class="anchor" href="#éªŒè¯-verify"></a> éªŒè¯ verify</h3><h4 id="è¡Œä¸ºéªŒè¯"><a class="anchor" href="#è¡Œä¸ºéªŒè¯"></a> è¡Œä¸ºéªŒè¯</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">verifyTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Student mockStudent = mock(Student.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// stub æ–¹æ³•</span></span><br><span class="line">    when(mockStudent.getName()).thenReturn(<span class="string">"name1"</span>);</span><br><span class="line">    doNothing().when(mockStudent).setScore(<span class="number">99</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨ stub ä¹‹åçš„æ–¹æ³•</span></span><br><span class="line">    mockStudent.setScore(<span class="number">99</span>);</span><br><span class="line">    mockStudent.getName();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éªŒè¯</span></span><br><span class="line">    verify(mockStudent).setScore(<span class="number">99</span>); <span class="comment">// éªŒè¯æ·»åŠ å‚æ•°çš„æ–¹æ³•</span></span><br><span class="line">    verify(mockStudent).getName();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è°ƒç”¨æ¬¡æ•°éªŒè¯"><a class="anchor" href="#è°ƒç”¨æ¬¡æ•°éªŒè¯"></a> è°ƒç”¨æ¬¡æ•°éªŒè¯</h4><p>Mockito æä¾›äº†å‡ ä¸ªå¸¸ç”¨çš„éªŒè¯è°ƒç”¨æ¬¡æ•°çš„æ–¹æ³•ï¼Œå¯ä»¥åˆ©ç”¨è¿™äº›æ–¹æ³•å¯¹å¾…æµ‹è¯•ä»£ç æ‰€è°ƒç”¨çš„æ–¹æ³•è¿›è¡Œè°ƒç”¨æ¬¡æ•°ä¸Šçš„ç²¾ç¡®éªŒè¯ï¼š</p><ul><li><code>times(n)</code> - éªŒè¯å…·ä½“çš„è°ƒç”¨æ¬¡æ•°ï¼Œn ä¸ºå…·ä½“æ­£æ•´æ•°ï¼Œä»£è¡¨æ‰€éœ€è¦éªŒè¯çš„æ¬¡æ•°ï¼Œåœ¨ verify ä¸­é»˜è®¤éªŒè¯æ¬¡æ•°ä¸º 1ï¼›</li><li><code>atLeast(n)</code> - å­—é¢æ„æ€ï¼ŒéªŒè¯è‡³å°‘è°ƒç”¨çš„æ¬¡æ•°ï¼›</li><li><code>atLeastOnce()</code> - å³<code>atLeast(1)</code>;</li><li><code>atMost(n)</code> - å’Œ<code>atLeast</code>ç›¸åï¼Œè¡¨ç¤ºè‡³å¤šè°ƒç”¨å¤šå°‘æ¬¡ï¼›</li><li><code>never()</code> - è¡¨ç¤ºéªŒè¯ä»æœªè°ƒç”¨è¿‡è¯¥æ–¹æ³•ï¼Œç­‰ä»·äº<code>times(0)</code>;</li></ul><p>ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">verifyCallTimesTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Student mockStudent = mock(Student.class);</span><br><span class="line"></span><br><span class="line">    mockStudent.setScore(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    mockStudent.setScore(<span class="number">2</span>);</span><br><span class="line">    mockStudent.setScore(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    verify(mockStudent).setScore(<span class="number">1</span>);</span><br><span class="line">    verify(mockStudent, times(<span class="number">1</span>)).setScore(<span class="number">1</span>);</span><br><span class="line">    verify(mockStudent, atLeast(<span class="number">1</span>)).setScore(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    verify(mockStudent, times(<span class="number">2</span>)).setScore(<span class="number">2</span>);</span><br><span class="line">    verify(mockStudent, atMost(<span class="number">5</span>)).setScore(<span class="number">2</span>);</span><br><span class="line">    verify(mockStudent, atLeastOnce()).setScore(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    verify(mockStudent, never()).setScore(<span class="number">4</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è°ƒç”¨æ¬¡åºéªŒè¯"><a class="anchor" href="#è°ƒç”¨æ¬¡åºéªŒè¯"></a> è°ƒç”¨æ¬¡åºéªŒè¯</h4><p>éªŒè¯è°ƒç”¨æ¬¡åºä¸»è¦ç”¨åˆ°äº†<code>InOrder</code>ç±»ä¸­çš„<code>verify()</code>æ–¹æ³•ï¼Œä¸¾ä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">verifyOrderTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Student singleMockStudent = mock(Student.class);</span><br><span class="line"></span><br><span class="line">    singleMockStudent.setScore(<span class="number">1</span>);</span><br><span class="line">    singleMockStudent.setScore(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®ä¾‹åŒ–ä¸€ä¸ª inOrder å¯¹è±¡</span></span><br><span class="line">    InOrder inOrder = Mockito.inOrder(singleMockStudent);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éªŒè¯å‚æ•°ä¸º 1 çš„æ–¹æ³•å…ˆäºå‚æ•°ä¸º 2 çš„æ–¹æ³•è¿è¡Œ</span></span><br><span class="line">    inOrder.verify(singleMockStudent).setScore(<span class="number">1</span>);</span><br><span class="line">    inOrder.verify(singleMockStudent).setScore(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    Student firstStudent = mock(Student.class);</span><br><span class="line">    Student secondStudent = mock(Student.class);</span><br><span class="line"></span><br><span class="line">    firstStudent.setScore(<span class="number">3</span>);</span><br><span class="line">    secondStudent.setScore(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®ä¾‹åŒ– inOrder å¯¹è±¡ï¼Œå‚æ•°ä¸ºéœ€è¦è¿›è¡ŒéªŒè¯è°ƒç”¨æ¬¡åºçš„ mock å¯¹è±¡</span></span><br><span class="line">    inOrder = Mockito.inOrder(firstStudent, secondStudent);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// verify</span></span><br><span class="line">    inOrder.verify(firstStudent).setScore(<span class="number">3</span>);</span><br><span class="line">    inOrder.verify(secondStudent).setScore(<span class="number">4</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="éªŒè¯-mock-å¯¹è±¡æ˜¯å¦äº¤äº’"><a class="anchor" href="#éªŒè¯-mock-å¯¹è±¡æ˜¯å¦äº¤äº’"></a> éªŒè¯ mock å¯¹è±¡æ˜¯å¦äº¤äº’</h4><p>éªŒè¯å¯¹è±¡æ˜¯å¦è¿›è¡Œäº¤äº’çš„æ„æ€æ˜¯éªŒè¯æµ‹è¯•ç”¨ä¾‹ä¸­ mock çš„å¯¹è±¡åœ¨éªŒè¯ä¹‹å‰æ˜¯å¦ä¸ä¹‹äº§ç”Ÿäº¤äº’ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">verifyInteractionTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Student firstStudent = mock(Student.class);</span><br><span class="line">    Student secondStudent = mock(Student.class);</span><br><span class="line"></span><br><span class="line">    firstStudent.setScore(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ­£å¸¸çš„éªŒè¯è¡Œä¸º</span></span><br><span class="line">    verify(firstStudent).setScore(<span class="number">1</span>);</span><br><span class="line">    verify(secondStudent, never()).setScore(anyInt());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// äº¤äº’éªŒè¯ secondStudent ä»æœªè¿›è¡Œäº¤äº’ </span></span><br><span class="line">    verifyZeroInteractions(secondStudent);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æŸ¥æ‰¾æ˜¯å¦æœ‰æœªéªŒè¯çš„äº¤äº’"><a class="anchor" href="#æŸ¥æ‰¾æ˜¯å¦æœ‰æœªéªŒè¯çš„äº¤äº’"></a> æŸ¥æ‰¾æ˜¯å¦æœ‰æœªéªŒè¯çš„äº¤äº’</h4><p>ä¸»è¦æ˜¯éªŒè¯å¯¹æŸä¸ª mock å¯¹è±¡è¿›è¡Œäº†æ“ä½œï¼Œå¹¶ä¸”å¯¹æ“ä½œè¿›è¡Œäº† verifyã€‚ä¸ä»‹æ„åœ¨æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ä¸­ä½¿ç”¨ï¼Œå®˜æ–¹æ–‡æ¡£åŸæ–‡ä¸ºï¼š</p><blockquote><p>A word of <strong>warning</strong>: Some users who did a lot of classic, expect-run-verify mocking tend to use <code>verifyNoMoreInteractions()</code> very often, even in every test method. <code>verifyNoMoreInteractions()</code> is not recommended to use in every test method. <code>verifyNoMoreInteractions()</code> is a handy assertion from the interaction testing toolkit. Use it only when itâ€™s relevant. Abusing it leads to <strong>overspecified</strong>, <strong>less maintainable</strong> tests. You can find further reading <a href="http://monkeyisland.pl/2008/07/12/should-i-worry-about-the-unexpected/">here</a>.</p></blockquote><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span>(expected = NoInteractionsWanted.class)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">noMoreInteractionsTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Student student = mock(Student.class);</span><br><span class="line"></span><br><span class="line">    student.setScore(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éªŒè¯å¤±è´¥ï¼ŒæŠ›å‡º NoInteractionsWanted å¼‚å¸¸</span></span><br><span class="line">    verifyNoMoreInteractions(student);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è¶…æ—¶éªŒè¯"><a class="anchor" href="#è¶…æ—¶éªŒè¯"></a> è¶…æ—¶éªŒè¯</h4><p>è¶…æ—¶éªŒè¯æ˜¯ç”¨æ¥éªŒè¯æŸä¸€ç‰¹å®šçš„æ–¹æ³•æˆ–è€…æ“ä½œåœ¨è§„å®šçš„æ—¶é—´å†…èƒ½æ‰§è¡Œå®Œæ¯•ï¼Œé˜²æ­¢è¿›ç¨‹é˜»å¡æˆ–è€…æ›´æ–°ç¼“æ…¢ç­‰ï¼Œç»™ç”¨æˆ·å¸¦æ¥ä¸å‹å¥½çš„ä½“éªŒã€‚</p><p>åœ¨<a href="http://www.istarx.cc/2018/04/24/unit-test-annotation/">JUnitåŸºæœ¬æ³¨é‡Š</a>ä¸€æ–‡ä¸­ä¹Ÿæåˆ°äº†è¶…æ—¶æµ‹è¯•ï¼Œåˆ©ç”¨<code>@Test(timeout = time_with_ms)</code>çš„æ³¨é‡Šå¯ä»¥å¯¹æ•´ä¸ªæµ‹è¯•ç”¨ä¾‹è¿è¡Œçš„æ‰§è¡Œæ—¶é•¿è¿›è¡Œæµ‹è¯•ã€‚PowerMock åŒæ ·ä¹Ÿæä¾›äº†<code>verify</code> + <code>timeout</code>çš„æ–¹æ³•å¯¹æŸä¸€ç‰¹å®šçš„æ–¹æ³•è¿›è¡ŒéªŒè¯ï¼Œ ä½†å…¶éªŒè¯çš„ä½œç”¨æ˜¯åœ¨éªŒè¯ä¹‹å‰å¯¹è¿›ç¨‹é˜»å¡ä¸€æ®µæ—¶é—´ï¼Œä¹‹åå†å»éªŒè¯ã€‚ä¾‹å¦‚ï¼š</p><p>è¢«æµ‹è¯•ä»£ç ä¸¤ä¸ªæ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TimeoutDemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">timeoutMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// do something here</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">timeoutTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    TimeoutDemo demo = mock(TimeoutDemo.class);</span><br><span class="line"></span><br><span class="line">    doCallRealMethod().when(demo).timeoutMethod();</span><br><span class="line">    demo.timeoutMethod();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å»¶è¿Ÿ 200ms å†éªŒè¯è¯¥æ–¹æ³•æ˜¯å¦æ‰§è¡Œè¿‡</span></span><br><span class="line">    verify(demo,timeout(<span class="number">200</span>)).timeoutMethod();</span><br><span class="line">    <span class="comment">// ç­‰ä»·ä¸ä¸‹é¢è¿™å¥</span></span><br><span class="line">    verify(demo, timeout(<span class="number">200</span>).times(<span class="number">1</span>)).timeoutMethod();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è‡ªå®šä¹‰éªŒè¯æ¨¡å¼</span></span><br><span class="line">    verify(demo,<span class="keyword">new</span> Timeout(<span class="number">200</span>, <span class="keyword">new</span> VerificationMode() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">verify</span><span class="params">(VerificationData data)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// custom verify mode</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> VerificationMode <span class="title">description</span><span class="params">(String description)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)).timeoutMethod();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="alert warning"><p><code>timeout()</code>æ–¹æ³•éœ€è¦1.8.5 ç‰ˆæœ¬ä¹‹åæ‰å¯ä»¥ä½¿ç”¨ã€‚</p></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Mock æ„ä¸ºæ¨¡æ‹Ÿï¼ŒæŒ‡æ¨¡æ‹Ÿä¸€ä¸ªä»£ç æ‰€ä¾èµ–çš„æ¡†æ¶ã€ç¬¬ä¸‰æ–¹ä»£ç æˆ–è€…æ„å»ºèµ·æ¥è¾ƒä¸ºå¤æ‚çš„å¯¹è±¡ï¼Œå°†è¢«æµ‹è¯•çš„ä»£ç å’Œå…¶å®ƒä»£ç éš”ç¦»å¼€æ¥ï¼Œè€Œ Mockito æ¡†æ¶æ˜¯ä¸€æ¬¾æµè¡Œçš„ Mock æ¡†æ¶ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç¨‹åºçŒ¿è¿›åŒ–ä¹‹è·¯" scheme="http://www.istarx.cn/categories/%E7%A8%8B%E5%BA%8F%E7%8C%BF%E8%BF%9B%E5%8C%96%E4%B9%8B%E8%B7%AF/"/>
    
      <category term="è‡ªåŠ¨åŒ–æµ‹è¯•" scheme="http://www.istarx.cn/categories/%E7%A8%8B%E5%BA%8F%E7%8C%BF%E8%BF%9B%E5%8C%96%E4%B9%8B%E8%B7%AF/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="è‡ªåŠ¨åŒ–æµ‹è¯•" scheme="http://www.istarx.cn/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/"/>
    
      <category term="unit-test" scheme="http://www.istarx.cn/tags/unit-test/"/>
    
      <category term="Mock" scheme="http://www.istarx.cn/tags/Mock/"/>
    
      <category term="Mockito" scheme="http://www.istarx.cn/tags/Mockito/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•å†™æœ‰ä»·å€¼çš„å•å…ƒæµ‹è¯•</title>
    <link href="http://www.istarx.cn/2018/04/26/how-to-write-unit-tests/"/>
    <id>http://www.istarx.cn/2018/04/26/how-to-write-unit-tests/</id>
    <published>2018-04-26T14:57:16.000Z</published>
    <updated>2019-02-18T17:05:06.108Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>ä¹‹å‰å¯¹å•å…ƒæµ‹è¯•åšäº†ä¸€ä¸ªç®€å•çš„ä»‹ç»ï¼Œå¹¶ä»‹ç»äº†ä½†æ˜¯æµ‹è¯•å¸¸ç”¨çš„æ³¨é‡Šã€‚æ­£å› ä¸ºå…¶é‡è¦ï¼Œæ‰€ä»¥æ›´åº”è¯¥å¯¹ä»£ç è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œä¿è¯ä»£ç è¿è¡Œçš„æ­£ç¡®æ€§ã€‚æœ¬æ–‡å°±å¦‚ä½•ç¼–å†™å•å…ƒæµ‹è¯•åšä¸€ä¸ªç®€å•çš„ä»‹ç»ã€‚</p><a id="more"></a><p><ul class="toc js-fixedContent"><li><ul><li><a href="#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B%E5%86%99%E6%B3%95%E6%9D%82%E8%B0%88">å•å…ƒæµ‹è¯•ç”¨ä¾‹å†™æ³•æ‚è°ˆ</a></li><li><a href="#%E5%BC%80%E5%8F%91%E5%85%88%E8%A1%8Ctfd">å¼€å‘å…ˆè¡Œ(TFD)</a></li><li><a href="#%E6%B5%8B%E8%AF%95%E5%85%88%E8%A1%8Ctdd">æµ‹è¯•å…ˆè¡Œ(TDD)</a></li></ul></li><li><a href="#%E5%B0%8F%E7%BB%93">å°ç»“</a></li></ul></p><h3 id="å•å…ƒæµ‹è¯•ç”¨ä¾‹å†™æ³•æ‚è°ˆ"><a class="anchor" href="#å•å…ƒæµ‹è¯•ç”¨ä¾‹å†™æ³•æ‚è°ˆ"></a> å•å…ƒæµ‹è¯•ç”¨ä¾‹å†™æ³•æ‚è°ˆ</h3><p>å½“çŸ¥é“äº†å•å…ƒæµ‹è¯•å¤šä¹ˆå¤šä¹ˆé‡è¦ï¼Œå¤šä¹ˆå¤šä¹ˆçš„æœ‰ç”¨ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥çš„å·¥ä½œå°±æ˜¯ç€æ‰‹å»å†™å•å…ƒæµ‹è¯•äº†ã€‚ä½ å¯èƒ½æ˜¯å¯¹ç›®å‰å·²æœ‰é¡¹ç›®ä¸Šæ·»åŠ å•å…ƒæµ‹è¯•ï¼Œä¹Ÿå¯èƒ½åœ¨ä¸€ä¸ªåˆšå¼€å§‹è¿›è¡Œå¼€å‘çš„é¡¹ç›®ä¸Šåœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­æ·»åŠ å•å…ƒæµ‹è¯•ï¼Œæˆ–è€…ä½ ä¼šä»æµ‹è¯•å…ˆè¡Œï¼Œä»æµ‹è¯•æ¥é©±åŠ¨å¼€å‘ã€‚</p><p>å¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œé‡‡ç”¨ç³»ç»ŸåŒ–çš„å¼€å‘è€…æµ‹è¯•æ–¹æ³•ï¼Œèƒ½æœ€å¤§é™åº¦æé«˜å‘ç°å„ç§é”™è¯¯çš„èƒ½åŠ›ï¼ŒåŒæ—¶è®©ä½ æ—¶é—´ã€ç²¾åŠ›ç­‰è¯è´¹åˆ°æœ€å°‘ã€‚å¼€å‘è€…æµ‹è¯•éœ€è¦åšåˆ°ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p><ul><li>å¯¹æ¯ä¸€æ¡éœ€æ±‚è¿›è¡Œæµ‹è¯•ï¼Œç¡®ä¿æ¯ä¸€æ¡éœ€æ±‚èƒ½å¾—åˆ°å®ç°ã€‚</li><li>å¯¹æ¯ä¸€ä¸ªè®¾è®¡ç›¸å…³ç‚¹è¿›è¡Œæµ‹è¯•ï¼Œç¡®ä¿è®¾è®¡è¢«å®ç°ã€‚</li></ul><p>è¿™ä¸¤ç‚¹åœ¨è¿›è¡Œå¼€å‘çš„è¿‡ç¨‹ä¸­å¯ä»¥æ‹†åˆ†æˆä¸€ä¸ªå•å…ƒæˆ–è€…ä¸€ä¸ªåŠŸèƒ½ç‚¹è¿›è¡Œæµ‹è¯•ã€‚ä½†æ˜¯åœ¨å¼€å‘è¿‡ç¨‹ä¸­ç©¶ç«Ÿæ˜¯æµ‹è¯•å…ˆè¡Œè¿˜æ˜¯å¼€å‘å…ˆè¡Œï¼Œä¸åŒäººæœ‰ä¸åŒçš„ç»“è®ºã€‚æœ€æ—©åœ¨æé™ç¼–ç¨‹æå‡ºçš„æµ‹è¯•é©±åŠ¨å¼€å‘(Test-Driven Developmentï¼Œç®€ç§°TDD)æœ€è¿‘å‡ å¹´ç»è¿‡äº†è¿…çŒ›çš„å‘å±•ï¼Œå¾—åˆ°äº†è¶Šæ¥è¶Šå¤šçš„å…³æ³¨ã€‚è°·æ­Œåœ¨2017å¹´çš„ IO å¤§ä¼šä¸Šä¹Ÿå¯¹TDDè¿›è¡Œäº†ä¸“é—¨çš„ä»‹ç»ã€‚TDDè®²ç©¶æµ‹è¯•å…ˆè¡Œï¼Œæµ‹è¯•å…ˆè¡Œå¯ä»¥å°†å¼•å…¥ç¼ºé™·åˆ°å‘ç°å¹¶è§£å†³ç¼ºé™·åˆ°æ—¶é—´è¾ƒå°‘åˆ°æœ€çŸ­ã€‚æµ‹è¯•å…ˆè¡Œå³ã€‚TDD æå€¡åœ¨åšå¼€å‘ä¹‹å‰å…ˆç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œç„¶åç¼–å†™ä½¿æµ‹è¯•ä»£ç æ­£ç¡®è¿è¡Œçš„çš„åŠŸèƒ½ä»£ç ï¼Œç›´åˆ°åŠŸèƒ½ä»£ç æ»¡è¶³æ‰€æœ‰éœ€æ±‚æˆ–è€…è®¾è®¡ã€‚</p><p>æåˆ°æµ‹è¯•å°±è®¾è®¡åˆ°ä¸€ä¸ªè¦†ç›–ç‡çš„é—®é¢˜ï¼Œè¦†ç›–åˆåˆ†ä¸ºåˆ†æ”¯è¦†ç›–ã€è¯­å¥è¦†ç›–ã€‚100%çš„è¯­å¥è¦†ç›–ç‡å›ºç„¶å¥½ï¼Œä½†æ˜¯æ›´å¥½çš„æ˜¯100%çš„åˆ†æ”¯è¦†ç›–ç‡ï¼Œå³å¯¹æ¯ä¸ªåˆ¤æ–­è¯­å¥æˆ–è€…æ¯ä¸ªåˆ†æ”¯éƒ½å–ä¸€ä¸ªçœŸå€¼å’Œä¸€ä¸ªå‡å€¼ã€‚åœ¨åŒä¸€åˆ†æ”¯ä¸‹å°½å¯èƒ½çš„è¦å–å€¼å…¨é¢ï¼Œå–å€¼å…¨é¢çš„å«ä¹‰å³æ˜¯åœ¨ä¼—å¤šçš„å–å€¼ä¸­èƒ½å°½å¯èƒ½çš„æŠŠé”™è¯¯å°±å‡ºæ¥çš„å–å€¼é›†åˆï¼Œå…¨é¢çš„å–å€¼æ‰èƒ½è¾¾åˆ°æ›´å®Œç¾çš„æµ‹è¯•ã€‚</p><p>åœ¨å…¨é¢çš„å–å€¼ä¸­æœ€éœ€è¦è€ƒè™‘çš„å°±æ˜¯è¾¹ç•Œè°ƒä»¶ï¼Œå› ä¸ºå¤§å¤šæ•°ç¨‹åºçŒ¿æœ€å®¹æ˜“çŠ¯çš„é”™è¯¯æˆ–è€…è¯´æ˜¯ä»£ç è¿è¡Œä¸­æœ€å®¹æ˜“å‡ºé”™çš„åœ°æ–¹å°±æ˜¯åœ¨è¾¹ç•Œå–å€¼çš„åœ°æ–¹ï¼Œä¾‹å¦‚æœ‰å¯èƒ½æŠŠ<code>num</code>å†™æˆäº†<code>num - 1</code>æˆ–è€…æŠŠ<code>&lt;</code>å†™æˆ<code>&lt;=</code>ç­‰ç­‰ã€‚å‡å¦‚æœ‰è¿™æ ·ä¸€ä¸ª if è¯­å¥ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (num &lt; <span class="number">10</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ™å¯¹äº if è¯­å¥æ¥è¯´ï¼Œè¾¹ç•Œæ¡ä»¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="boundary-eg.png" alt="boundary-eg"></p><p>åˆ™æµ‹è¯•ç”¨ä¾‹å–å€¼åˆ™ä¸ºï¼š<code>9ã€10ã€11</code>ä¸‰ä¸ªï¼Œå¦‚æœå†è€ƒè™‘æç«¯æƒ…å†µï¼Œç»„éœ€è¦å†æ·»åŠ ä¸¤ä¸ªæµ‹è¯•ç”¨ä¾‹å€¼ï¼š<code>Integer.MAX_VALUE</code>å’Œ<code>Integer.MIN_VALUE</code>ï¼›</p><h3 id="å¼€å‘å…ˆè¡Œtfd"><a class="anchor" href="#å¼€å‘å…ˆè¡Œtfd"></a> å¼€å‘å…ˆè¡Œ(TFD)</h3><p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½æ˜¯ç¼–å†™æµ‹è¯•ç”¨ä¾‹å»æµ‹è¯•å·²æœ‰ä»£ç ã€‚å½“ä¸ºè¾¾åˆ°å……åˆ†æµ‹è¯•ï¼Œåˆ™éœ€è¦è€ƒè™‘åˆ°ä»£ç ä¸­æ‰€æœ‰å¯èƒ½æƒ…å†µï¼ŒåŒ…æ‹¬å¸¸è§„æƒ…å†µå’Œè¾¹ç•Œæƒ…å†µä»¥åŠæç«¯æƒ…å†µï¼Œå¹¶åŠ ä»¥æ’é™¤ã€ä¼˜åŒ–ã€åˆå¹¶ç­‰ï¼Œè¾¾åˆ° 100% æˆ–è€…æ›´æ¥è¿‘ 100% çš„åˆ†æ”¯è¦†ç›–ç‡ã€‚</p><p>ä¾‹å¦‚æœ‰å¦‚ä¸‹åŠŸèƒ½ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getScore</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (num &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (num &gt;= <span class="number">5</span> &amp;&amp; num &lt;= <span class="number">10</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> num;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºè¯¥æ–¹æ³•å‚æ•°åªæ˜¯ int å‹çš„ï¼Œå¯ä»¥æœ‰æ— é™å¤šä¸ªå–å€¼ï¼Œåœ¨æµ‹è¯•æ—¶ä¸å¯èƒ½å¯¹æ‰€æœ‰çš„å–å€¼è¿›è¡Œæµ‹è¯•ã€‚é’ˆå¯¹æ­¤ç§æƒ…å†µéœ€è¦å¯¹å‚æ•°å–è¾¹ç•Œå€¼ä»¥åŠæœ‰é™å¤šä¸ªæ­£å¸¸å€¼è¿›è¡Œæµ‹è¯•å·²è¾¾åˆ°å®Œæ•´çš„æµ‹è¯•ï¼Œæµ‹è¯•æƒ…å†µä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p><ul><li>å¯¹äºâ‘ å¤„çš„ifè¯­å¥æœ‰ä¸€ä¸ªè¾¹ç•Œä¸º num = -1ã€0 ã€1ï¼›</li><li>å¯¹äºâ‘¡å¤„çš„è¯­å¥æœ‰ä¸¤ä¸ªè¾¹ç•Œï¼Œå³ä¸º num = 4ã€5ã€ 6 ä»¥åŠ num = 9ã€10ã€11</li><li>åœ¨â‘¡å¤„ if è¯­å¥å†… æœ‰ <code>&amp;&amp;</code>è¿ç®—ï¼Œæœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š<ul><li>çœŸ &amp;&amp; çœŸï¼š num = 6ï¼›</li><li>çœŸ &amp;&amp; å‡ï¼šnum = 11ï¼›</li><li>å‡ &amp;&amp; çœŸï¼šnum = 4ï¼›</li><li>å‡ &amp;&amp; å‡ï¼šæ— å–å€¼ï¼›</li></ul></li><li>è€ƒè™‘æé™æ¡ä»¶ï¼šnum  = Integer.MAX_VALUEã€Integer.MIN_VALUE</li></ul><p>å»æ‰é‡å¤çš„å–å€¼ï¼Œæµ‹è¯•éœ€è¦çš„numå–å€¼æœ‰ Integer.MIN_VALUEã€-1ã€0ã€1ã€4ã€5ã€6ã€9ã€10ã€11ã€Integer.MAX_VALUE, æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getScoreTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertEquals(<span class="number">0</span>, BoundaryDemo.getScore(Integer.MIN_VALUE));</span><br><span class="line">    assertEquals(<span class="number">0</span>, BoundaryDemo.getScore(-<span class="number">1</span>));</span><br><span class="line">    assertEquals(<span class="number">0</span>, BoundaryDemo.getScore(<span class="number">0</span>));</span><br><span class="line">    assertEquals(<span class="number">1</span>, BoundaryDemo.getScore(<span class="number">1</span>));</span><br><span class="line">    assertEquals(<span class="number">4</span>, BoundaryDemo.getScore(<span class="number">4</span>));</span><br><span class="line">    assertEquals(<span class="number">5</span>, BoundaryDemo.getScore(<span class="number">5</span>));</span><br><span class="line">    assertEquals(<span class="number">5</span>, BoundaryDemo.getScore(<span class="number">6</span>));</span><br><span class="line">    assertEquals(<span class="number">5</span>, BoundaryDemo.getScore(<span class="number">9</span>));</span><br><span class="line">    assertEquals(<span class="number">5</span>, BoundaryDemo.getScore(<span class="number">10</span>));</span><br><span class="line">    assertEquals(<span class="number">11</span>, BoundaryDemo.getScore(<span class="number">11</span>));</span><br><span class="line">    assertEquals(Integer.MAX_VALUE, BoundaryDemo.getScore(Integer.MAX_VALUE));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="boundary-test-result.png" alt="boundary-test-result"></p><p>æµ‹è¯•ç”¨ä¾‹çš„ä»£ç è¦†ç›–ç‡æŠ¥å‘Šç»“æœå¦‚ä¸‹ï¼š</p><p><img src="boundary-test-coverage-result.png" alt="boundary-test-coverage-result"></p><p>å¯ä»¥çœ‹å‡ºï¼Œä»£ç è¡Œçš„è¦†ç›–ç‡éƒ½ä¸º 100%ï¼Œå…¶å®ä»ä¸Šé¢å»ºç«‹æµ‹è¯•ç”¨ä¾‹çš„æ—¶å€™å°±å¯ä»¥çœ‹å‡ºæ¥å¯¹äºæ¯ä¸ªåˆ†æ”¯éƒ½è¦†ç›–äº†çœŸå‡ä¸¤ä¸ªå€¼ï¼Œå› æ­¤æ­¤æµ‹è¯•ç”¨ä¾‹çš„åˆ†æ”¯è¦†ç›–ç‡ä¹Ÿä¸º 100%ã€‚</p><h3 id="æµ‹è¯•å…ˆè¡Œtdd"><a class="anchor" href="#æµ‹è¯•å…ˆè¡Œtdd"></a> æµ‹è¯•å…ˆè¡Œ(TDD)</h3><p>TDD æ˜¯ä¸€ç§å¼€å‘æ–¹å¼ï¼Œå®ƒæå€¡æµ‹è¯•å…ˆäºå¼€å‘ã€‚å³å…ˆå†™å‡ºä¸€ä¸ªå¤±è´¥çš„æµ‹è¯•ç”¨ä¾‹ï¼Œç„¶åç¼–å†™ä½¿ç›®å‰æ‰€æœ‰å·²ç¼–å†™çš„æµ‹è¯•ç”¨ä¾‹æ­£ç¡®è¿è¡Œçš„å¼€å‘ä»£ç ã€‚ä¸€ç›´è¿™æ ·å¾ªç¯ç›´åˆ°æ‰€æœ‰çš„æµ‹è¯•ç”¨ä¾‹éƒ½æ­£å¸¸é€šè¿‡ï¼Œæœ€ååœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œä»£ç é‡æ„å’Œæµ‹è¯•ç”¨ä¾‹é‡æ„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¦å¼€å‘ä¸€ä¸ªè®¡ç®—é˜¶ä¹˜æ–¹æ³•ï¼Œæ•´ä¸ª TDD å¼€å‘è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ol><li><p>å‡è®¾å®šä¹‰ä¸€ä¸ªæ–¹æ³•ä¸º<code>calculateFactorial_NotOptimized</code>,å®Œæ•´çš„ç­¾åå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">calculateFactorial</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºæ–¹æ³•éœ€è¦è¿”å› int å‹çš„å€¼ï¼Œåˆå§‹åŒ–æƒ…å†µä¸‹è¿”å›0ï¼›</p></li><li><p>ç¼–å†™ä¸€ä¸ªæœ€åŸºæœ¬çš„æµ‹è¯•ç”¨ä¾‹ï¼Œæµ‹è¯•ç”¨ä¾‹å‘½åæ ¼å¼é‡‡ç”¨<code>public void should_return_x_when_input_y()</code>,ç¬¬ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">should_return_1_when_input_0</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertEquals(<span class="number">1</span>, Factorial.calculateFactorial(<span class="number">0</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾ï¼Œ0 çš„é˜¶ä¹˜æ˜¯ 1ï¼Œå› æ­¤è¿™æ¡ç”¨ä¾‹è‚¯å®šä¼šå¤±è´¥ï¼Œæ—¢ç„¶è¿™æ¡ç”¨ä¾‹å¤±è´¥ï¼Œåˆ™éœ€è¦ä¿®æ”¹å¼€å‘ä»£ç ï¼Œä½¿æµ‹è¯•ç”¨ä¾‹å¯ä»¥æ­£å¸¸ç”¨è¡Œã€‚ç”±äºå¼€å‘ä»£ç ä¸­çš„åˆå§‹çŠ¶æ€ä¸‹çš„è¿”å›å€¼æ˜¯éšæœºæŒ‡å®šï¼Œå› æ­¤æš‚æ—¶å…ˆå°†æºä»£ç ä¿®æ”¹ä¸ºé€‚åˆè¾“å…¥ä¸º 0 çš„æƒ…å†µï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">calculateFactorial</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ä¹‹åå½“å‰æµ‹è¯•ç”¨ä¾‹éƒ½å¯ä»¥æ­£å¸¸è¿è¡Œã€‚</p></li><li><p>æ·»åŠ è¾“å…¥ä¸º<code>1</code>çš„æµ‹è¯•ç”¨ä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">should_return_1_when_input_1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertEquals(<span class="number">1</span>, Factorial.calculateFactorial(<span class="number">0</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>1 çš„é˜¶ä¹˜ä¸º1ï¼Œå› æ­¤è¿™æ¡ç”¨ä¾‹å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œå¼€å‘ä»£ç ä¸éœ€è¦è¿›è¡Œä¿®æ”¹ï¼›</p></li><li><p>æ¥ç€æ·»åŠ è¾“å…¥ä¸º<code>2</code>çš„ç”¨ä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">should_return_2_when_input_2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertEquals(<span class="number">2</span>, Factorial.calculateFactorial(<span class="number">2</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ¡æµ‹è¯•ç”¨ä¾‹çš„ excepted å€¼ä¸º 2ï¼Œå› æ­¤æ­¤ç”¨ä¾‹ä¹Ÿä¼šè¿è¡Œå¤±è´¥ï¼Œé‚£ä¹ˆå°±éœ€è¦é’ˆå¯¹æ­¤ç”¨ä¾‹ä¿®æ”¹å¼€å‘ä»£ç ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œå‡è®¾é™¤äº† 0ä»¥å¤–ï¼Œå…¶ä½™æƒ…å†µä¸‹è¾“å…¥å’Œè¾“å‡ºå§‹ç»ˆæ˜¯ç›¸ç­‰ï¼Œæ‰€ä»¥å¯ä»¥å°†å¼€å‘ä»£ç ä¿®æ”¹ä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">calculateFactorial</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (num == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ä¹‹åæµ‹è¯•ç”¨ä¾‹å¯ä»¥æ­£å¸¸è¿è¡Œã€‚</p></li><li><p>æ·»åŠ æµ‹è¯•ç”¨ä¾‹ä¸º 3 çš„æµ‹è¯•ç”¨ä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">should_return_6_when_input_3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertEquals(<span class="number">6</span>, Factorial.calculateFactorial(<span class="number">3</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ ·çš„ï¼Œè¯¥æ¡æµ‹è¯•ç”¨ä¾‹ä¹Ÿè¿è¡Œå¤±è´¥äº†ï¼Œéœ€è¦æ¥ç€ä¿®æ”¹æµ‹è¯•ç”¨ä¾‹ã€‚æˆ‘ä»¬æˆ‘ä»¬éƒ½çŸ¥é“ n( n &gt;= 2) çš„é˜¶ä¹˜ä¸ºï¼š</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>!</mo><mo>=</mo><mn>1</mn><mo>Ã—</mo><mn>2</mn><mo>Ã—</mo><mo>â€¦</mo><mo>Ã—</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n! = 1 \times 2 \times â€¦ \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span></span></p><p>å› æ­¤æœ‰ä¸¤ç§è§£æ³•ï¼Œä¸€ç§æ˜¯é‡‡ç”¨ <code>for</code>å¾ªç¯ï¼Œå¦å¤–ä¸€ç§æ˜¯é‡‡ç”¨<code>é€’å½’</code>æ–¹æ³•ï¼Œæ­¤å¤„æˆ‘ä»¬ä¿®æ”¹ä¸ºä»¥<code>é€’å½’</code>çš„æ–¹æ³•å®ç°é˜¶ä¹˜ï¼Œæºä»£ç ä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">calculateFactorial</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (num == <span class="number">0</span> || num == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> num * calculateFactorial(num - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ç°æœ‰çš„æµ‹è¯•ç”¨ä¾‹éƒ½æ˜¯æ­£å¸¸é€šè¿‡çš„ã€‚</p></li><li><p>å¯æ˜¯å°è¯•ç»™å…¶å®ƒè¾“å…¥ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œä¾‹å¦‚ 10:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">should_return_6_when_input_3628800</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertEquals(<span class="number">3628800</span>, Factorial.calculateFactorial(<span class="number">10</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶æµ‹è¯•ç”¨ä¾‹ä¹Ÿå¯ä»¥æ­£å¸¸è¿è¡Œã€‚</p></li><li><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åªè€ƒè™‘äº†æ­£æ•°ï¼Œæ²¡æœ‰è€ƒè™‘è´Ÿæ•°ã€‚æˆ‘ä»¬è§„å®šå½“è¾“å…¥ä¸ºè´Ÿæ•°æ—¶æŠ›å‡º<code>IllegalArgumentException</code>å¼‚å¸¸ï¼Œå¹¶ä¸ºè´Ÿæ•°æ·»åŠ ä¸€æ¡æµ‹è¯•ç”¨ä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span>(expected = IllegalArgumentException.class)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">should_return_6_when_input_negative_1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertEquals(<span class="number">0</span>, Factorial.calculateFactorial(-<span class="number">1</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨å¯¹ç›®å‰çš„å¼€å‘ä»£ç è¿›è¡Œæµ‹è¯•è´Ÿæ•°æ—¶ï¼Œæ— è®ºä»€ä¹ˆæƒ…å†µä¸‹éƒ½ä¼šè¿è¡ŒæŠ›å‡º<code>StackOverflowError</code>é”™è¯¯è€Œä¸æ˜¯æŠ›å‡º<code>IllegalArgumentException</code>å¼‚å¸¸ï¼Œå› æ­¤åœ¨å¼€å‘ä»£ç ä¸­å¯¹è´Ÿæ•°åšç‰¹æ®Šå¤„ç†ï¼Œä¿®æ”¹å¼€å‘ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">calculateFactorial</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (num &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"illegal argument."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (num == <span class="number">0</span> || num == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> num * calculateFactorial(num - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œåˆ©ç”¨é€’å½’çš„æ–¹æ³•æ±‚è§£é˜¶ä¹˜çš„åŠŸèƒ½å·²ç»å®ç°ã€‚ä½†æ˜¯æˆ‘ä»¬éƒ½çŸ¥é“æ±‚è§£é˜¶ä¹˜æ˜¯ä¸€ä¸ªéå¸¸è€—æ—¶çš„æ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸ºæ¯”è¾ƒå¤§çš„è¾“å…¥åšä¸€ä¸ªè¶…æ—¶æµ‹è¯•ï¼Œä¾‹å¦‚é™å®šè¾“å…¥ä¸º400çš„æ—¶å€™è¿ç®—è€—æ—¶ä¸è¶…è¿‡20ms(æ ¹æ®ç”µè„‘é…ç½®å¯èƒ½æœ‰æ‰€ä¸åŒ)ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span>(timeout = <span class="number">20</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">should_use_less_than_800ms_when_input_Max_value</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    BigInteger res = <span class="keyword">new</span> BigInteger(<span class="string">"64034522846623895262347970319503005850702583026002959458684445942802397169186831436278478647463264676294350575035856810848298162883517435228961988646802997937341654150838162426461942352307046244325015114448670890662773914918117331955996440709549671345290477020322434911210797593280795101545372667251627877890009349763765710326350331533965349868386831339352024373788157786791506311858702618270169819740062983025308591298346162272304558339520759611505302236086810433297255194852674432232438669948422404232599805551610635942376961399231917134063858996537970147827206606320217379472010321356624613809077942304597360699567595836096158715129913822286578579549361617654480453222007825818400848436415591229454275384803558374518022675900061399560145595206127211192918105032491008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"</span>);</span><br><span class="line">    assertEquals(res, Factorial.calculateFactorial(<span class="number">400</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ç”¨ä¾‹ä¼šè¿è¡Œå¤±è´¥ï¼Œå¤±è´¥åŸå› ä¸ºè¶…è¿‡äº†é™å®šçš„æ—¶é—´20msï¼Œå› æ­¤éœ€è¦å¯¹æµ‹è¯•ç”¨ä¾‹è¿›è¡Œè¿›ä¸€æ­¥çš„ä¼˜åŒ–ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> BigInteger <span class="title">calculateFactorial</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (num &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"illegal argument."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (num == <span class="number">0</span> || num == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> BigInteger(<span class="string">"1"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// return num * calculateFactorial(num - 1);</span></span><br><span class="line">    BigInteger bigIntegerNum = BigInteger.valueOf(num);</span><br><span class="line">    BigInteger temp = BigInteger.ONE;</span><br><span class="line">    BigInteger res = BigInteger.ONE;</span><br><span class="line">    <span class="keyword">for</span> (BigInteger i = BigInteger.ONE; i.compareTo(bigIntegerNum) &lt;= <span class="number">0</span>; i = i.add(temp)) &#123;</span><br><span class="line">        res = res.multiply(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»è¿‡ä¼˜åŒ–ä»£ç ï¼Œç°æœ‰çš„æµ‹è¯•ç”¨ä¾‹éƒ½å¯ä»¥æˆåŠŸæ‰§è¡Œã€‚</p></li><li><p>åˆ°æ­¤ç»“æŸã€‚</p></li></ol><h2 id="å°ç»“"><a class="anchor" href="#å°ç»“"></a> å°ç»“</h2><p>æ— è®ºæ˜¯å¼€å‘å…ˆè¡Œ(TFD)è¿˜æ˜¯æµ‹è¯•å…ˆè¡Œ(TDD)ç›®çš„éƒ½æ˜¯ä¸ºäº†æœ‰å¥å£®ã€å®‰å…¨çš„ä»£ç ï¼Œéƒ½æ˜¯ä¸ºäº†è®©é”™è¯¯æå‰æš´éœ²å‡ºæ¥è€Œä¸æ˜¯æš´éœ²åœ¨ç”¨æˆ·æ‰‹ä¸­ã€‚TFD å’Œ TDD æœ‰å„è‡ªçš„ä¼˜ç‚¹ï¼Œåè€…åœ¨æœ€è¿‘å‡ å¹´æ¥ç›¸å¯¹æ¯”è¾ƒæµè¡Œï¼Œ å—åˆ°å¾ˆå¤šæœºæ„æˆ–è€…å…¬å¸çš„é’çã€‚åœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨å“ªä¸€ç§æ–¹å¼å–å†³äºé¡¹ç›®è¿›åº¦ã€å›¢é˜Ÿæˆå‘˜ç­‰ã€‚</p><p>æœ¬æ–‡ç¤ºä¾‹ä»£ç ï¼š<a href="https://github.com/cherlas/BlogDemo/tree/master/writeunittestdemo/src">Demo</a></p><p>æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼Œå¸Œæœ›å¯ä»¥ç»™ä½ å¸¦æ¥å¸®åŠ©ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¹‹å‰å¯¹å•å…ƒæµ‹è¯•åšäº†ä¸€ä¸ªç®€å•çš„ä»‹ç»ï¼Œå¹¶ä»‹ç»äº†ä½†æ˜¯æµ‹è¯•å¸¸ç”¨çš„æ³¨é‡Šã€‚æ­£å› ä¸ºå…¶é‡è¦ï¼Œæ‰€ä»¥æ›´åº”è¯¥å¯¹ä»£ç è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œä¿è¯ä»£ç è¿è¡Œçš„æ­£ç¡®æ€§ã€‚æœ¬æ–‡å°±å¦‚ä½•ç¼–å†™å•å…ƒæµ‹è¯•åšä¸€ä¸ªç®€å•çš„ä»‹ç»ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç¨‹åºçŒ¿è¿›åŒ–ä¹‹è·¯" scheme="http://www.istarx.cn/categories/%E7%A8%8B%E5%BA%8F%E7%8C%BF%E8%BF%9B%E5%8C%96%E4%B9%8B%E8%B7%AF/"/>
    
      <category term="è‡ªåŠ¨åŒ–æµ‹è¯•" scheme="http://www.istarx.cn/categories/%E7%A8%8B%E5%BA%8F%E7%8C%BF%E8%BF%9B%E5%8C%96%E4%B9%8B%E8%B7%AF/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="è‡ªåŠ¨åŒ–æµ‹è¯•" scheme="http://www.istarx.cn/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/"/>
    
      <category term="unit-test" scheme="http://www.istarx.cn/tags/unit-test/"/>
    
  </entry>
  
  <entry>
    <title>å•å…ƒæµ‹è¯•å¸¸ç”¨æ³¨é‡Š</title>
    <link href="http://www.istarx.cn/2018/04/24/unit-test-annotation/"/>
    <id>http://www.istarx.cn/2018/04/24/unit-test-annotation/</id>
    <published>2018-04-24T14:09:24.000Z</published>
    <updated>2019-02-18T16:57:29.318Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>ä¹‹å‰å¯¹å•å…ƒæµ‹è¯•åšäº†ä¸€ä¸ªç®€å•çš„ä»‹ç»ï¼Œå¹¶è¯´æ˜äº†ç¼–å†™å•å…ƒæµ‹è¯•çš„é‡è¦æ€§ã€‚æœ¬æ–‡ä¸»è¦å¯¹å•å…ƒæµ‹è¯•å¸¸ç”¨çš„æ³¨é‡Šåšä¸ªå°ç»“å’Œç¬”è®°å¹¶åˆ†äº«ã€‚</p><a id="more"></a><p><ul class="toc js-fixedContent"><li><a href="#%E5%9F%BA%E6%9C%AC%E6%B3%A8%E9%87%8A">åŸºæœ¬æ³¨é‡Š</a><ul><li><a href="#%E5%BC%82%E5%B8%B8%E6%B5%8B%E8%AF%95-expteted">å¼‚å¸¸æµ‹è¯•  expteted</a></li><li><a href="#%E8%B6%85%E6%97%B6%E6%B5%8B%E8%AF%95-timeout">è¶…æ—¶æµ‹è¯•  timeout</a></li><li><a href="#%E5%88%86%E7%B1%BB%E6%B5%8B%E8%AF%95category">åˆ†ç±»æµ‹è¯•<code>@Category</code></a></li><li><a href="#%E5%8F%82%E6%95%B0%E6%B5%8B%E8%AF%95parameters">å‚æ•°æµ‹è¯•<code>@Parameters</code></a></li><li><a href="#%E5%BF%BD%E7%95%A5%E6%B5%8B%E8%AF%95ignore">å¿½ç•¥æµ‹è¯•<code>@Ignore</code></a></li><li><a href="#%E5%A5%97%E4%BB%B6%E6%B5%8B%E8%AF%95">å¥—ä»¶æµ‹è¯•</a></li></ul></li><li><a href="#%E5%B0%8F%E7%BB%93">å°ç»“</a></li></ul></p><h2 id="åŸºæœ¬æ³¨é‡Š"><a class="anchor" href="#åŸºæœ¬æ³¨é‡Š"></a> åŸºæœ¬æ³¨é‡Š</h2><p>Junit æµ‹è¯•æ¡†æ¶æ˜¯ä¸šç•Œä½¿ç”¨è¾ƒä¸ºå¹¿æ³›çš„ä¸€ä¸ªå•å…ƒæµ‹è¯•æ¡†æ¶ï¼ŒAndroid æµ‹è¯•æ”¯æŒåº“ä¸­ä¹Ÿé›†æˆäº†è¯¥æµ‹è¯•æ¡†æ¶ã€‚JUnit æ¡†æ¶ä¸ºäº†æ–¹ä¾¿ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œæä¾›äº†ä¸€äº›å…¬å…±çš„æµ‹è¯•ï¼š</p><ul><li><code>@Before</code>: æµ‹è¯•ç”¨ä¾‹åˆå§‹åŒ–æ“ä½œï¼Œåœ¨æµ‹è¯•ç±»å†…éƒ¨çš„æ¯ä¸ªæµ‹è¯•æ–¹æ³•è¿è¡Œä¹‹å‰éƒ½ä¼šè¿è¡Œä¸€æ¬¡è¯¥åˆå§‹åŒ–æ–¹æ³•ï¼Œå¯ä»¥å®šä¹‰å¤šä¸ªä»¥@Beforeæ³¨é‡Šçš„æ–¹æ³•ï¼›</li><li><code>@After</code>: æµ‹è¯•ç”¨ä¾‹æ”¶å°¾ï¼ŒåŒ…æ‹¬é‡Šæ”¾èµ„æºå’Œå†…å­˜ç­‰ã€‚åœ¨æµ‹è¯•ç±»å†…éƒ¨çš„æ¯ä¸ªæµ‹è¯•æ–¹æ³•è¿è¡Œä¹‹åéƒ½ä¼šè¿è¡Œä¸€æ¬¡è¯¥åˆå§‹åŒ–æ–¹æ³•ï¼Œå¯ä»¥å®šä¹‰å¤šä¸ªä»¥@Afteræ³¨é‡Šçš„æ–¹æ³•ï¼›</li><li><code>@Test</code>: ä¸€æ¡æµ‹è¯•ç”¨ä¾‹;</li><li><code>@BeforeClass</code>: æµ‹è¯•çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œå’Œ@Beforeçš„åŒºåˆ«åœ¨äºï¼š@BeforeClassæ³¨é‡Šçš„æ–¹æ³•åœ¨æ•´ä¸ªæµ‹è¯•ç±»ä¸­åªè¿è¡Œä¸€æ¬¡ï¼Œä¸»è¦ç”¨äºä¸€äº›æ¯”è¾ƒè€—æ—¶æˆ–è€…è€—è´¹èµ„æºçš„æ“ä½œï¼›</li><li><code>@AfterClass</code>: æµ‹è¯•çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œå’Œ@Afterçš„åŒºåˆ«åœ¨äºï¼š@AfterClassæ³¨é‡Šçš„æ–¹æ³•åœ¨æ•´ä¸ªæµ‹è¯•ç±»ä¸­åªè¿è¡Œä¸€æ¬¡ï¼Œä¸»è¦ç”¨æ¥é‡Šæ”¾èµ„æºï¼›</li></ul><p>æ‰€ä»¥æ•´ä¸ªæµ‹è¯•ç±»çš„è¿è¡Œæµç¨‹å¦‚ä¸‹ï¼š</p><p><img src="test-run-process.png" alt="test-run-process"></p><p>å‡è®¾ä¸€ä¸ªæµ‹è¯•ç±»ä¸­æœ‰åä¸º testMethod1ï½testMethod3 çš„ä¸‰ä¸ªæµ‹è¯•æ–¹æ³•ï¼Œæ¯ä¸ªæµ‹è¯•æ–¹æ³•ã€@Beforeã€@Afterã€@BeforeClassã€@AfterClassæ³¨é‡Šçš„æ–¹æ³•éƒ½æ‰“å°å„è‡ªçš„æ–¹æ³•åï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@BeforeClass</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">beforeClass</span><span class="params">()</span> </span>&#123; System.out.println(<span class="string">"beforeClass method running..."</span>); &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@AfterClass</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">afterClass</span><span class="params">()</span> </span>&#123; System.out.println(<span class="string">"afterClass method running..."</span>); &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Before</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123; System.out.println(<span class="string">"setUp method running..."</span>); &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@After</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tearDown</span><span class="params">()</span> </span>&#123; System.out.println(<span class="string">"tearDown method running..."</span>); &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMethod1</span><span class="params">()</span> </span>&#123; System.out.println(<span class="string">"testMethod1 testing..."</span>); &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMethod2</span><span class="params">()</span> </span>&#123; System.out.println(<span class="string">"testMethod1 testing..."</span>); &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMethod3</span><span class="params">()</span> </span>&#123; System.out.println(<span class="string">"testMethod1 testing..."</span>); &#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="annotation-test-result.png" alt="annotation-test-result"></p><div class="alert warning"><p>è™½ç„¶åœ¨ <code>@BeforeClass</code>ä¸­å¯ä»¥åˆå§‹åŒ–ä¸€äº›å…¨å±€å˜é‡ï¼Œä½†æ˜¯ä¸ä»‹æ„è¿™ä¹ˆåšï¼Œå› ä¸ºå¦‚æœ new ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒæ—¶è¿™ä¸ªå¯¹è±¡å†…éƒ¨æŒæœ‰é™æ€å˜é‡ï¼Œåˆ™å¯èƒ½æµ‹è¯•ç”¨ä¾‹ä¹‹é—´å› ä¸ºè¿™ä¸ªé™æ€å˜é‡çš„æ”¹å˜ç›¸äº’å½±å“è€Œå¯¼è‡´æµ‹è¯•ä¸å‡†ç¡®ã€‚</p></div><p>é™¤äº†ä¸Šè¿°æ³¨é‡Šä»¥å¤–ï¼ŒJUnit æ¡†æ¶è¿˜æä¾›äº†å…¶å®ƒä¸€äº›æ³¨é‡Šï¼š</p><h3 id="å¼‚å¸¸æµ‹è¯•-expteted"><a class="anchor" href="#å¼‚å¸¸æµ‹è¯•-expteted"></a> å¼‚å¸¸æµ‹è¯•  expteted</h3><p><code>å¼‚å¸¸æµ‹è¯•</code>æ˜¯æŒ‡éªŒè¯å½“å‰è¢«æµ‹è¯•ä»£ç æˆ–è€…æµ‹è¯•ä»£ç ä¼šæŠ›å‡ºä¸€ä¸ªç‰¹å®šçš„å¼‚å¸¸ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æœŸå¾…æ­¤ç”¨ä¾‹æŠ›å‡º AssertionError å¼‚å¸¸, åªæœ‰æŠ›å‡ºè¯¥å¼‚å¸¸ï¼Œç”¨ä¾‹æ‰ç®—æˆåŠŸ</span></span><br><span class="line"><span class="meta">@Test</span>(expected = AssertionError.class) </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">exceptionTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertEquals(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ç”¨ä¾‹åªæœ‰ä¸€ä¸ªæ–­è¨€è¯­å¥ï¼Œåœ¨æµ‹è¯•çš„è¿‡ç¨‹ä¸­è¿™ä¸ªæ–­è¨€è¯­å¥å¿…å®šä¼šæŠ›å‡º <code>AssertionError</code>å¼‚å¸¸ï¼Œæˆ‘ä»¬åœ¨<code>@Test</code>æ³¨é‡Šçš„æ—¶å€™æ·»åŠ æˆ‘ä»¬å¯¹è¯¥æ¡æµ‹è¯•ç”¨ä¾‹æ‰€æœŸå¾…çš„å¼‚å¸¸ï¼Œå³<code>AssertionError.class</code></p><h3 id="è¶…æ—¶æµ‹è¯•-timeout"><a class="anchor" href="#è¶…æ—¶æµ‹è¯•-timeout"></a> è¶…æ—¶æµ‹è¯•  timeout</h3><p><code>è¶…æ—¶æµ‹è¯•</code> æ˜¯æŒ‡ å¯ä»¥å¯¹ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹è¿è¡Œæ—¶é—´è¿›è¡Œæµ‹è¯•ï¼Œè¶…è¿‡è§„å®šæ—¶é—´åˆ™è®¤ä¸ºè¯¥æµ‹è¯•ç”¨ä¾‹å¤±è´¥ã€‚å¯ä»¥ç”¨æ¥æµ‹è¯•ç½‘ç»œæ•°æ®è¯»å–æ—¶é—´æˆ–è€…æ•°æ®åº“è¯»å–å­˜å‚¨ç­‰ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span> (timeout = <span class="number">800</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">timeoutTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ç”¨ä¾‹ä¸­å†™äº†ä¸€ä¸ª while æ­»å¾ªç¯ï¼Œå¦‚æœä¸æŒ‡å®šè¶…æ—¶æ—¶é—´ï¼Œè¯¥ç”¨ä¾‹å°†ä¼šæ— é™è¿è¡Œä¸‹å»ï¼ŒçŸ¥é“æ‰‹åŠ¨ç»ˆæ­¢ã€‚åŒæ—¶æŒ‡å®šè¯¥ç”¨ä¾‹æ—¶é—´å¿…é¡»æ˜¯ &lt;= 800msï¼Œå½“ç”¨ä¾‹è¿è¡Œæ—¶é—´è¶…è¿‡ 800ms æ—¶ï¼Œåˆ¤å®šè¯¥æµ‹è¯•ç”¨ä¾‹ä¸ºå¤±è´¥ã€‚</p><h3 id="åˆ†ç±»æµ‹è¯•category"><a class="anchor" href="#åˆ†ç±»æµ‹è¯•category"></a> åˆ†ç±»æµ‹è¯•<code>@Category</code></h3><p><code>åˆ†ç±»æµ‹è¯•</code> æ˜¯æŒ‡å¯ä»¥å¯¹æµ‹è¯•ç”¨ä¾‹è¿›è¡Œåˆ†ç±»ï¼Œå¯¹æµ‹è¯•ç”¨ä¾‹æˆ–è€…æµ‹è¯•ç±»æ·»åŠ  <code>@Category({CategoryA.class, CategoryB.class}, ...)</code>å¯¹å…¶è¿›è¡Œåˆ†ç±» ,ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰ä¸¤ä¸ªCategory</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Category1</span> </span>&#123; String TAG = <span class="string">"Category1"</span>; <span class="comment">/* marker */</span>  &#125; </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Category2</span> </span>&#123; String TAG = <span class="string">"Category2"</span>; <span class="comment">/* marker */</span>  &#125;</span><br><span class="line"><span class="comment">// å®šä¹‰ä¸¤ä¸ªæµ‹è¯•ç”¨ä¾‹ä»¥åŠåˆ†ç±»</span></span><br><span class="line"><span class="meta">@Category</span>(&#123;Category1.class, Category2.class&#125;) </span><br><span class="line"><span class="comment">// æ‰€æœ‰æ­¤æµ‹è¯•ç±»å†…éƒ¨çš„æµ‹è¯•ç”¨ä¾‹éƒ½å±äºä¸¤ä¸ªç±»åˆ«</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestA</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">methodA</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// do some test here</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestB</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Category</span>(Category1.class) <span class="comment">// å¯¹æ–¹æ³•å•ç‹¬çŸ¥é“åˆ†ç±»</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">methodB1</span><span class="params">()</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Category</span>(Category2.class)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">methodB2</span><span class="params">()</span> </span>&#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å»ºç«‹åˆ†ç±»æµ‹è¯•é›†</span></span><br><span class="line"><span class="meta">@RunWith</span>(Categories.class)</span><br><span class="line"><span class="meta">@Suite</span>.SuiteClasses(&#123;TestA.class, TestB.class&#125;)</span><br><span class="line"><span class="meta">@Categories</span>.IncludeCategory(Category1.class)</span><br><span class="line"><span class="meta">@Categories</span>.ExcludeCategory(Category2.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category1TestSuit</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è¿è¡Œ TestB.methodB1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith</span>(Categories.class)</span><br><span class="line"><span class="meta">@Suite</span>.SuiteClasses(&#123;TestA.class,TestB.class&#125;)</span><br><span class="line"><span class="meta">@Categories</span>.IncludeCategory(&#123;Category2.class&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category2TestSuit</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åªè¿è¡Œ TestA.methodA å’Œ TestB.methodB2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‚æ•°æµ‹è¯•parameters"><a class="anchor" href="#å‚æ•°æµ‹è¯•parameters"></a> å‚æ•°æµ‹è¯•<code>@Parameters</code></h3><p>å‚æ•°æµ‹è¯•éœ€è¦åœ¨æµ‹è¯•ç±»å†…éƒ¨å…ˆå£°æ˜éœ€è¦çš„å‚æ•°ï¼Œå¹¶ä¸”éœ€è¦æ„é€ å‡½æ•°è¿›è¡Œå¤åˆ¶ï¼ŒåŒæ—¶éœ€è¦ä¸€ä¸ª<code>@Parameters</code>è¯¸äº‹çš„æ–¹æ³•è¿›çŸ¥é“å‚æ•°çš„å–å€¼ï¼Œåšå¥½è¿™äº›ï¼Œå‰©ä½™çš„äº‹æƒ…å°±ç”± JUnit æ¥å®Œæˆäº†ã€‚ä»¥ä¸‹ä¾‹å­ä¸ºè®¡ç®—ä¸€ä¸ªç®€å•çš„è®¡ç®—ç®€ç§°çš„æµ‹è¯•ï¼Œæœ‰ä¸€ä¸ªè¾“å…¥å’Œä¸€ä¸ªè¾“å‡ºï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(Parameterized.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ParameterTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> inputNum;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> expectedResult;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ParameterTest</span><span class="params">(<span class="keyword">int</span> inputNum, <span class="keyword">int</span> expectedResult)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.inputNum = inputNum;</span><br><span class="line">        <span class="keyword">this</span>.expectedResult = expectedResult;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Parameterized</span>.Parameters</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Collection <span class="title">getParaList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Arrays.asList(<span class="keyword">new</span> Object[][]&#123;</span><br><span class="line">                &#123;<span class="number">0</span>, <span class="number">1</span>&#125;,</span><br><span class="line">                &#123;<span class="number">1</span>, <span class="number">1</span>&#125;,</span><br><span class="line">                &#123;<span class="number">2</span>, <span class="number">2</span>&#125;,</span><br><span class="line">                &#123;<span class="number">5</span>, <span class="number">120</span>&#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">factorialTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        assertEquals(expectedResult, calculate(inputNum));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">calculate</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (num == <span class="number">0</span> || num == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> num * calculate(num - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¿½ç•¥æµ‹è¯•ignore"><a class="anchor" href="#å¿½ç•¥æµ‹è¯•ignore"></a> å¿½ç•¥æµ‹è¯•<code>@Ignore</code></h3><p>å½“åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­å¯èƒ½åœ¨æŸäº›æƒ…å†µä¸‹éœ€è¦è·³è¿‡ä¸€æ¡æµ‹è¯•ç”¨ä¾‹ã€æˆ–è€…ä¸€ä¸ªæµ‹è¯•ç±»ä¸è®©å…¶æ‰§è¡Œã€‚å½“æŸä¸€æ¡æµ‹è¯•ç”¨ä¾‹ã€ä¸€ä¸ªæµ‹è¯•ç±»ä»¥<code>@Ignore</code>æ³¨é‡Šæ—¶ï¼Œæ­¤ç”¨ä¾‹ã€æˆ–è€…æ­¤æµ‹è¯•ç±»å†…éƒ¨æ‰€æœ‰çš„æµ‹è¯•ç”¨ä¾‹ä¸ä¼šè¢«æ‰§è¡Œã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@Ignore</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ignoreTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// do some test here, but it not run.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¥—ä»¶æµ‹è¯•"><a class="anchor" href="#å¥—ä»¶æµ‹è¯•"></a> å¥—ä»¶æµ‹è¯•</h3><p>å¥—ä»¶æµ‹è¯•ä¸ªåˆ†ç±»æµ‹è¯•æœ‰ç‚¹ç±»ä¼¼ã€‚åˆ†ç±»æµ‹è¯•æ—¶æŠŠç±»ä¼¼åŠŸèƒ½çš„ç”¨ä¾‹åˆ†ç±»åˆ°ä¸€èµ·ï¼Œè€Œå¥—ä»¶æµ‹è¯•åˆ™æ˜¯æŠŠä¸€ä¸ªæˆ–å¤šä¸ªæµ‹è¯•ç±»é›†ä¸­åœ¨ä¸€èµ·è¿è¡Œã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// test calss A</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestA</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">methodA</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// do some test here</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// test class B</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestB</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">methodB1</span><span class="params">()</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">methodB2</span><span class="params">()</span> </span>&#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å®šä¹‰æµ‹è¯•é›†</span></span><br><span class="line"><span class="meta">@RunWith</span>(Suite.class)</span><br><span class="line"><span class="meta">@Suite</span>.SuiteClasses(&#123;TestA.class, TestB.class&#125;) <span class="comment">// åŒ…å« TestA å’Œ TestB ä¸¤ä¸ªæµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SuitTestClass</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è¿è¡Œ TestA.methodA, TestB.methodB1 ä»¥åŠ TestB.methodB2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="suite-test-result.png" alt="suite-test-result"></p><h2 id="å°ç»“"><a class="anchor" href="#å°ç»“"></a> å°ç»“</h2><p>JUnit æ¡†æ¶å®šä¹‰äº†è®¸å¤šæ³¨é‡Šï¼Œç»™æµ‹è¯•å¸¦æ¥äº†å¾ˆå¤§æ–¹ä¾¿ï¼Œå¯ä»¥åˆ©ç”¨è¿™äº›æ³¨é‡Šæ¥ç¼–å†™æ›´å…¨é¢ã€æ›´ä¼˜é›…ä»¥åŠæ›´èƒ½è¾¾åˆ°æµ‹è¯•ç›®çš„çš„æµ‹è¯•ç”¨ä¾‹ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¹‹å‰å¯¹å•å…ƒæµ‹è¯•åšäº†ä¸€ä¸ªç®€å•çš„ä»‹ç»ï¼Œå¹¶è¯´æ˜äº†ç¼–å†™å•å…ƒæµ‹è¯•çš„é‡è¦æ€§ã€‚æœ¬æ–‡ä¸»è¦å¯¹å•å…ƒæµ‹è¯•å¸¸ç”¨çš„æ³¨é‡Šåšä¸ªå°ç»“å’Œç¬”è®°å¹¶åˆ†äº«ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç¨‹åºçŒ¿è¿›åŒ–ä¹‹è·¯" scheme="http://www.istarx.cn/categories/%E7%A8%8B%E5%BA%8F%E7%8C%BF%E8%BF%9B%E5%8C%96%E4%B9%8B%E8%B7%AF/"/>
    
      <category term="è‡ªåŠ¨åŒ–æµ‹è¯•" scheme="http://www.istarx.cn/categories/%E7%A8%8B%E5%BA%8F%E7%8C%BF%E8%BF%9B%E5%8C%96%E4%B9%8B%E8%B7%AF/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="unit-test" scheme="http://www.istarx.cn/tags/unit-test/"/>
    
  </entry>
  
  <entry>
    <title>Andoid ProGuard</title>
    <link href="http://www.istarx.cn/2018/04/19/android-proguard/"/>
    <id>http://www.istarx.cn/2018/04/19/android-proguard/</id>
    <published>2018-04-19T13:22:34.000Z</published>
    <updated>2019-02-18T17:05:39.449Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æœ€è¿‘å…¬å¸å¯¹é¡¹ç›®ä½¿ç”¨ Proguard å·¥å…·åšä»£ç ä¼˜åŒ–åŠæ··æ·†ï¼Œæ­£å¥½ç§°è¿™ä¸ªæœºä¼šå­¦ä¹ äº†ä¸‹ä¸€ä»£ç æ··æ·†æ–¹é¢çš„çŸ¥è¯†ï¼Œé¡ºä¾¿åšä¸ªç¬”è®°ï¼Œåˆ†äº«ä¸€ä¸‹ã€‚</p><a id="more"></a><p><ul class="toc js-fixedContent"><li><a href="#proguard-%E7%AE%80%E4%BB%8B">Proguard ç®€ä»‹</a></li><li><a href="#%E5%88%A9%E7%94%A8-proguard-%E5%A4%84%E7%90%86%E6%BA%90%E4%BB%A3%E7%A0%81">åˆ©ç”¨ Proguard å¤„ç†æºä»£ç </a><ul><li><a href="#%E5%88%A9%E7%94%A8bin%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84%E8%84%9A%E6%9C%AC%E5%90%AF%E5%8A%A8">åˆ©ç”¨<code>bin</code>ç›®å½•ä¸‹çš„è„šæœ¬å¯åŠ¨</a></li><li><a href="#%E5%88%A9%E7%94%A8-java-%E5%91%BD%E4%BB%A4%E5%90%AF%E5%8A%A8">åˆ©ç”¨ java å‘½ä»¤å¯åŠ¨</a></li><li><a href="#%E5%88%A9%E7%94%A8-proguard-gui-%E8%BF%9B%E8%A1%8C%E4%BB%A3%E7%A0%81%E5%A4%84%E7%90%86">åˆ©ç”¨ Proguard GUI è¿›è¡Œä»£ç å¤„ç†</a></li><li><a href="#android-%E5%BC%80%E5%90%AF-proguard">Android å¼€å¯ Proguard</a><ul><li><a href="#gradle-%E9%85%8D%E7%BD%AE">Gradle é…ç½®</a></li><li><a href="#%E6%B7%B7%E6%B7%86%E7%BB%93%E6%9E%9C">æ··æ·†ç»“æœ</a></li></ul></li></ul></li><li><a href="#%E9%85%8D%E7%BD%AE%E9%80%89%E9%A1%B9">é…ç½®é€‰é¡¹</a><ul><li><a href="#filter">filter</a></li><li><a href="#class-specifications">Class Specifications</a></li><li><a href="#filename-include-filename">@filename/-include filename</a></li><li><a href="#-basedirectory">-basedirectory</a></li><li><a href="#-injars-outjars-libraryjars">-injars/-outjars/-libraryjars</a></li><li><a href="#-skipnonpubliclibraryclasses-dontskipnonpubliclibraryclasses-dontskipnonpubliclibraryclassmembers">-skipnonpubliclibraryclasses/-dontskipnonpubliclibraryclasses/-dontskipnonpubliclibraryclassmembers</a></li><li><a href="#-printconfiguration-printseeds">-printconfiguration/-printseeds</a></li><li><a href="#keep-%E9%80%89%E9%A1%B9">keep é€‰é¡¹</a></li><li><a href="#shrink-%E8%BF%87%E7%A8%8B%E9%80%89%E9%A1%B9">Shrink è¿‡ç¨‹é€‰é¡¹</a></li><li><a href="#optimization-%E8%BF%87%E7%A8%8B%E9%80%89%E9%A1%B9">Optimization è¿‡ç¨‹é€‰é¡¹</a></li><li><a href="#obfuscation-%E8%BF%87%E7%A8%8B%E9%80%89%E9%A1%B9">Obfuscation è¿‡ç¨‹é€‰é¡¹</a></li><li><a href="#%E9%A2%84%E6%A3%80%E8%BF%87%E7%A8%8B%E9%80%89%E9%A1%B9">é¢„æ£€è¿‡ç¨‹é€‰é¡¹</a></li><li><a href="#general-options">General Options</a></li></ul></li></ul></p><h2 id="proguard-ç®€ä»‹"><a class="anchor" href="#proguard-ç®€ä»‹"></a> Proguard ç®€ä»‹</h2><p>Proguard æ˜¯é›†å‹ç¼©ã€ä¼˜åŒ–ã€æ··æ·†ã€é¢„æ£€ç­‰åŠŸèƒ½äºä¸€èº«çš„å·¥å…·ï¼Œä¸»è¦æ˜¯å¯¹ä»£ç è¿›è¡Œå‹ç¼©ã€ä¼˜åŒ–ã€æ··æ·†ï¼Œä»¥è¾¾åˆ°ä¼˜åŒ–è¿è¡Œï¼Œé˜²æ­¢åç¼–è¯‘çš„ç›®çš„ã€‚å®ƒå¯ä»¥åˆ é™¤æ— ç”¨çš„å˜é‡ã€æ–¹æ³•ã€ç±»ä»¥åŠèµ„æºï¼Œåˆ é™¤æ— ç”¨çš„log ä»¥åŠæ³¨é‡Šï¼Œæœ€å¤§ç¨‹åº¦çš„å‡å°‘å­—èŠ‚ç æ–‡ä»¶çš„å¤§å°ã€‚åœ¨ Android ä¸­ç”¨æ¥å‡å° apk å¤§å°ã€æå‡è¿è¡Œé€Ÿåº¦ä»¥åŠå¢åŠ åç¼–è¯‘éš¾åº¦ï¼Œå®˜æ–¹çš„æè¿°æ˜¯æœ€å¤§èƒ½å‡å°‘90%ä»¥åŠè¿è¡Œé€Ÿåº¦åŠ å¿«20%ã€‚</p><p><img src="proguard-processing.gif" alt="proguard-processing"></p><ul><li>å‹ç¼©é˜¶æ®µï¼šåœ¨è½¯ä»¶å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œå› ä¸ºéœ€æ±‚å˜æ›´æˆ–è€…ä¿®æ”¹ bugï¼Œæ€»ä¼šæˆ–å¤šæˆ–å°‘ä¿ç•™ä¸€äº›æ²¡æ¥å¾—åŠåˆ é™¤çš„æ— ç”¨ä»£ç ï¼Œæˆ–è€…å¼•ç”¨çš„ç¬¬ä¸‰æ–¹åŒ…ä¸­æœ‰è®¸å¤šæ— ç”¨çš„ä»£ç ã€‚å‹ç¼©é˜¶æ®µæ­£æ˜¯å¯¹ä¸åœ¨è§„åˆ™æ–‡ä»¶å†…ä¿ç•™çš„ï¼Œå¹¶ä»£ç å†…æ²¡æœ‰ä½¿ç”¨çš„ç±»ã€æ–¹æ³•ã€å˜é‡ç­‰è¿›è¡Œæ¸…é™¤ï¼›</li><li>ä¼˜åŒ–é˜¶æ®µï¼šè¯¥é˜¶æ®µä¼šåˆ†æå¹¶ä¼˜åŒ–å­—èŠ‚ç æ–‡ä»¶ï¼Œå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®ä¼˜åŒ–ç®—æ³•ä»¥åŠä¼˜åŒ–æ¬¡æ•°ï¼›</li><li>æ··æ·†é˜¶æ®µï¼šæ”¹é˜¶æ®µä¼šå°†æ˜“è¯»çš„ç±»åã€æ–¹æ³•åã€å˜é‡åç­‰æ›¿æ¢ä¸ºç®€çŸ­å¹¶æ— æ„ä¹‰çš„å•ä¸ªå­—æ¯æˆ–è€…å­—æ¯ç»„åˆï¼Œåœ¨è¯¥æ­¥éª¤ä¸­è¿˜ä¼šé‡å†™ä»£ç ä¸­çš„éƒ¨åˆ†é€»è¾‘ï¼Œæ‰“ä¹±ä»£ç æ ¼å¼ï¼Œä»è€Œå¸¦åˆ°æ··æ·†çš„ç›®çš„ï¼›</li><li>é¢„æ£€é˜¶æ®µï¼šåœ¨ç±»ä¸­æ·»åŠ é¢„æ ¡éªŒä¿¡æ¯ï¼Œé¢„æ ¡éªŒä¿¡æ¯åœ¨ java 6ç‰ˆæœ¬ä»¥ä¸Šæˆ–è€…Java Micro Editionç‰ˆæœ¬ä¸Šæ˜¯å¿…é¡»çš„ï¼›</li></ul><p>ä»¥ä¸Šå››ä¸ªæ­¥éª¤éƒ½å¯ä»¥é€šè¿‡é…ç½®è¿›è¡Œå–èˆï¼Œå¯ä»¥é€‰æ‹©å…¶ä¸­çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªé˜¶æ®µå¯¹ä»£ç è¿›è¡Œå¤„ç†ã€‚å¯¹äºæŒ‡å®šçš„ Library Jarï¼Œåœ¨å¤„ç†å‰åæ˜¯ä¿æŒä¸å˜çš„ã€‚</p><h2 id="åˆ©ç”¨-proguard-å¤„ç†æºä»£ç "><a class="anchor" href="#åˆ©ç”¨-proguard-å¤„ç†æºä»£ç "></a> åˆ©ç”¨ Proguard å¤„ç†æºä»£ç </h2><p>Proguard å·¥å…·åˆå¤šç§ä½¿ç”¨æ–¹å¼ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨åˆ°å¾ˆå¤šç±»å‹çš„å·¥ç¨‹ (javaã€Androidç­‰)ã€‚åœ¨ä½¿ç”¨ Proguard å·¥å…·ä¹‹å‰éœ€è¦å…ˆåˆ°<a href="https://sourceforge.net/projects/proguard/files/">å®˜ç½‘</a>è¿›è¡Œä¸‹è½½(æœ€æ–°ç‰ˆæœ¬6.0.2)ï¼Œä¸‹è½½çš„å‹ç¼©åŒ…è§£å‹ä¹‹åç›®å½•å¦‚ä¸‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">.</span>                 </span><br><span class="line"><span class="string">â”œâ”€â”€</span> <span class="string">README</span>        <span class="comment"># å¸®åŠ©æ–‡æ¡£         </span></span><br><span class="line"><span class="string">â”œâ”€â”€</span> <span class="string">annotations</span>   <span class="comment"># è§„åˆ™æ–‡ä»¶ä¸­ç”¨åˆ°çš„æ³¨é‡Šï¼Œå¦‚ -keepï¼Œ -keepClassMembersç­‰</span></span><br><span class="line"><span class="string">â”œâ”€â”€</span> <span class="string">ant</span>           <span class="comment"># ant æ’ä»¶</span></span><br><span class="line"><span class="string">â”œâ”€â”€</span> <span class="string">bin</span>           <span class="comment"># windowã€linux æ‰€ç”¨åˆ°çš„è„šæœ¬</span></span><br><span class="line"><span class="string">â”œâ”€â”€</span> <span class="string">buildscripts</span>  <span class="comment"># ç¼–è¯‘æºç æ‰€ç”¨åˆ°çš„æ–‡ä»¶</span></span><br><span class="line"><span class="string">â”œâ”€â”€</span> <span class="string">core</span>          <span class="comment"># æºä»£ç </span></span><br><span class="line"><span class="string">â”œâ”€â”€</span> <span class="string">docs</span>          <span class="comment"># å¸®åŠ©æ–‡æ¡£ï¼Œä»‹ç»ä»¥åŠä½¿ç”¨æ–¹æ³•ç›¸å…³æ–‡æ¡£éƒ½åœ¨è¿™ä¸ªç›®å½•ä¸‹  </span></span><br><span class="line"><span class="string">â”œâ”€â”€</span> <span class="string">examples</span>      <span class="comment"># ä¸€äº›å¸¸è§åº”ç”¨çš„è§„åˆ™æ–‡ä»¶ä¾‹å­</span></span><br><span class="line"><span class="string">â”œâ”€â”€</span> <span class="string">gradle</span>        <span class="comment"># gradle æ’ä»¶</span></span><br><span class="line"><span class="string">â”œâ”€â”€</span> <span class="string">gui</span>           <span class="comment"># ProGuard/ReTrace GUI</span></span><br><span class="line"><span class="string">â”œâ”€â”€</span> <span class="string">lib</span>           <span class="comment"># jar åŒ…</span></span><br><span class="line"><span class="string">â”œâ”€â”€</span> <span class="string">retrace</span>       <span class="comment"># reTrace å·¥å…·ï¼Œåˆ©ç”¨mapæ–‡ä»¶æŠŠæ··æ·†ä¹‹åçš„ log ç­‰æ¢å¤åˆ°æºä»£ç </span></span><br><span class="line"><span class="string">â””â”€â”€</span> <span class="string">wtk</span>           <span class="comment"># wtk æ’ä»¶</span></span><br></pre></td></tr></table></figure><div class="alert warning"><p>å¦‚æœå·²ç»é…ç½®å¥½ Android ç¯å¢ƒå¹¶ä¸‹è½½äº† Android Sdkï¼Œåˆ™<code>&lt;ANDROID_HOME&gt;/tools/proguard</code>ç›®å½•å³ä¸º Proguard å·¥å…·ï¼Œç›®å½•ç»“æ„ç¨å¾®æœ‰ç‚¹åŒºåˆ«ã€‚</p></div><p>å¯ä»¥åˆ©ç”¨ <code>bin</code>ç›®å½•ä¸‹çš„è„šæœ¬ã€åˆ©ç”¨ java å‘½ä»¤æˆ–è€…åˆ©ç”¨å…¶å®ƒæ–¹å¼æ‰§è¡Œ Proguard å·¥å…·ã€‚</p><h3 id="åˆ©ç”¨binç›®å½•ä¸‹çš„è„šæœ¬å¯åŠ¨"><a class="anchor" href="#åˆ©ç”¨binç›®å½•ä¸‹çš„è„šæœ¬å¯åŠ¨"></a> åˆ©ç”¨<code>bin</code>ç›®å½•ä¸‹çš„è„šæœ¬å¯åŠ¨</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">cd examples/standalone</span><br><span class="line">../../bin/proguard.sh <span class="meta">@proguard</span>.pro</span><br></pre></td></tr></table></figure><p>å…¶ä¸­<code>@proguard.pro</code>æ˜¯æŒ‡è§„åˆ™æ–‡ä»¶æˆ–è€…é…ç½®æ–‡ä»¶ã€‚</p><h3 id="åˆ©ç”¨-java-å‘½ä»¤å¯åŠ¨"><a class="anchor" href="#åˆ©ç”¨-java-å‘½ä»¤å¯åŠ¨"></a> åˆ©ç”¨ java å‘½ä»¤å¯åŠ¨</h3><p>åˆ©ç”¨å‘½ä»¤è¡Œå¯¹ä»£ç è¿›è¡Œå¤„ç†ï¼Œåªéœ€è¦ç®€å•çš„è¾“å…¥ä»¥ä¸‹å‘½ä»¤å³å¯ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> proguard</span><br><span class="line">java -jar proguard.jar -injars &lt;file_name&gt; &lt;options&gt;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>-injars</code> å‚æ•°å¯ä»¥æŒ‡å®šè‡³å°‘ä¸€ä¸ªè¾“å…¥ï¼ŒæŒ‡å®šè¢«å¤„ç†çš„æºæ–‡ä»¶ï¼Œ<code>options</code>å¯é€‰æ‹©æ€§çš„æ·»åŠ ä¾‹å¦‚<code>-verbose</code>ã€<code>-libraryjars</code>ç­‰ï¼Œåé¢ä¼šè¯´åˆ°ã€‚åŒæ—¶è¿˜å¯ä»¥åˆ©ç”¨<code>-outjars</code>æŒ‡å®šè¾“å‡ºåŒ…ã€‚</p><p>å¦å¤–åœ¨ä¸Šè¿°å‘½ä»¤æ‰§è¡Œçš„æ—¶å€™ä¼šè¯»å–ä¸€ä¸ªé»˜è®¤çš„è§„åˆ™æ–‡ä»¶ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥çŸ¥é“ç‰¹å®šçš„è§„åˆ™æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">java -jar proguard.jar -injars &lt;file_name&gt; @config.pro &lt;options&gt;</span><br></pre></td></tr></table></figure><p>åœ¨ <code>proguard/example/standalone</code>æ–‡ä»¶å¤¹ä¸‹æœ‰å¸¸ç”¨çš„è§„åˆ™æ–‡ä»¶ã€‚åœ¨è§„åˆ™æ–‡ä»¶ä¸­å¯ä»¥åŒ…å«æ‰€æœ‰çš„<code>options</code>é€‰é¡¹ï¼Œä¹Ÿå¯ä»¥åœ¨å…¶ä¸­è§„å®šå“ªäº›ç±»ã€æ–¹æ³•ã€å˜é‡ç­‰éœ€è¦ä¿ç•™åŸå§‹çŠ¶æ€ã€‚</p><h3 id="åˆ©ç”¨-proguard-gui-è¿›è¡Œä»£ç å¤„ç†"><a class="anchor" href="#åˆ©ç”¨-proguard-gui-è¿›è¡Œä»£ç å¤„ç†"></a> åˆ©ç”¨ Proguard GUI è¿›è¡Œä»£ç å¤„ç†</h3><p>Proguard GUI çš„å¯åŠ¨ä¹Ÿæœ‰ä¸¤ç§æ–¹æ³•ï¼Œé€šè¿‡ bin ç›®å½•ä¸‹çš„è„šæœ¬å¯åŠ¨æˆ–è€…é€šè¿‡ java å‘½ä»¤å¯åŠ¨ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./bin/proguardgui.sh <span class="comment"># widows å¯ä»¥ç›´æ¥åŒå‡» proguardgui.bat</span></span><br><span class="line"><span class="comment"># æˆ–</span></span><br><span class="line">java -jar ./lib/proguardgui.jar [-nosplash]</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>[-nosplash]</code>é€‰é¡¹å¯ä»¥å…³é—­ GUI å¼€å¯åŠ¨ç”»ã€‚Proguard GUI ç•Œé¢å¦‚ä¸‹ï¼š<br><img src="proguard-gui1.gif" alt="proguard-gui1"></p><ul><li><code>ProGuard</code> - é¦–ç•Œé¢ï¼Œå¯ä»¥åŠ è½½è§„åˆ™(é…ç½®)æ–‡ä»¶ï¼›</li><li><code>Input/Output</code> - è¾“å…¥/è¾“å‡ºç•Œé¢ï¼ŒåŒ…æ‹¬ Program è¾“å…¥ã€Library è¾“å…¥æ–‡ä»¶ä»¥åŠè¾“å‡ºä½ç½®ï¼Œè¾“å…¥å¯ä»¥æ˜¯ <code>jar</code>ã€<code>aar</code>ã€æ–‡ä»¶å¤¹ç­‰ï¼›</li><li><code>Shrinking</code> - å‹ç¼©é€‰é¡¹è®¾ç½®ç•Œé¢ï¼Œå¯ä»¥æ‰“å° usage ï¼Œå¯ä»¥ä¿ç•™ä¾‹å¦‚æšä¸¾ enumã€Servlet ç­‰ ï¼Œå…¶ä¸­æœ‰è®¸å¤š Android ç‰¹æœ‰çš„é€‰é¡¹ï¼Œä¾‹å¦‚ Activityã€Layout ä»¥åŠ Library ç­‰ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ·»åŠ ç±»ä»¥åŠç±»æˆå‘˜ï¼›</li><li><code>Obfuscation</code> - æ··æ·†é€‰é¡¹è®¾ç½®ç•Œé¢ï¼Œå¯ä»¥é€‰æ‹©æ‰“å° <code>map</code>æ–‡ä»¶ä»¥æ–¹ä¾¿ log åˆ†æï¼Œä¹Ÿå¯ä»¥é€šè¿‡ <code>-applymapping</code> é€‰é¡¹ä»å·²æœ‰çš„ map æ–‡ä»¶è¿›è¡Œæ··æ·†ï¼Œä¹Ÿå¯ä»¥æ·»åŠ è¦ä¿ç•™çš„ç±»ã€æ–¹æ³•ç­‰ï¼›</li><li><code>Optimization</code> - ä¼˜åŒ–é€‰é¡¹è®¾ç½®ç•Œé¢ï¼Œå¯ä»¥é€‰æ‹©ç§»é™¤çš„æ–¹æ³•è°ƒç”¨ï¼Œä¾‹å¦‚ logã€Systemã€Math ç­‰ç±»çš„æ–¹æ³•ï¼›</li><li><code>Information</code> - å®šä¹‰ä¸€äº›è·å–å…¶å®ƒä¿¡æ¯çš„é€‰é¡¹ï¼Œä¾‹å¦‚<code>-verbose</code>ã€<code>-ignorewarnings</code>ç­‰ï¼›</li><li><code>Process</code> - æŸ¥çœ‹å¹¶ä¿å­˜é…ç½®æ–‡ä»¶ï¼›</li><li><code>ReTrace</code> - åæ··æ·†ï¼Œå¯ä»¥åˆ©ç”¨ map æ–‡ä»¶æŠŠæ··æ·†ä¹‹åçš„é”™è¯¯æ ˆåæ··æ·†ï¼›</li></ul><h3 id="android-å¼€å¯-proguard"><a class="anchor" href="#android-å¼€å¯-proguard"></a> Android å¼€å¯ Proguard</h3><p>Android Studio åœ¨å¿ƒé—´å·¥ç¨‹çš„æ—¶å€™é»˜è®¤ä¼šåœ¨<code>app</code>ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª<code>proguard-rules.pro</code>æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ä¸ºé»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼Œåœ¨ build.gradle æ–‡ä»¶ä¸­å·²ç»æŒ‡å®šäº†è¯¥é…ç½®æ–‡ä»¶ã€‚</p><h4 id="gradle-é…ç½®"><a class="anchor" href="#gradle-é…ç½®"></a> Gradle é…ç½®</h4><p>Gradle ä¸­æœ‰ä¸¤ä¸ªå±æ€§<code>minifyEnabled</code>å’Œ<code>shrinkResources</code>ä¸“é—¨ç”¨æ¥æ§åˆ¶æ··æ·†åŠå‹ç¼©ï¼Œè¿˜æœ‰ä¸€ä¸ª<code>zipAlignEnabled</code>å±æ€§æ§åˆ¶ ZipAlign ä¼˜åŒ–ã€‚Android ä¸­å¼€å¯ Proguard åªéœ€åœ¨<code>build.gradle</code>æ–‡ä»¶ä¸­çš„<code>android.buildTypes.release</code>é—­åŒ…ä¸‹æŠŠè¿™ä¸¤ä¸ªå±æ€§å€¼ç½®ä¸º<code>true</code>ï¼Œå¹¶ä¸”æŒ‡å®š proguard è§„åˆ™æ–‡ä»¶å³å¯ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            minifyEnabled <span class="keyword">true</span></span><br><span class="line">            shrinkResources <span class="keyword">true</span></span><br><span class="line">            zipAlignEnabled <span class="keyword">true</span></span><br><span class="line">            <span class="function">proguardFiles <span class="title">getDefaultProguardFile</span><span class="params">(<span class="string">'proguard-android.txt'</span>)</span>, 'proguard-rules.pro' <span class="comment">// â‘ </span></span></span><br><span class="line"><span class="function">        &#125;</span></span><br><span class="line"><span class="function">    &#125;</span></span><br><span class="line"><span class="function">&#125;</span></span><br></pre></td></tr></table></figure><p>â‘ å¤„çš„<code>proguardFiles</code>å±æ€§å¯ä»¥æŒ‡å®šæ–‡ä»¶åä¸º<code>proguard-rules.pro</code>çš„è§„åˆ™æ–‡ä»¶ï¼Œæ–‡ä»¶åå¯ä»¥æ›´æ¢ä¸ºå…¶å®ƒï¼Œè¯¥æ–‡ä»¶åœ¨<code>app</code>ç›®å½•ä¸‹ï¼š</p><p><img src="proguard-rule-file.gif" alt="proguard-rule-file"></p><p>è¯¥è§„åˆ™æ–‡ä»¶ä¸­é»˜è®¤æ²¡æœ‰æ·»åŠ ä»»ä½•æœ‰æ•ˆè§„åˆ™ã€‚åœ¨ gradle æ–‡ä»¶ä¸­å¼€å¯ ProGuard æ—¶ï¼Œä¼šé»˜è®¤æ·»åŠ  <code>proguard-defaults.txt</code>ã€<code>proguard-android.txt</code>ã€<code>proguard-android-optimize.txt</code>ä¸‰ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸‰ä¸ªæ–‡ä»¶åœ¨<code>${sdk.home}\tools\proguard\</code>ç›®å½•å’Œ<code>Gradleæ’ä»¶</code>ä¸­éƒ½æœ‰ï¼ŒåŒºåˆ«åœ¨äºåœ¨ Gradle æ’ä»¶ 2.2 ç‰ˆæœ¬ä¹‹åï¼ŒProguard ä¼šé»˜è®¤æ·»åŠ  <code>Gradleæ’ä»¶</code>ä¸­é›†æˆçš„æ–‡ä»¶ï¼Œè€Œä¸ä½¿ç”¨ SDK ç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶ã€‚</p><p><code>proguard-android.txt</code>ã€<code>proguard-android-optimize.txt</code>ä¸¤ä¸ªæ–‡ä»¶çš„åŒºåˆ«åœ¨äºåè€…å¼€å¯äº†ä¼˜åŒ–é€‰é¡¹ï¼Œå³å»é™¤äº†<code>proguard-android.txt</code>æ–‡ä»¶ä¸­çš„<code>-dontoptimize</code>é…ç½®ï¼Œå¹¶æŒ‡å®šä¼˜åŒ–ç®—æ³•ä»¥åŠæ·»åŠ ä¼˜åŒ–æ¬¡æ•°<code>-optimizationpasses</code>ï¼Œé»˜è®¤ä¸º5ã€‚</p><h4 id="æ··æ·†ç»“æœ"><a class="anchor" href="#æ··æ·†ç»“æœ"></a> æ··æ·†ç»“æœ</h4><p>å¯¹ç»Ÿä¸€ä¸ªåº”ç”¨ä»£ç ï¼Œä¸åšä»»ä½•æ”¹åŠ¨çš„æƒ…å†µä¸‹ï¼Œä¸ä½¿ç”¨ Proguard å’Œä½¿ç”¨ Proguard ç”Ÿæˆçš„ APK å¯¹æ¯”å¦‚ä¸‹ï¼š</p><p><img src="proguardresult.png" alt="proguardresult"></p><p>å¯ä»¥çœ‹åˆ° APK å¤§å°å‡å°‘äº†700KBå·¦å³ï¼Œå¾ˆå¤šå¤šä½™çš„ç±»ã€èµ„æºè¢«åˆ é™¤ï¼Œæœªåœ¨é…ç½®è§„åˆ™æ–‡ä»¶å†…çš„ç±»ä»¥åŠæ–¹æ³•è¢«æ··æ·†ä¸ºæ— æ„ä¹‰çš„å­—æ¯ï¼Œå¦‚<code>a</code>æˆ–è€…<code>a$a</code>ç­‰ã€‚</p><h2 id="é…ç½®é€‰é¡¹"><a class="anchor" href="#é…ç½®é€‰é¡¹"></a> é…ç½®é€‰é¡¹</h2><p>åœ¨å‹ç¼©ã€ä¼˜åŒ–é˜¶æ®µï¼ŒProguard ä¼šæ ¹æ®è§„åˆ™æ–‡ä»¶(ä¹Ÿå°±æ˜¯<code>proguard-rules.pro</code>æ–‡ä»¶)è§‰å¾—å“ªäº›ç±»ã€æ–¹æ³•ã€å˜é‡ç­‰éœ€è¦ä¿ç•™ï¼Œå“ªäº›éœ€è¦ä¼˜åŒ–æˆ–è€…æ··æ·†ã€‚Proguard å·¥å…·æä¾›äº†å¸¸ç”¨çš„ä¸€äº›æ¨¡ç‰ˆï¼Œåœ¨<code>examples/</code>ç›®å½•ä¸‹ï¼Œé™¤äº†å·¥å…·è‡ªå¸¦çš„ä¸€äº›æ„å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é’ˆå¯¹ä¸åŒçš„é¡¹ç›®ç¼–å†™ä¸åŒçš„é…ç½®æ–‡ä»¶ã€‚</p><h3 id="filter"><a class="anchor" href="#filter"></a> filter</h3><p>åœ¨é…ç½®æ–‡ä»¶ä¸­çš„é€‰é¡¹ä¸­ï¼Œæœ‰äº›æ˜¯æ”¯æŒ filterçš„ï¼Œå’Œæ­£åˆ™è¡¨è¾¾å¼æœ‰ç‚¹ç±»ä¼¼ï¼Œä¸»è¦æœ‰ä»¥ä¸‹ä¸€äº›ï¼š</p><table><thead><tr><th>å­—ç¬¦æˆ–é€‰é¡¹</th><th style="text-align:left">å«ä¹‰</th></tr></thead><tbody><tr><td><code>?</code></td><td style="text-align:left">åŒ¹é…ä»»æ„ä¸€ä¸ªå­—ç¬¦</td></tr><tr><td><code>*</code></td><td style="text-align:left">åŒ¹é…ä»»æ„ä¸ªäººä¸€å¤šä¸ªå­—ç¬¦ï¼Œä¸»è¦ç”¨æ¥åŒ¹é…ç±»åã€æ–¹æ³•åæˆ–è€…æˆå‘˜å˜é‡ï¼ŒåŒ¹é…ç±»åçš„æ—¶å€™ä¸åŒ…å«åŒ…åç¬¦å·<code>.</code></td></tr><tr><td><code>**</code></td><td style="text-align:left">åŒ¹é…ä»»æ„å¤šä¸ªå­—ç¬¦ï¼ŒåŒ…å«åŒ…ååˆ†éš”ç¬¦<code>.</code></td></tr><tr><td><code>***</code></td><td style="text-align:left">ç”¨æ¥åŒ¹é…æ‰€æœ‰çš„ç±»å‹ï¼ŒåŒ…æ‹¬åŸå§‹æ•°æ®ç±»å‹è¿˜æ˜¯å…¶å®ƒï¼Œä¹Ÿå¯ä»¥åŒ¹é…æ•°ç»„</td></tr><tr><td><code>%</code></td><td style="text-align:left">åŒ¹é…ä»»æ„çš„åŸå§‹æ•°æ®ç±»å‹ï¼Œä½†æ˜¯ä¸èƒ½åŒ¹é…åˆ° <code>void</code></td></tr><tr><td><code>...</code></td><td style="text-align:left">åŒ¹é…ä»»æ„å¤šä¸ªå‚æ•°</td></tr><tr><td><code>&lt;init&gt;</code></td><td style="text-align:left">åŒ¹é…æ„é€ å‡½æ•°ï¼Œå¯ä»¥ç”¨ä¿®é¥°ç¬¦ä¿®é¥°ï¼Œä¹Ÿå¯ç”¨å‚æ•°æŒ‡å®šç‰¹å®šçš„æ„é€ å‡½æ•°</td></tr><tr><td><code>&lt;methods&gt;</code></td><td style="text-align:left">åŒ¹é…æ‰€æœ‰çš„æ–¹æ³•ï¼Œå¯ä»¥ç”¨ä¿®é¥°ç¬¦ä¿®é¥°</td></tr><tr><td><code>fields</code></td><td style="text-align:left">åŒ¹é…æ‰€æœ‰çš„æˆå‘˜å˜é‡</td></tr></tbody></table><p>ä¾‹å¦‚ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">-keep public <span class="class"><span class="keyword">class</span> <span class="title">cc</span>.<span class="title">istarx</span>.<span class="title">Test</span>? # åŒ¹é…ç±»åä»¥ <span class="title">test</span> å¼€å¤´ï¼Œå¹¶ä¸” <span class="title">test</span> åé¢åªæœ‰ä¸€ä¸ªå­—ç¬¦çš„ç±»</span></span><br><span class="line">-keep public class cc.istarx.Test* # åŒ¹é…ç±»åä»¥ test å¼€å¤´ï¼Œå¹¶ä¸” test åé¢çš„å­—ç¬¦ä¸ªæ•° &gt;= 0 çš„ç±»</span><br><span class="line">-keep public <span class="class"><span class="keyword">class</span> <span class="title">cc</span>.<span class="title">istarx</span>.**    # åŒ¹é… <span class="title">cc</span>.<span class="title">istarx</span> åŒ…ä¸‹æ‰€æœ‰çš„ç±»</span></span><br><span class="line">-keep public class cc.istarx.Test &#123;</span><br><span class="line">    public &lt;init&gt;(%); <span class="comment"># åŒ¹é… public çš„ï¼Œä¸”å‚æ•°ä¸ºåŸå§‹æ•°æ®ç±»å‹çš„æ„é€ å‡½æ•°</span></span><br><span class="line">    public testMethod(int,String,...); <span class="comment"># åŒ¹é… publicï¼Œåˆ‡è‡³å°‘æœ‰ä¸¤ä¸ªå‚æ•°ç±»å‹ä¸º intã€String çš„æ–¹æ³•</span></span><br><span class="line">&#125;</span><br><span class="line">-keep public class cc.istarx.Test1 &#123;</span><br><span class="line">    public &lt;methods&gt;; <span class="comment"># åŒ¹é…æ‰€æœ‰çš„ public æ–¹æ³•</span></span><br><span class="line">    &lt;fields&gt;; <span class="comment"># åŒ¹é…æ‰€æœ‰çš„å˜é‡</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="class-specifications"><a class="anchor" href="#class-specifications"></a> Class Specifications</h3><p>åœ¨è§„åˆ™æ–‡ä»¶ä¸­ï¼Œä¸€ä¸ª class å¯ä»¥é€šè¿‡æ³¨é‡Šã€ä¿®é¥°ç¬¦ç­‰è¿›è¡Œé™å®šï¼Œè¿™äº›é€‰é¡¹éƒ½æ˜¯å¯é€‰çš„ï¼Œå¯ä»¥åœ¨é€‚å½“çš„æ—¶å€™å€ŸåŠ© filter è¿›è¡Œé™å®šï¼Œå¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">[@annotationtype] [[!]public|final|abstract|@ ...] [!]interface|class|enum classname [extends|implements [@annotationtype] classname]</span><br><span class="line">[&#123;</span><br><span class="line">    [<span class="meta">@annotationtype</span>] [[!]<span class="keyword">public</span>|<span class="keyword">private</span>|<span class="keyword">protected</span>|<span class="keyword">static</span>|<span class="keyword">volatile</span>|<span class="keyword">transient</span> ...] &lt;fields&gt; |(fieldtype fieldname);</span><br><span class="line">    [<span class="meta">@annotationtype</span>] [[!]<span class="keyword">public</span>|<span class="keyword">private</span>|<span class="keyword">protected</span>|<span class="keyword">static</span>|<span class="keyword">synchronized</span>|<span class="keyword">native</span>|<span class="keyword">abstract</span>|<span class="keyword">strictfp</span> ...] &lt;methods&gt; |&lt;init&gt;(argumenttype,...) | classname(argumenttype,...) | (<span class="function">returntype <span class="title">methodname</span><span class="params">(argumenttype,...)</span>)</span>;</span><br><span class="line">    [<span class="meta">@annotationtype</span>] [[!]<span class="keyword">public</span>|<span class="keyword">private</span>|<span class="keyword">protected</span>|<span class="keyword">static</span> ... ] *;</span><br><span class="line">    ...</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure><h3 id="filename-include-filename"><a class="anchor" href="#filename-include-filename"></a> @filename/-include filename</h3><p>è¿™ä¸¤ä¸ªé…ç½®é€‰é¡¹æ˜¯åŒä¸€ä¸ªæ„æ€ï¼Œéƒ½æ˜¯ä» filename æ–‡ä»¶ä¸­è¯»å–é…ç½®é€‰é¡¹ã€‚</p><h3 id="-basedirectory"><a class="anchor" href="#-basedirectory"></a> -basedirectory</h3><p>åé¢å¯ä»¥è·Ÿä¸€ä¸ªæ–‡ä»¶å¤¹ä½ç½®ï¼Œå®šä¹‰ä¸€ä¸ªåŸºç¡€çš„æ–‡ä»¶ä½ç½®ï¼Œå¦‚æœå®šä¹‰äº†è¯¥å±æ€§ï¼Œåˆ™è¯¥é…ç½®æ–‡ä»¶ä¸­çš„åœ°å€éƒ½æ˜¯ç›¸å¯¹äºè¯¥æ–‡ä»¶å¤¹æ¥è¿›è¡Œç›¸å¯¹å®šä½çš„ã€‚</p><figure class="highlight haml"><table><tr><td class="code"><pre><span class="line">-<span class="ruby">basedirectory ~<span class="regexp">/app/</span></span></span><br></pre></td></tr></table></figure><h3 id="-injars-outjars-libraryjars"><a class="anchor" href="#-injars-outjars-libraryjars"></a> -injars/-outjars/-libraryjars</h3><p>æŒ‡å®šè¾“å…¥ã€è¾“å‡ºã€Library æ–‡ä»¶ä½ç½®ï¼Œå¯ä»¥ç”¨å¤šè¡ŒæŒ‡å®šä¸åŒçš„è¾“å…¥/è¾“å‡ºæ–‡ä»¶ï¼Œå¦‚æœå®šä¹‰<code>-basedirectory</code>é€‰é¡¹ï¼Œåˆ™å¯ä»¥å†™ç›¸å¯¹åœ°å€ã€‚è¾“å…¥è¾“å‡ºçš„æ–‡ä»¶ç±»å‹å¯ä»¥æ˜¯ jarsã€aarsã€warsã€earsã€zipsã€apks æˆ–è€…æ–‡ä»¶å¤¹ã€‚é€šè¿‡ <code>injars</code> æŒ‡å®šçš„æ–‡ä»¶ï¼Œç»è¿‡å‹ç¼©ã€ä¼˜åŒ–ã€æ··æ·†ï¼Œè¾“å‡ºåˆ° <code>outjars</code> æŒ‡å®šçš„æ–‡ä»¶ä¸­ã€‚</p><div class="alert warning"><p>ä¸‰ä¸ªé…ç½®å¯ä»¥åŒæ—¶å‡ºç°ï¼Œå¯ä»¥æŒ‡å®šå¤šä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯ä¸èƒ½å‡ºç°æŒ‡å®šçš„æ–‡ä»¶ç›¸åŒï¼ŒåŒæ—¶è¿™ä¸‰ä¸ªé…ç½®é€‰é¡¹è¿˜æ”¯æŒ filterã€‚</p></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">-injars libs/class1.jar(cc/istarx/**.<span class="keyword">class</span>)</span><br><span class="line">-outjars libs/outclass1.jar</span><br><span class="line">-injars libs/class2.jar(!cc/istarx/**.<span class="keyword">class</span>)</span><br><span class="line">-outjars libs/outclass2.jar</span><br><span class="line"><span class="comment"># å¯ä»¥æˆç»„æŒ‡å®š injars å’Œ outjarsï¼Œä»¥ä¸Šä¸º libs/class1.jar è¾“å‡ºåˆ° outclass1.jarï¼Œclass2.jar æ–‡ä»¶å†…å®¹è¾“å‡ºåˆ° outclass2.jar ä¸­</span></span><br><span class="line">-outjars libs/outerror.jar <span class="comment"># å› ä¸ºä¸Šä¸€ outjar æ²¡æœ‰ filterï¼Œæ‰€æœ‰æ‰€æœ‰çš„è¾“å‡ºéƒ½åˆ° outclass1.jar ä¸­ï¼Œä¸èƒ½å†æ¥ç€æŒ‡å®š -outjars</span></span><br></pre></td></tr></table></figure><h3 id="-skipnonpubliclibraryclasses-dontskipnonpubliclibraryclasses-dontskipnonpubliclibraryclassmembers"><a class="anchor" href="#-skipnonpubliclibraryclasses-dontskipnonpubliclibraryclasses-dontskipnonpubliclibraryclassmembers"></a> -skipnonpubliclibraryclasses/-dontskipnonpubliclibraryclasses/-dontskipnonpubliclibraryclassmembers</h3><p>åœ¨è¯»å– library æ–‡ä»¶æ—¶ï¼Œæ˜¯å¦è·³è¿‡éå…¬å…±çš„ç±»æˆ–è€…ç±»æˆå‘˜ï¼Œå½“ skip æ—¶å¯ä»¥æé«˜ proguard å¤„ç†çš„æ•ˆç‡ä»¥åŠå†…å­˜ä½¿ç”¨ç‡ã€‚å¦‚æœ library ä¸­çš„éå…¬æœ‰ç±»æ˜¯ injars ä¸­æŒ‡å®šçš„æ–‡ä»¶ä¸­æ²¡æœ‰ä½¿ç”¨ï¼Œåˆ™è·³è¿‡ä¹‹åå¯¹è¾“å‡ºæ²¡ä»€ä¹ˆå½±å“ï¼Œä½†æ˜¯å¾ˆä¸å¹¸çš„æ˜¯æœ‰å¾ˆå¤šä»£ç éƒ½é›†æˆæˆ–å¼•ç”¨äº†éå…¬æœ‰ç±»æˆ–å…¶ä¸­çš„å˜é‡ï¼Œæ‰€ä»¥åœ¨ 4.5 ç‰ˆæœ¬ä¹‹åï¼Œ<code>-dontskipnonpubliclibraryclasses</code>ä¸ºé»˜è®¤é…ç½®ã€‚</p><h3 id="-printconfiguration-printseeds"><a class="anchor" href="#-printconfiguration-printseeds"></a> -printconfiguration/-printseeds</h3><p>åé¢æ¥ä¸€ä¸ªæ–‡ä»¶åœ°å€ï¼ŒæŒ‡å®šè¦ä¿å­˜å½“å‰çš„é…ç½®æ–‡ä»¶ä»¥åŠæ‰€æœ‰ç”¨åˆ°çš„ç±»ã€æ–¹æ³•ã€å˜é‡ç­‰ï¼›</p><figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">-printconfiguration <span class="keyword">out</span>/config.<span class="keyword">pro</span></span><br><span class="line">-printseeds <span class="keyword">out</span>/seed.txt</span><br></pre></td></tr></table></figure><h3 id="keep-é€‰é¡¹"><a class="anchor" href="#keep-é€‰é¡¹"></a> keep é€‰é¡¹</h3><p><code>keep</code> é€‰é¡¹ä¸»è¦æ˜¯æŒ‡å®šè¦ä¿ç•™çš„ç±»æˆ–æ–¹æ³•æˆ–è€…å˜é‡ç­‰ï¼Œè¯¥é€‰é¡¹åé¢å¯ä»¥è·Ÿç±»çš„ä¿®é¥°ç¬¦ï¼Œè¿˜å¯ä»¥æ”¯æŒ filterã€‚</p><ul><li><p><code>-keep</code> - ä¿ç•™ä¸€ä¸ªç‰¹å®šçš„ç±»ï¼ŒåŒ…æ‹¬æ–¹æ³•å’Œæˆå‘˜å˜é‡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ filter æŒ‡å®šä¿ç•™ä¸€ä¸ªåŒ…ä¸‹æ‰€æœ‰çš„ç±»åŠç±»å†…éƒ¨çš„æ–¹æ³•ã€æˆå‘˜å˜é‡ç­‰ä¸€åˆ‡ï¼›</p></li><li><p><code>-keepclassmembers</code>  - æŒ‡å®šè¦ä¿ç•™çš„ç±»æˆå‘˜ï¼Œå¦‚æœå®ƒä»¬çš„ç±»ä¹Ÿä¿ç•™;</p></li><li><p><code>-keepclasseswithmembers</code> - å½“æŒ‡å®šçš„ç±»æˆ–è€…æˆå‘˜å­˜åœ¨çš„è¯ä¿ç•™è¯¥ç±»å’Œæˆå‘˜;</p></li><li><p><code>-keepnames</code> - å’Œ<code>-keep,allowshrinking</code>æ˜¯åŒæ ·çš„ä½œç”¨ï¼Œè¡¨ç¤ºä¿ç•™å½“å‰ç±»ï¼ŒåŒæ—¶å…è®¸åˆ é™¤æ— ç”¨çš„æ–¹æ³•ã€å˜é‡ç­‰ï¼›</p></li><li><p><code>keepclassmembernames</code> - å’Œ<code>-keepclassmembers,allowshrinking</code>æ˜¯åŒæ ·çš„ä½œç”¨;</p></li><li><p><code>keepclasseswithmembernames</code> - å’Œ<code>-keepclasseswithmembers,allowshrinking</code>æ˜¯åŒæ ·çš„ä½œç”¨;</p></li><li><p><code>-if</code> - 6.0ç‰ˆæœ¬æ–°åŠ å…¥çš„å‚æ•°ï¼Œé…åˆ keep è¿›è¡Œä½¿ç”¨ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœ **$$ViewBinder ç±»å­˜åœ¨ï¼Œåˆ™ä¿ç•™</span></span><br><span class="line">-if class **$$ViewBinder</span><br><span class="line">-keep <span class="class"><span class="keyword">class</span> &lt;1&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="shrink-è¿‡ç¨‹é€‰é¡¹"><a class="anchor" href="#shrink-è¿‡ç¨‹é€‰é¡¹"></a> Shrink è¿‡ç¨‹é€‰é¡¹</h3><table><thead><tr><th>é€‰é¡¹</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>-dontshrink</code></td><td>å…³é—­ Shrinké€‰é¡¹</td></tr><tr><td><code>-printusage</code></td><td>æ‰“å°ä½¿ç”¨æƒ…å†µï¼Œåªæœ‰åœ¨ Shrink çš„æ—¶æ‰èµ·ä½œç”¨ï¼Œå¯ä»¥æŒ‡å®šæ–‡ä»¶(å¯é€‰)</td></tr><tr><td><code>-whyareyoukeeping</code></td><td>åœ¨ Shrink çš„è¿‡ç¨‹ä¸­æ‰“å°ä¸ºä»€ä¹ˆ keep çš„è¯¦ç»†æƒ…å†µï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹åªæ‰“å°æŒ‡å®šæ–¹æ³•æˆ–è€…å˜é‡çš„ç®€çŸ­ä¿¡æ¯ï¼Œå½“å¼€å¯<code>-verbose</code>é€‰é¡¹æ—¶ä¼šæ‰“å°æ–¹æ³•çš„å…¨éƒ¨ç­¾åä¿¡æ¯</td></tr></tbody></table><h3 id="optimization-è¿‡ç¨‹é€‰é¡¹"><a class="anchor" href="#optimization-è¿‡ç¨‹é€‰é¡¹"></a> Optimization è¿‡ç¨‹é€‰é¡¹</h3><ul><li><p><code>-dontoptimize</code> - ä¸å¼€å¯ä¼˜åŒ–è¿‡ç¨‹ï¼›</p></li><li><p><code>optimizations</code> - æŒ‡å®šä¼˜åŒ–é€‰é¡¹ï¼Œå¯é€‰é¡¹æœ‰å¦‚ä¸‹è¿™äº›ï¼Œå¯ä»¥ç”¨<code>!</code>ç¬¦å·å…³é—­æŸä¸ªä¼˜åŒ–ï¼Œå¦‚<code>!code/merging</code>:</p><p><img src="optimize-fields.png" alt="optimize-fields"></p></li><li><p><code>-optimizationpasses</code> - æŒ‡å®šä¼˜åŒ–æ¬¡æ•°ï¼›</p></li><li><p><code>-assumenosideeffects</code> - æŒ‡å®šåˆ é™¤ä¸€ä¸ªç±»æˆ–è€…æ–¹æ³•ï¼Œå½“æ­¤æ–¹æ³•ç­¾åä¸­æœ‰è¿”å›å€¼ï¼Œä½†æ˜¯è°ƒç”¨è¯¥æ–¹æ³•çš„åœ°æ–¹æ²¡æœ‰ç”¨åˆ°è¯¥è¿”å›å€¼ï¼Œåˆ™åˆ é™¤è¯¥æ–¹æ³•ï¼Œæ¯”è¾ƒå®¹æ˜“æŠ¥é”™çš„ä¸€ä¸ªé€‰é¡¹ï¼Œè¦æ…é‡ä½¿ç”¨ã€‚è¯¥é€‰é¡¹ä¸ä¼šå¤„ç† Library çš„ä»£ç ã€‚ä¾‹å¦‚å¯ä»¥ä½¿ç”¨æ­¤é€‰é¡¹åˆ é™¤logç›¸å…³çš„è¯­å¥ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">-assumenosideeffects <span class="class"><span class="keyword">class</span> <span class="title">android</span>.<span class="title">util</span>.<span class="title">Log</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isLoggable</span><span class="params">(java.lang.String, <span class="keyword">int</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">v</span><span class="params">(...)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">i</span><span class="params">(...)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">w</span><span class="params">(...)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">d</span><span class="params">(...)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">e</span><span class="params">(...)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><code>-assumenoexternalsideeffects</code> - å’Œ<code>-assumenosideeffects</code>ç±»ä¼¼ï¼ŒæŒ‡å®šé™¤äº†è°ƒç”¨çš„å®ä¾‹ä»¥å¤–æ²¡æœ‰ä»»ä½•å‰¯ä½œç”¨çš„æ–¹æ³•ï¼Œproguard åœ¨è¯¥æ–¹æ³•æ— ç”¨æ—¶ä¼šè¿›è¡Œåˆ é™¤ï¼›</p></li><li><p><code>-assumenoexternalreturnvalues</code> - æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿”å›çš„å¼•ç”¨å˜é‡ä¸åœ¨å †ä¸­çš„æ–¹æ³•ï¼Œå¯ä»¥å¯¹è¯¥æ–¹æ³•è¿›è¡Œä¼˜åŒ–ï¼›</p></li><li><p><code>-allowaccessmodification</code> - å…è®¸åœ¨å¤„ç†æœŸé—´å¯ä»¥æ‰©å±•ç±»å’Œç±»æˆå‘˜çš„è®¿é—®ä¿®é¥°ç¬¦ï¼Œå¯ä»¥æé«˜ä¼˜åŒ–ç»“æœï¼›</p></li><li><p><code>-mergeinterfacesaggressively</code> - æŒ‡å®šå¯ä»¥åˆå¹¶æ¥å£ï¼Œå³ä½¿å®ƒä»¬çš„å®ç°ç±»ä¸å®ç°æ‰€æœ‰æ¥å£æ–¹æ³•ï¼Œé€šè¿‡å‡å°‘ç±»çš„æ€»æ•°æ¥å‡å°‘è¾“å‡ºçš„å¤§å°ã€‚</p></li></ul><h3 id="obfuscation-è¿‡ç¨‹é€‰é¡¹"><a class="anchor" href="#obfuscation-è¿‡ç¨‹é€‰é¡¹"></a> Obfuscation è¿‡ç¨‹é€‰é¡¹</h3><table><thead><tr><th>é€‰é¡¹</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>-dontobfuscate</code></td><td>å…³é—­æ··æ·†æ­¥éª¤</td></tr><tr><td><code>-printmapping</code></td><td>æ‰“å°æ··æ·†çš„mapæ–‡ä»¶ï¼Œç”¨æ¥åˆ†ælogï¼Œåæ··æ·†</td></tr><tr><td><code>-applymapping</code></td><td>ä»å·²æœ‰çš„mapæ–‡ä»¶è¿›è¡Œæ··æ·†</td></tr><tr><td><code>-obfuscationdictionary</code></td><td>æŒ‡å®šä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶ä¸­æ‰€æœ‰æœ‰æ•ˆå•è¯ç”¨ä½œæ··æ·†å­—æ®µå’Œæ–¹æ³•åç§°ï¼Œæ­£å¸¸æƒ…å†µä¸‹æ··æ·†ä¼šä½¿ç”¨aã€bç­‰ä½œä¸ºæ··æ·†ç»“æœï¼Œé€šè¿‡å­—å…¸æ–‡ä»¶ï¼Œå¯ä»¥æŒ‡å®šè¦ä¿ç•™çš„å…³é”®å­—åˆ—è¡¨ï¼Œ#åçš„ç©ºç™½ï¼Œæ ‡ç‚¹ç¬¦å·ï¼Œé‡å¤å•è¯å’Œæ³¨é‡Šè¢«å¿½ç•¥ã€‚å‡ ä¹ä¸èƒ½æé«˜æ··æ·†ç»“æœã€‚</td></tr><tr><td><code>-classobfuscationdictionary</code></td><td>æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ä¸­çš„æœ‰æ•ˆå•è¯å°†ä½œä¸ºç±»åæ··æ·†çš„ç»“æœ</td></tr><tr><td><code>-packageobfuscationdictionary</code></td><td>åŒä¸Šï¼Œä¸è¿‡æŒ‡å®šçš„æ˜¯pacakgeå</td></tr><tr><td><code>-dontusemixedcaseclassnames</code></td><td>æŒ‡å®šåœ¨æ··æ·†æ—¶ä¸ç”Ÿæˆæ··åˆå¤§å°å†™çš„ç±»åã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ··æ·†çš„ç±»åå¯ä»¥åŒ…å«å¤§å†™å­—ç¬¦å’Œå°å†™å­—ç¬¦çš„æ··åˆã€‚Windows ä¸Šéœ€è¦å¼€å¯ï¼Œå› ä¸ºwindowsæ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„</td></tr><tr><td><code>-keeppackagenames</code></td><td>ä¸æ··æ·†åŒ…åï¼Œå¯ä»¥åˆ©ç”¨ filter æŒ‡å®šå“ªäº›ç‰¹ç‚¹çš„åŒ…åä¸éœ€è¦æ··æ·†</td></tr><tr><td><code>-flattenpackagehierarchy</code></td><td>é‡æ–°è¿›è¡Œæ‰“åŒ…ï¼Œå¯¹åŒ…åè¿›è¡Œé‡å‘½åï¼Œå‚æ•°ä¸ºç©ºå­—ç¬¦ä¸²æ—¶ï¼Œæ‰€æœ‰çš„æ–‡ä»¶å°†ç§»åŠ¨åˆ°æ ¹åŒ…ä¸‹ï¼Œå¦åˆ™åŸºç¡€åŒ…åå°†ä¼šé‡å‘½åä¸ºå‚æ•°æŒ‡å®šçš„åŒ…åã€‚</td></tr><tr><td><code>-repackageclasses</code></td><td>å°†åŒ…é‡Œçš„ç±»æ··æ·†æˆnä¸ªå†é‡æ–°æ‰“åŒ…åˆ°ä¸€ä¸ªç»Ÿä¸€çš„packageä¸­  ä¼šè¦†ç›–<code>-flattenpackagehierarchy</code> é€‰é¡¹</td></tr><tr><td><code>-keepattributes</code></td><td>éœ€è¦ä¿ç•™çš„ä¸€äº›ç‰¹å®šçš„å±æ€§ï¼Œå¦‚ï¼š SourceFileã€ LineNumberTableç­‰ï¼Œæ”¯æŒ filter</td></tr><tr><td><code>-keepparameternames</code></td><td>ä¿ç•™æ‰€ä¿å­˜æ–¹æ³•çš„å‚æ•°åç§°å’Œç±»å‹</td></tr><tr><td><code>-useuniqueclassmembernames</code></td><td>å¯¹äºç±»æˆ–è€…å˜é‡æ¥è¯´ï¼Œå¦‚æœæºä»£ç ä¸­æœ‰ç›¸åŒçš„åç§°ï¼Œåˆ™åœ¨æ··æ·†ä¹‹åä¹Ÿå…·æœ‰ç›¸åŒçš„åç§°</td></tr><tr><td><code>-renamesourcefileattribute</code></td><td>æŒ‡å®šä¸€ä¸ªå­—ç¬¦ä¸²æ›¿æ¢<code>SourceFile</code>å±æ€§</td></tr></tbody></table><h3 id="é¢„æ£€è¿‡ç¨‹é€‰é¡¹"><a class="anchor" href="#é¢„æ£€è¿‡ç¨‹é€‰é¡¹"></a> é¢„æ£€è¿‡ç¨‹é€‰é¡¹</h3><ul><li><code>-dontpreverify</code> - ä¸è¿›è¡Œé¢„æ£€ï¼›</li><li><code>-microedition</code> - æŒ‡å®šä¸º Java Micro Edition ç‰ˆæœ¬ï¼›</li><li><code>-android</code> - æŒ‡å®šè¿‡ç¨‹æ—¶é’ˆå¯¹ Android å¹³å°ï¼›</li></ul><h3 id="general-options"><a class="anchor" href="#general-options"></a> General Options</h3><table><thead><tr><th>é€‰é¡¹</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>-verbose</code></td><td>åœ¨å¤„ç†è¿‡ç¨‹ä¸­æ‰“å°ä¿¡æ¯ï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶ã€å¤„ç†ç»“æœç­‰</td></tr><tr><td><code>-dontnote</code></td><td>å…³é—­ note ï¼Œå¯ä»¥é…åˆ filter æŒ‡å®šå…³é—­æŸä¸ªåŒ…ã€ç±»çš„ noteï¼Œå…³é—­æ‰€æœ‰çš„ note ç”¨ <code>***</code></td></tr><tr><td><code>-dontwarn</code></td><td>å…³é—­ warningï¼Œå’Œ <code>-dontnote</code>ç±»ä¼¼</td></tr><tr><td><code>-ignorewarnings</code></td><td>å¿½ç•¥è­¦å‘Š</td></tr><tr><td><code>-printconfiguration</code></td><td>æ‰“å°é…ç½®ï¼Œå¦‚æœæŒ‡å®šæ–‡ä»¶åˆ™è¾“å‡ºåˆ°æ–‡ä»¶ä¸­ï¼Œå¦‚æœæ²¡æŒ‡å®šï¼Œåˆ™è¾“å‡ºåˆ°é»˜è®¤æ–‡ä»¶å¤¹ä¸­</td></tr></tbody></table><div class="alert info"><p>åœ¨é…ç½®æ–‡ä»¶ä¸­å¯ä»¥ä½¿ç”¨ <code>system property</code> ï¼Œä¾‹å¦‚ <code>&lt;java.home&gt;</code>ã€<code>&lt;user.home&gt;</code>ç­‰ã€‚</p></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘å…¬å¸å¯¹é¡¹ç›®ä½¿ç”¨ Proguard å·¥å…·åšä»£ç ä¼˜åŒ–åŠæ··æ·†ï¼Œæ­£å¥½ç§°è¿™ä¸ªæœºä¼šå­¦ä¹ äº†ä¸‹ä¸€ä»£ç æ··æ·†æ–¹é¢çš„çŸ¥è¯†ï¼Œé¡ºä¾¿åšä¸ªç¬”è®°ï¼Œåˆ†äº«ä¸€ä¸‹ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç¨‹åºçŒ¿è¿›åŒ–ä¹‹è·¯" scheme="http://www.istarx.cn/categories/%E7%A8%8B%E5%BA%8F%E7%8C%BF%E8%BF%9B%E5%8C%96%E4%B9%8B%E8%B7%AF/"/>
    
    
      <category term="proguard" scheme="http://www.istarx.cn/tags/proguard/"/>
    
  </entry>
  
  <entry>
    <title>Androidè‡ªåŠ¨åŒ–æµ‹è¯•ä¹‹ â€” ç®€å•èŠèŠå•å…ƒæµ‹è¯•</title>
    <link href="http://www.istarx.cn/2018/04/16/unit-test-what-and-why/"/>
    <id>http://www.istarx.cn/2018/04/16/unit-test-what-and-why/</id>
    <published>2018-04-16T14:11:30.000Z</published>
    <updated>2019-02-18T16:57:22.710Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>å•å…ƒæµ‹è¯•æ˜¯æŒ‡å¯¹ä¸€ä¸ªå·¥ä½œå•å…ƒçš„æµ‹è¯•ã€‚ä¸€ä¸ªå·¥ä½œå•å…ƒå¯ä»¥æ˜¯ä¸€è¡Œä»£ç ã€ä¸€ä¸ªæ–¹æ³•ã€ä¸€ä¸ªç”šè‡³å‡ ä¸ªç±»ã€‚æœ¬æ–‡ä¸»è¦èŠèŠå•å…ƒæµ‹è¯•æ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦å†™å•å…ƒæµ‹è¯•ï¼Œç®€å•ä»‹ç»ä¸€ä¸‹ Android ä¸­çš„å•å…ƒæµ‹è¯•ã€‚</p><a id="more"></a><p><ul class="toc js-fixedContent"><li><a href="#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E6%98%AF%E4%BB%80%E4%B9%88">å•å…ƒæµ‹è¯•æ˜¯ä»€ä¹ˆ</a></li><li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%86%99%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95">ä¸ºä»€ä¹ˆå†™å•å…ƒæµ‹è¯•</a><ul><li><a href="#android-%E4%B8%AD%E7%9A%84%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95">Android ä¸­çš„å•å…ƒæµ‹è¯•</a><ul><li><a href="#instrumented-unit-test">Instrumented unit test</a></li><li><a href="#local-unit-test">Local unit test</a></li></ul></li></ul></li></ul></p><h2 id="å•å…ƒæµ‹è¯•æ˜¯ä»€ä¹ˆ"><a class="anchor" href="#å•å…ƒæµ‹è¯•æ˜¯ä»€ä¹ˆ"></a> å•å…ƒæµ‹è¯•æ˜¯ä»€ä¹ˆ</h2><p>æµ‹è¯•ä½œä¸ºæœ€å¸¸è§çš„æ”¹å–„è´¨é‡çš„æ´»åŠ¨ï¼Œè€Œæµ‹è¯•ä¸­çš„å•å…ƒæµ‹è¯•ä½œä¸ºæå‡ä»£ç è´¨é‡ã€ç†è§£ä»£ç çš„æœ€ä½³æ‰‹æ®µï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªæ–°æ¦‚å¿µï¼Œæ—©åœ¨ä½¿ç”¨ SmallTalk ç¼–ç¨‹æ—¶ä»£å°±å¼€å§‹å‡ºç°äº†ã€‚ç»´åŸºç™¾ç§‘ä¸­å¯¹å•å…ƒæµ‹è¯•çš„å®šä¹‰æ˜¯è¿™æ ·çš„ï¼š</p><blockquote><p>åœ¨è®¡ç®—æœºç¼–ç¨‹ä¸­ï¼Œå•å…ƒæµ‹è¯•ï¼ˆUnit Testingï¼‰åˆç§°ä¸ºæ¨¡å—æµ‹è¯•, æ˜¯é’ˆå¯¹<strong>ç¨‹åºæ¨¡å—</strong>ï¼ˆ<strong>è½¯ä»¶è®¾è®¡çš„æœ€å°å•ä½</strong>ï¼‰æ¥è¿›è¡Œæ­£ç¡®æ€§æ£€éªŒçš„æµ‹è¯•å·¥ä½œã€‚ç¨‹åºå•å…ƒæ˜¯åº”ç”¨çš„æœ€å°å¯æµ‹è¯•éƒ¨ä»¶ã€‚åœ¨è¿‡ç¨‹åŒ–ç¼–ç¨‹ä¸­ï¼Œä¸€ä¸ªå•å…ƒå°±æ˜¯<strong>å•ä¸ªç¨‹åºã€å‡½æ•°ã€è¿‡ç¨‹</strong>ç­‰ï¼›å¯¹äºé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œæœ€å°å•å…ƒå°±æ˜¯æ–¹æ³•ï¼ŒåŒ…æ‹¬åŸºç±»ã€æŠ½è±¡ç±»ã€æˆ–è€…å­ç±»ä¸­çš„æ–¹æ³•ã€‚</p></blockquote><p>è¯¥å®šä¹‰ä¸­æåŠåˆ°çš„æ¨¡å—ä¹Ÿå°±æ˜¯ä¸€ä¸ªå•å…ƒã€‚å¯¹äºè¢«æµ‹è¯•ç¨‹åºæ¥è¯´ï¼ŒæŒ‡è°ƒç”¨ä¸€ä¸ªæ–¹æ³•å¹¶å¾—åˆ°ä¸€ä¸ªå¯ä»¥éªŒè¯çš„è¾“å‡ºè¿‡ç¨‹ä¸­æ‰€æ¶‰åŠçš„æ‰€æœ‰ä»£ç ç»Ÿç§°ä¸ºä¸€ä¸ªå•å…ƒã€‚å•å…ƒæµ‹è¯•ä¸ä¸€å®šè¦å°½å¯èƒ½çš„å°ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¸ä¸€å®šè¦å¯¹ä¸€ä¸ªç±»çš„æ¯ä¸ªæ–¹æ³•éƒ½è¿›è¡Œæµ‹è¯•ï¼Œä¹Ÿå¯ä»¥å¯¹å¤šä¸ªæ–¹æ³•ç»„åˆæˆçš„å°å•å…ƒè¿›è¡Œæµ‹è¯•ï¼Œè¿™æ ·ä½¿å¾—æµ‹è¯•ä»£ç æ›´å®¹æ˜“ç»´æŠ¤ã€‚å¦‚æœåˆ›å»ºçš„å•å…ƒå¤ªå°ï¼Œåˆ™æœ‰å¯èƒ½ä¼šå‡†å¤‡ä¸€å †æµ‹è¯•æ‰€éœ€çš„å‰ææ¡ä»¶ï¼Œä¹Ÿæœ‰å¯èƒ½é€ æˆè¿‡åº¦æµ‹è¯•ã€‚ä½†æ˜¯å•å…ƒæµ‹è¯•ä¸€å®šè¦ä»å®Œæ•´çš„ç³»ç»Ÿä¸­éš”ç¦»å‡ºæ¥è¿›è¡Œæµ‹è¯•ã€‚</p><p>å•å…ƒæµ‹è¯•çš„ç›®çš„éš”ç¦»å…¶å®ƒçš„å•å…ƒï¼ˆæˆ–è€…éƒ¨ä»¶ï¼‰è€ŒéªŒè¯å½“å‰å•å…ƒçš„æ­£ç¡®æ€§ã€‚ä»TDDçš„è§’åº¦æ¥è®²ï¼Œå¼€å‘äººå‘˜å¿…é¡»åœ¨å¼€å‘ä»£ç ä¹‹å‰å°±è¦å†™å¥½æµ‹è¯•ç”¨ä¾‹ï¼Œå¹¶æ ¹æ®æµ‹è¯•ç”¨ä¾‹å®Œå–„ä»£ç ã€‚ä»ä»£ç ä¿®æ”¹æˆ–è€…é‡æ„çš„è§’åº¦æ¥è®²ï¼Œå¼€å‘æ¯æ¬¡ä¿®æ”¹ä»£ç éƒ½å¿…é¡»è¿è¡Œä¸€æ¬¡æµ‹è¯•ç”¨ä¾‹ï¼Œä»¥éªŒè¯æœ¬æ¬¡ä¿®æ”¹çš„å‡†ç¡®æ€§ã€‚</p><h2 id="ä¸ºä»€ä¹ˆå†™å•å…ƒæµ‹è¯•"><a class="anchor" href="#ä¸ºä»€ä¹ˆå†™å•å…ƒæµ‹è¯•"></a> ä¸ºä»€ä¹ˆå†™å•å…ƒæµ‹è¯•</h2><p>å•å…ƒæµ‹è¯•çš„ç›®çš„æ˜¯ä¿è¯æ¯ä¸€ä¸ªè¢«æµ‹è¯•å•å…ƒçš„è¿è¡Œå‡†ç¡®ï¼Œæ²¡ä¸€ä¸ªè¢«æµ‹è¯•å•å…ƒçš„è¿è¡Œå‡†ç¡®ï¼Œæ˜¯ä¿è¯æ•´ä¸ªç³»ç»Ÿè¿è¡Œæ­£å¸¸çš„åŸºç¡€ã€‚äººéç¥ï¼Œä¸èƒ½ä¿è¯æ°¸è¿œä¸çŠ¯é”™ï¼Œæ­£å¦‚æ²¡æœ‰äººèƒ½ä¿è¯è‡ªå·±å†™çš„ä»£ç æ°¸è¿œä¸ä¼šå‡ºé”™ä¸€æ ·ã€‚åªæœ‰å½“ä½ çš„ä»£ç ç»è¿‡äº†å……åˆ†çš„æµ‹è¯•æ‰èƒ½ä¿è¯å®ƒä¸ä¼šæŠŠé”™è¯¯å¸¦åˆ°ç”¨æˆ·æ‰‹ä¸­ã€‚</p><p>å½“è‡ªå·±åƒå¹¸ä¸‡è‹¦ç»ˆäºå†™å‡ºäº†ä¸€ä¸ª Appï¼Œå¹¶ç»è¿‡æ¼«é•¿æ—¶é—´çš„ debug æ¨¡å¼ï¼Œç»ˆäºè¿™ä¸ª App å¯ä»¥åœ¨æ‰‹æœºä¸Šæ‰“å¼€äº†ï¼Œä½†æ˜¯ä¸‹ä¸€åˆ»ï¼Œæœ‰å¯èƒ½ä¸€ä¸ªæ— æƒ…çš„é”™è¯¯å¼¹æ¡†ä¼šå‡ºç°åœ¨çœ¼å‰ã€‚ç›¸ä¿¡æ¯ä¸ªå·¥ç¨‹ç‹®éƒ½é‡åˆ°è¿‡ç±»ä¼¼çš„æƒ…å†µï¼Œå¯èƒ½æ˜¯å› ä¸ºåœ¨ä»£ç é‡Œé¢æ²¡æœ‰è€ƒè™‘ nullï¼Ÿæˆ–è€…æ²¡æœ‰è€ƒè™‘æç«¯æƒ…å†µï¼Ÿç­‰ç­‰ã€‚</p><p>è¿™äº›åŸºç¡€çš„é”™è¯¯å®Œå…¨å¯ä»¥åœ¨å¼€å‘åˆæœŸå°±å¯ä»¥æ’é™¤å¹¶è§£å†³æ‰ï¼Œè¿™ä¹Ÿæ˜¯åˆæœŸåšå¥½å•å…ƒæµ‹è¯•çš„é‡è¦æ€§ã€‚æµ‹è¯•å®Œå…¨å¯ä»¥è·Ÿç€å¼€å‘èµ°ï¼Œæˆ–è€…æµ‹è¯•å…ˆäºå¼€å‘ã€‚<br>å•å…ƒæµ‹è¯•è¿˜å…·æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼›</p><ul><li>é€Ÿåº¦å¿« - ä¸»è¦è¡¨ç°åœ¨ä¸‰ä¸ªæ–¹é¢ï¼š<ul><li>ä» Android çš„è§’åº¦æ¥è®²ï¼Œä¸éœ€è¦ç¼–è¯‘æˆå­—èŠ‚ç æ–‡ä»¶ï¼Œå› æ­¤ç¼–è¯‘æ—¶é—´çŸ­ï¼›</li><li>ä»ç¼–å†™è§’åº¦è®²ï¼Œç¼–å†™ä¸€æ¡å•å…ƒæµ‹è¯•ç”¨ä¾‹çš„æ—¶é—´ç›¸å¯¹è¾ƒå°‘ï¼›</li><li>ä»æ‰§è¡Œé€Ÿåº¦æ¥çœ‹ï¼Œå•æ¡æµ‹è¯•ç”¨ä¾‹çš„æ‰§è¡Œæ—¶é—´åŸºæœ¬ä¸Šæ˜¯æ¯«ç§’çº§çš„ï¼›</li></ul></li><li>ä¸ä¾èµ–è®¾å¤‡ - åªéœ€è¦åœ¨ JVM ä¸Šè¿è¡Œå°±å¯ä»¥ï¼Œä¸éœ€è¦å…¶ä»–çš„è®¾å¤‡ (ä¾‹å¦‚ Android è®¾å¤‡åŒ–æµ‹è¯•å¿…é¡»è¦ä¾èµ–æ‰‹æœº)ï¼›</li><li>èƒ½å¯¹ç¼ºé™·è¿›è¡Œå¿«é€Ÿåé¦ˆï¼Œå‡å°‘å¼€å‘ã€ç»´æŠ¤æ—¶é—´ã€ç²¾åŠ›ç­‰ï¼›</li><li>å•å…ƒæµ‹è¯•å¯ä»¥å¯¹é‡æ„æä¾›å¾ˆå¥½çš„ä¿éšœï¼›</li><li>æ›´å°‘çš„ Bugï¼Œæˆ–è€…æ›´å¿«çš„å‘ç° Bugï¼Œå¯ä»¥åœ¨å¼€å‘åˆæœŸå°±å¯ä»¥è§£å†³å¾ˆå¤šBugï¼›</li></ul><p>å•å…ƒæµ‹è¯•çš„é‡è¦æ€§ä¸è¨€è€Œå–»ï¼Œå°¤å…¶æ˜¯åœ¨å¼€å‘æˆ–è€…é‡æ„çš„è¿‡ç¨‹ä¸­èµ·åˆ°äº†ä¸¾è¶³è½»é‡çš„ä½œç”¨ã€‚Google å®˜æ–¹æ–‡æ¡£ä¸­å¯¹ Android æµ‹è¯•ä¸­å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€UI(è®¾å¤‡åŒ–)æµ‹è¯•æè¿°çš„é‡‘å­—å¡”å¦‚ä¸‹ï¼š</p><p><img src="test-pyramid.png" alt="test-pyramid"></p><p>ç”±æ­¤å¯è§å•å…ƒæµ‹è¯•å¤„äºé‡‘å­—å¡”æœ€ä¸‹ä¸€å±‚ï¼Œä¹Ÿæ˜¯æ•´ä¸ªæµ‹è¯•çš„åŸºçŸ³ã€‚Google å¯¹å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€UI æµ‹è¯•çš„æµ‹è¯•ç”¨ä¾‹æ‰€å æ¯”ä¾‹å»ºè®®ä¸º70%ã€20%ã€10%ï¼Œç”±æ­¤ä¹Ÿå¯ä»¥çœ‹å‡ºå•å…ƒæµ‹è¯•çš„é‡è¦æ€§ã€‚</p><h3 id="android-ä¸­çš„å•å…ƒæµ‹è¯•"><a class="anchor" href="#android-ä¸­çš„å•å…ƒæµ‹è¯•"></a> Android ä¸­çš„å•å…ƒæµ‹è¯•</h3><p>Android ä¸­çš„å•å…ƒæµ‹è¯•å¯ä»¥åˆ†ä¸º<code>Instrumented unit test</code>å’Œ<code>Local unit test</code>ï¼Œå³è®¾å¤‡åŒ–çš„å•å…ƒæµ‹è¯•å’Œæœ¬åœ°åŒ–çš„å•å…ƒæµ‹è¯•ã€‚</p><h4 id="instrumented-unit-test"><a class="anchor" href="#instrumented-unit-test"></a> Instrumented unit test</h4><p>æœ‰äº›æµ‹è¯•ç”¨ä¾‹åœ¨è¿è¡Œçš„æ—¶å€™ä½¿ç”¨åˆ°äº† Android Framework ä¸­çš„ä¸€äº›ä¸œè¥¿ï¼Œè¿™ç±»æµ‹è¯•ç”¨ä¾‹åœ¨æµ‹è¯•çš„æ—¶å€™éœ€è¦å€ŸåŠ©è®¾å¤‡è¿è¡Œï¼Œé™¤éæŠŠå’Œ Android Framework ç›¸å…³çš„ä½¿ç”¨éƒ½ Mock æ‰ï¼Œè¿™ç±»æµ‹è¯•å³è®¾å¤‡åŒ–å•å…ƒæµ‹è¯•ï¼Œè¯¥ç±»æµ‹è¯•é»˜è®¤åœ¨<code>&lt;module-name&gt;/src/androidTest/java</code>ç›®å½•ä¸‹ï¼›</p><p><code>Instrumented unit test</code> è¿è¡Œåœ¨ <code>AndroidJunitRunner</code>ä¹‹ä¸‹ï¼ŒAndroidJunitRunner æ˜¯æµ‹è¯•æ”¯æŒåº“ä¸‹(Android Support Library)å†…åŒ…å«çš„ä¸€ä¸ª Junit è¿è¡Œå™¨ï¼Œå¯ä»¥ä½¿ç”¨å®ƒåœ¨ Android è®¾å¤‡ä¸Šè¿è¡Œ JUnit ç”¨ä¾‹ã€‚æµ‹è¯•ç”¨ä¾‹å¯ä»¥æ˜¯ JUnit3 æˆ–è€… JUnit4ï¼Œä½†æ˜¯ä¸è¦è¿›è¡Œæ··ç”¨ï¼Œä¸ç„¶ä¼šå‡ºç°æ„æƒ³ä¸åˆ°çš„é”™è¯¯ã€‚å¦‚æœæµ‹è¯•ç”¨ä¾‹éœ€è¦ä½¿ç”¨ AndroidJunitRunner æ¥è¿è¡Œï¼Œåˆ™æµ‹è¯•ç±»è¦æ·»åŠ  <code>@RunWith(AndroidJUnit4.class)</code>æ³¨é‡Šã€‚ä½¿ç”¨ AndroidJunitRunner éœ€è¦åœ¨ <code>build.gradle</code>æ–‡ä»¶ä¸­æŒ‡å®š <code>testInstrumentationRunner</code>ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        testInstrumentationRunner <span class="string">"android.support.test.runner.AndroidJUnitRunner"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="local-unit-test"><a class="anchor" href="#local-unit-test"></a> Local unit test</h4><p><code>Local unit test</code> åœ¨è¿è¡Œçš„æ—¶å€™ä¸éœ€è¦å€ŸåŠ©è®¾å¤‡ï¼Œä¸ä¼šä½¿ç”¨ Android Framework æˆ–è€…æ˜¯æŠŠ Framework ç›¸å…³çš„ä»£ç è¿›è¡Œ Mock å¤„ç†ï¼Œä½¿ä¹‹å¯ä»¥åœ¨ JVMä¸Šè¿è¡Œï¼Œè¿™ç±»æµ‹è¯•ç”¨ä¾‹é»˜è®¤åœ¨<code>&lt;module-name&gt;/src/test/java</code>ç›®å½•ä¸‹ï¼›</p><p>åœ¨ Android Local Unit Test ä¸­ï¼Œä¸ºäº†ä½¿æµ‹è¯•ç”¨ä¾‹è„±ç¦» Android Frameworkï¼Œå¸¸ç”¨åˆ°çš„æ–¹æ³•æ˜¯ä½¿ç”¨<code>Mock</code>ã€ <code>PowerMock</code> æˆ–è€… <code>Robolectric</code> æ¡†æ¶ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨ä¸‰ä¸ªæ¡†æ¶ï¼Œéœ€è¦å¼•å…¥å¿…é¡»çš„ä¾èµ–æ–‡ä»¶ï¼Œè¿™ä¸ªåé¢æ–‡ç« ä¼šè°ˆåˆ°ï¼Œè¿™é‡Œåªæ˜¯å¯¹è¿™å‡ ä¸ªæ¡†æ¶åšä¸ªç®€å•çš„ä»‹ç»ï¼š</p><ul><li><p><code>Mockito</code> - Mock æ„ä¸ºæ¨¡æ‹Ÿï¼Œæ˜¯æŒ‡å¯¹ä¸€ä¸ªç±»ã€æ¥å£ç­‰è¿›è¡Œæ¨¡æ‹Ÿ    ï¼Œå¹¶ä¸”åˆ©ç”¨æ’æ¡©çš„æ–¹æ³•å¯ä»¥æŒ‡å®šå½“è°ƒç”¨åˆ°ç±»ã€æ¥å£çš„æ–¹æ³•æ—¶å¯ä»¥è¿”å›ç‰¹å®šå€¼ã€åšç‰¹å®šçš„æ“ä½œï¼Œå¸¸ç”¨æ¥åœ¨å›¢é˜Ÿå¼€å‘çš„è¿‡ç¨‹ä¸­å¯¹å…¶å®ƒæ²¡å¼€å‘å®Œçš„ç±»ã€æ¥å£è¿›è¡Œmockï¼Œå‡è®¾è¯¥ç±»ã€æ¥å£æ­£å¸¸å·¥ä½œçš„æƒ…å†µä¸‹æ¥æµ‹è¯•å·²ç»å¼€å‘å®Œæˆçš„ä»£ç æ˜¯å¦æ­£å¸¸å·¥ä½œ.</p><p>ä½†æ˜¯ Mock æ¡†æ¶æœ‰ä¸ªé™åˆ¶å°±æ˜¯åªèƒ½å¯¹å…¬æœ‰çš„æ–¹æ³•è¿›è¡Œæ’æ¡©ï¼Œä¸ä¼šé€ æˆå¾ˆå¤§çš„ä»£ç ä¾µå…¥ï¼›</p></li><li><p><code>PowerMock</code> - PowerMock å’Œ Mock ç›¸ä¼¼ï¼Œå…¶å®ä¹Ÿæœ‰å¾ˆå¤šä»£ç æ˜¯ç»§æ‰¿è‡ª Mock æ¡†æ¶ï¼Œä½†æ˜¯æ¯” Mock æ¡†æ¶æ›´å¼ºå¤§ï¼Œå®ƒå¯ä»¥åšä¸€åˆ‡ Mock æ¡†æ¶å¯ä»¥åšçš„äº‹ï¼Œè¿˜å¯ä»¥å¯¹é™æ€ã€finalã€ç§æœ‰çš„æ–¹æ³•ã€å˜é‡ç­‰è¿›è¡Œæ“ä½œï¼Œå¦‚æœè€æ¿è¦æ±‚ä½ ä»£ç è¦†ç›–ç‡è¾¾åˆ°100%ï¼Œé‚£ä¹ˆ PowerMock æ˜¯ä¸ªç¥å™¨;</p></li><li><p><code>Robolectric</code> - Robolectric æ¡†æ¶å¯¹Android Framwork è¿›è¡Œé‡æ–°çš„å®ç°ï¼Œä½¿ä¹‹å¯ä»¥è„±ç¦»è®¾å¤‡è¿è¡Œï¼Œè¯¥æ¡†æ¶åŸºæœ¬ä¸Šå¯¹ adnroid.jar åŒ…å†…çš„æ¯ä¸€ä¸ªç±»<code>Xxx</code>éƒ½åšäº†ä¸€ä¸ªå®ç°<code>ShadowXxx</code>.</p><p>Robolectric æ¡†æ¶å¯ä»¥å¯¹ Acticityã€BroadcastReceiverã€ContentProviderã€Serviceå››å¤§ç»„ä»¶è¿›è¡Œæµ‹è¯•ï¼Œæ¯”å¦‚å¯ä»¥æµ‹è¯•Activity ç”Ÿå‘½å‘¨æœŸã€ContentProvider æ•°æ®æ˜¯å¦å­˜å‚¨æˆåŠŸç­‰ï¼›é™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥å¯¹ Dialogã€Toastã€èµ„æºç­‰è¿›è¡Œæµ‹è¯•ï¼›</p></li></ul><p>æœ€å¥½çš„è§£å†³æ–¹æ¡ˆå³æ˜¯ PowerMock + Robolectricï¼Œç”¨ Robolectric æ¡†æ¶æµ‹è¯• Android ç»„ä»¶ï¼Œè¾…ä»¥ PowerMock æµ‹è¯•æ¡†æ¶æ¥æµ‹è¯•é€»è¾‘ä»£ç æˆ–è€…å…¶å®ƒï¼Œä»¥è¾¾åˆ°å¾ˆå¥½çš„æµ‹è¯•æ•ˆæœã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å•å…ƒæµ‹è¯•æ˜¯æŒ‡å¯¹ä¸€ä¸ªå·¥ä½œå•å…ƒçš„æµ‹è¯•ã€‚ä¸€ä¸ªå·¥ä½œå•å…ƒå¯ä»¥æ˜¯ä¸€è¡Œä»£ç ã€ä¸€ä¸ªæ–¹æ³•ã€ä¸€ä¸ªç”šè‡³å‡ ä¸ªç±»ã€‚æœ¬æ–‡ä¸»è¦èŠèŠå•å…ƒæµ‹è¯•æ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦å†™å•å…ƒæµ‹è¯•ï¼Œç®€å•ä»‹ç»ä¸€ä¸‹ Android ä¸­çš„å•å…ƒæµ‹è¯•ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç¨‹åºçŒ¿è¿›åŒ–ä¹‹è·¯" scheme="http://www.istarx.cn/categories/%E7%A8%8B%E5%BA%8F%E7%8C%BF%E8%BF%9B%E5%8C%96%E4%B9%8B%E8%B7%AF/"/>
    
      <category term="è‡ªåŠ¨åŒ–æµ‹è¯•" scheme="http://www.istarx.cn/categories/%E7%A8%8B%E5%BA%8F%E7%8C%BF%E8%BF%9B%E5%8C%96%E4%B9%8B%E8%B7%AF/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="è‡ªåŠ¨åŒ–æµ‹è¯•" scheme="http://www.istarx.cn/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/"/>
    
      <category term="unit-test" scheme="http://www.istarx.cn/tags/unit-test/"/>
    
  </entry>
  
</feed>
